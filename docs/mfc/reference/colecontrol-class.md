---
title: COleControl-Klasse | Microsoft Docs
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- devlang-cpp
ms.tgt_pltfrm: 
ms.topic: reference
f1_keywords:
- COleControl
- AFXCTL/COleControl
- AFXCTL/COleControl::COleControl
- AFXCTL/COleControl::AmbientAppearance
- AFXCTL/COleControl::AmbientBackColor
- AFXCTL/COleControl::AmbientDisplayName
- AFXCTL/COleControl::AmbientFont
- AFXCTL/COleControl::AmbientForeColor
- AFXCTL/COleControl::AmbientLocaleID
- AFXCTL/COleControl::AmbientScaleUnits
- AFXCTL/COleControl::AmbientShowGrabHandles
- AFXCTL/COleControl::AmbientShowHatching
- AFXCTL/COleControl::AmbientTextAlign
- AFXCTL/COleControl::AmbientUIDead
- AFXCTL/COleControl::AmbientUserMode
- AFXCTL/COleControl::BoundPropertyChanged
- AFXCTL/COleControl::BoundPropertyRequestEdit
- AFXCTL/COleControl::ClientToParent
- AFXCTL/COleControl::ClipCaretRect
- AFXCTL/COleControl::ControlInfoChanged
- AFXCTL/COleControl::DisplayError
- AFXCTL/COleControl::DoClick
- AFXCTL/COleControl::DoPropExchange
- AFXCTL/COleControl::DoSuperclassPaint
- AFXCTL/COleControl::EnableSimpleFrame
- AFXCTL/COleControl::ExchangeExtent
- AFXCTL/COleControl::ExchangeStockProps
- AFXCTL/COleControl::ExchangeVersion
- AFXCTL/COleControl::FireClick
- AFXCTL/COleControl::FireDblClick
- AFXCTL/COleControl::FireError
- AFXCTL/COleControl::FireEvent
- AFXCTL/COleControl::FireKeyDown
- AFXCTL/COleControl::FireKeyPress
- AFXCTL/COleControl::FireKeyUp
- AFXCTL/COleControl::FireMouseDown
- AFXCTL/COleControl::FireMouseMove
- AFXCTL/COleControl::FireMouseUp
- AFXCTL/COleControl::FireReadyStateChange
- AFXCTL/COleControl::GetActivationPolicy
- AFXCTL/COleControl::GetAmbientProperty
- AFXCTL/COleControl::GetAppearance
- AFXCTL/COleControl::GetBackColor
- AFXCTL/COleControl::GetBorderStyle
- AFXCTL/COleControl::GetCapture
- AFXCTL/COleControl::GetClassID
- AFXCTL/COleControl::GetClientOffset
- AFXCTL/COleControl::GetClientRect
- AFXCTL/COleControl::GetClientSite
- AFXCTL/COleControl::GetControlFlags
- AFXCTL/COleControl::GetControlSize
- AFXCTL/COleControl::GetDC
- AFXCTL/COleControl::GetEnabled
- AFXCTL/COleControl::GetExtendedControl
- AFXCTL/COleControl::GetFocus
- AFXCTL/COleControl::GetFont
- AFXCTL/COleControl::GetFontTextMetrics
- AFXCTL/COleControl::GetForeColor
- AFXCTL/COleControl::GetHwnd
- AFXCTL/COleControl::GetMessageString
- AFXCTL/COleControl::GetNotSupported
- AFXCTL/COleControl::GetReadyState
- AFXCTL/COleControl::GetRectInContainer
- AFXCTL/COleControl::GetStockTextMetrics
- AFXCTL/COleControl::GetText
- AFXCTL/COleControl::GetWindowlessDropTarget
- AFXCTL/COleControl::InitializeIIDs
- AFXCTL/COleControl::InternalGetFont
- AFXCTL/COleControl::InternalGetText
- AFXCTL/COleControl::InternalSetReadyState
- AFXCTL/COleControl::InvalidateControl
- AFXCTL/COleControl::InvalidateRgn
- AFXCTL/COleControl::IsConvertingVBX
- AFXCTL/COleControl::IsModified
- AFXCTL/COleControl::IsOptimizedDraw
- AFXCTL/COleControl::IsSubclassedControl
- AFXCTL/COleControl::Load
- AFXCTL/COleControl::LockInPlaceActive
- AFXCTL/COleControl::OnAmbientPropertyChange
- AFXCTL/COleControl::OnAppearanceChanged
- AFXCTL/COleControl::OnBackColorChanged
- AFXCTL/COleControl::OnBorderStyleChanged
- AFXCTL/COleControl::OnClick
- AFXCTL/COleControl::OnClose
- AFXCTL/COleControl::OnDoVerb
- AFXCTL/COleControl::OnDraw
- AFXCTL/COleControl::OnDrawMetafile
- AFXCTL/COleControl::OnEdit
- AFXCTL/COleControl::OnEnabledChanged
- AFXCTL/COleControl::OnEnumVerbs
- AFXCTL/COleControl::OnEventAdvise
- AFXCTL/COleControl::OnFontChanged
- AFXCTL/COleControl::OnForeColorChanged
- AFXCTL/COleControl::OnFreezeEvents
- AFXCTL/COleControl::OnGetColorSet
- AFXCTL/COleControl::OnGetControlInfo
- AFXCTL/COleControl::OnGetDisplayString
- AFXCTL/COleControl::OnGetInPlaceMenu
- AFXCTL/COleControl::OnGetNaturalExtent
- AFXCTL/COleControl::OnGetPredefinedStrings
- AFXCTL/COleControl::OnGetPredefinedValue
- AFXCTL/COleControl::OnGetViewExtent
- AFXCTL/COleControl::OnGetViewRect
- AFXCTL/COleControl::OnGetViewStatus
- AFXCTL/COleControl::OnHideToolBars
- AFXCTL/COleControl::OnInactiveMouseMove
- AFXCTL/COleControl::OnInactiveSetCursor
- AFXCTL/COleControl::OnKeyDownEvent
- AFXCTL/COleControl::OnKeyPressEvent
- AFXCTL/COleControl::OnKeyUpEvent
- AFXCTL/COleControl::OnMapPropertyToPage
- AFXCTL/COleControl::OnMnemonic
- AFXCTL/COleControl::OnProperties
- AFXCTL/COleControl::OnQueryHitPoint
- AFXCTL/COleControl::OnQueryHitRect
- AFXCTL/COleControl::OnRenderData
- AFXCTL/COleControl::OnRenderFileData
- AFXCTL/COleControl::OnRenderGlobalData
- AFXCTL/COleControl::OnResetState
- AFXCTL/COleControl::OnSetClientSite
- AFXCTL/COleControl::OnSetData
- AFXCTL/COleControl::OnSetExtent
- AFXCTL/COleControl::OnSetObjectRects
- AFXCTL/COleControl::OnShowToolBars
- AFXCTL/COleControl::OnTextChanged
- AFXCTL/COleControl::OnWindowlessMessage
- AFXCTL/COleControl::ParentToClient
- AFXCTL/COleControl::PostModalDialog
- AFXCTL/COleControl::PreModalDialog
- AFXCTL/COleControl::RecreateControlWindow
- AFXCTL/COleControl::Refresh
- AFXCTL/COleControl::ReleaseCapture
- AFXCTL/COleControl::ReleaseDC
- AFXCTL/COleControl::ReparentControlWindow
- AFXCTL/COleControl::ResetStockProps
- AFXCTL/COleControl::ResetVersion
- AFXCTL/COleControl::ScrollWindow
- AFXCTL/COleControl::SelectFontObject
- AFXCTL/COleControl::SelectStockFont
- AFXCTL/COleControl::SerializeExtent
- AFXCTL/COleControl::SerializeStockProps
- AFXCTL/COleControl::SerializeVersion
- AFXCTL/COleControl::SetAppearance
- AFXCTL/COleControl::SetBackColor
- AFXCTL/COleControl::SetBorderStyle
- AFXCTL/COleControl::SetCapture
- AFXCTL/COleControl::SetControlSize
- AFXCTL/COleControl::SetEnabled
- AFXCTL/COleControl::SetFocus
- AFXCTL/COleControl::SetFont
- AFXCTL/COleControl::SetForeColor
- AFXCTL/COleControl::SetInitialSize
- AFXCTL/COleControl::SetModifiedFlag
- AFXCTL/COleControl::SetNotPermitted
- AFXCTL/COleControl::SetNotSupported
- AFXCTL/COleControl::SetRectInContainer
- AFXCTL/COleControl::SetText
- AFXCTL/COleControl::ThrowError
- AFXCTL/COleControl::TransformCoords
- AFXCTL/COleControl::TranslateColor
- AFXCTL/COleControl::WillAmbientsBeValidDuringLoad
- AFXCTL/COleControl::WindowProc
- AFXCTL/COleControl::DrawContent
- AFXCTL/COleControl::DrawMetafile
- AFXCTL/COleControl::IsInvokeAllowed
- AFXCTL/COleControl::SetInitialDataFormats
dev_langs:
- C++
helpviewer_keywords:
- OLE controls, MFC
- windowless controls, MFC
- windowless controls
- controls [MFC], OLE
- controls [MFC], windowless
- COleControl class
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
caps.latest.revision: 25
author: mikeblome
ms.author: mblome
manager: ghogen
translation.priority.ht:
- cs-cz
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pl-pl
- pt-br
- ru-ru
- tr-tr
- zh-cn
- zh-tw
translationtype: Machine Translation
ms.sourcegitcommit: a82768750e6a7837bb81edd8a51847f83c294c20
ms.openlocfilehash: 1f6eeb9802636ebf78f7e5d0b20a188e08a903a6
ms.lasthandoff: 04/04/2017

---
# <a name="colecontrol-class"></a>COleControl-Klasse
Eine leistungsstarke Basisklasse zum Entwickeln von OLE-Steuerelementen.  
  
## <a name="syntax"></a>Syntax  
  
```  
class COleControl : public CWnd  
```  
  
## <a name="members"></a>Mitglieder  
  
### <a name="public-constructors"></a>Öffentliche Konstruktoren  
  
|Name|Beschreibung|  
|----------|-----------------|  
|[COleControl::COleControl](#colecontrol)|Erstellt ein `COleControl`-Objekt.|  
  
### <a name="public-methods"></a>Öffentliche Methoden  
  
|Name|Beschreibung|  
|----------|-----------------|  
|[COleControl::AmbientAppearance](#ambientappearance)|Ruft die aktuelle Darstellung des Steuerelements ab.|  
|[COleControl::AmbientBackColor](#ambientbackcolor)|Gibt den Wert der ambient BackColor-Eigenschaft.|  
|[COleControl::AmbientDisplayName](#ambientdisplayname)|Gibt den Namen des Steuerelements gemäß vom Container zurück.|  
|[COleControl::AmbientFont](#ambientfont)|Gibt den Wert der ambient-Font-Eigenschaft.|  
|[COleControl::AmbientForeColor](#ambientforecolor)|Gibt den Wert der ambient ForeColor-Eigenschaft.|  
|[COleControl:: AmbientLocaleID](#ambientlocaleid)|Gibt den Container Gebietsschema-ID zurück.|  
|[COleControl::AmbientScaleUnits](#ambientscaleunits)|Gibt den Typ der Einheiten, die vom Container verwendeten zurück.|  
|[COleControl::AmbientShowGrabHandles](#ambientshowgrabhandles)|Bestimmt, ob bei Ziehpunkten angezeigt werden soll.|  
|[COleControl::AmbientShowHatching](#ambientshowhatching)|Bestimmt, ob Schraffur angezeigt werden soll.|  
|[COleControl::AmbientTextAlign](#ambienttextalign)|Gibt den Typ der textausrichtung vom Container angegeben.|  
|[COleControl::AmbientUIDead](#ambientuidead)|Bestimmt, ob das Steuerelement auf der Benutzeroberfläche Aktionen reagieren soll.|  
|[COleControl::AmbientUserMode](#ambientusermode)|Bestimmt den Modus des Containers an.|  
|[COleControl::BoundPropertyChanged](#boundpropertychanged)|Benachrichtigt dem Container über eine gebundene Eigenschaft geändert wurde.|  
|[COleControl::BoundPropertyRequestEdit](#boundpropertyrequestedit)|Fordert die Berechtigung zum Bearbeiten des Eigenschaftenwerts.|  
|[COleControl::ClientToParent](#clienttoparent)|Übersetzt einen Punkt relativ zum Ursprung des Steuerelements, bis zu einem Zeitpunkt relativ zum Ursprung des Containers an.|  
|[COleControl::ClipCaretRect](#clipcaretrect)|Passt ein Caretzeichen Rechteck an, wenn er von einem Steuerelement überschneidet ist.|  
|[COleControl::ControlInfoChanged](#controlinfochanged)|Mit dieser Funktion werden, nachdem der Satz von mnemonische Zeichen vom Steuerelement gehandhabt geändert wurde.|  
|[COleControl::DisplayError](#displayerror)|Zeigt Fehler bestandereignissen für Benutzer des Steuerelements an.|  
|[COleControl::DoClick](#doclick)|Implementierung der Aktie `DoClick` Methode.|  
|[COleControl:: DoPropExchange](#dopropexchange)|Serialisiert die Eigenschaften einer `COleControl` Objekt.|  
|[COleControl::DoSuperclassPaint](#dosuperclasspaint)|Zeichnet ein OLE-Steuerelements, das von einem Windows-Steuerelement als Unterklasse.|  
|[COleControl::EnableSimpleFrame](#enablesimpleframe)|Ermöglicht die einfache Frame-Unterstützung für ein Steuerelement.|  
|[COleControl::ExchangeExtent](#exchangeextent)|Serialisiert, Breite und Höhe des Steuerelements.|  
|[COleControl::ExchangeStockProps](#exchangestockprops)|Serialisiert die vordefinierten Eigenschaften des Steuerelements.|  
|[COleControl:: ExchangeVersion](#exchangeversion)|Serialisiert die Versionsnummer des Steuerelements.|  
|[COleControl::FireClick](#fireclick)|Wird ausgelöst, die Stock `Click` Ereignis.|  
|[COleControl::FireDblClick](#firedblclick)|Wird ausgelöst, die Stock `DblClick` Ereignis.|  
|[COleControl:: FireError](#fireerror)|Wird ausgelöst, die Stock `Error` Ereignis.|  
|[COleControl::](#fireevent)|Löst ein benutzerdefiniertes Ereignis.|  
|[COleControl::FireKeyDown](#firekeydown)|Wird ausgelöst, die Stock `KeyDown` Ereignis.|  
|[COleControl::FireKeyPress](#firekeypress)|Wird ausgelöst, die Stock `KeyPress` Ereignis.|  
|[COleControl::FireKeyUp](#firekeyup)|Wird ausgelöst, die Stock `KeyUp` Ereignis.|  
|[COleControl::FireMouseDown](#firemousedown)|Wird ausgelöst, die Stock `MouseDown` Ereignis.|  
|[COleControl::FireMouseMove](#firemousemove)|Wird ausgelöst, die Stock `MouseMove` Ereignis.|  
|[COleControl::FireMouseUp](#firemouseup)|Wird ausgelöst, die Stock `MouseUp` Ereignis.|  
|[COleControl::FireReadyStateChange](#firereadystatechange)|Löst ein Ereignis, wenn der Status "bereit" des Steuerelements ändert.|  
|[COleControl:: GetActivationPolicy](#getactivationpolicy)|Ändert das Standardverhalten für die Aktivierung eines Steuerelements, das unterstützt die `IPointerInactive` Schnittstelle.|  
|[COleControl:: GetAmbientProperty](#getambientproperty)|Gibt den Wert der angegebenen ambient-Eigenschaft.|  
|[COleControl::GetAppearance](#getappearance)|Gibt den Wert der Systemeigenschaft Darstellung zurück.|  
|[COleControl::GetBackColor](#getbackcolor)|Gibt den Wert der Systemeigenschaft BackColor-Eigenschaft.|  
|[COleControl::GetBorderStyle](#getborderstyle)|Gibt den Wert der Systemeigenschaft BorderStyle zurück.|  
|[COleControl::GetCapture](#getcapture)|Bestimmt, ob ein Steuerelementobjekt fensterlose, aktiviert die mausaufzeichnung verfügen.|  
|[COleControl::GetClassID](#getclassid)|Ruft die OLE-Klassen-ID des Steuerelements ab.|  
|[COleControl::GetClientOffset](#getclientoffset)|Ruft die Differenz zwischen der oberen linken Ecke des rechteckigen Bereich des Steuerelements und der oberen linken Ecke des Clientbereichs ab.|  
|[COleControl::GetClientRect](#getclientrect)|Ruft die Größe des Clientbereichs des Steuerelements ab.|  
|[COleControl::GetClientSite](#getclientsite)|Fragt ein Objekt für den Zeiger an den aktuellen Clientstandort innerhalb des Containers.|  
|[COleControl:: GetControlFlags](#getcontrolflags)|Ruft die Steuerelement-Flageinstellungen ab.|  
|[COleControl::GetControlSize](#getcontrolsize)|Gibt die Position und Größe des OLE-Steuerelements.|  
|[COleControl::GetDC](#getdc)|Bietet eine Möglichkeit für ein fensterloses Steuerelement zu einen Gerätekontext aus dem zugehörigen Container zu erhalten.|  
|[COleControl::GetEnabled](#getenabled)|Gibt den Wert der Aktie Enabled-Eigenschaft.|  
|[COleControl::GetExtendedControl](#getextendedcontrol)|Ruft einen Zeiger auf ein, die dem Container gehören erweiterten Steuerelements-Objekt ab.|  
|[COleControl::GetFocus](#getfocus)|Bestimmt, ob das Steuerelement den Fokus besitzt.|  
|[COleControl::GetFont](#getfont)|Der Wert, der die vordefinierte Schriftarteigenschaft zurückgegeben.|  
|[COleControl::GetFontTextMetrics](#getfonttextmetrics)|Gibt die Metriken für einen `CFontHolder` Objekt.|  
|[COleControl::GetForeColor](#getforecolor)|Gibt den Wert der Systemeigenschaft ForeColor-Eigenschaft.|  
|[COleControl::GetHwnd](#gethwnd)|Gibt den Wert der Systemeigenschaft hWnd-Eigenschaft.|  
|[COleControl::GetMessageString](#getmessagestring)|Ein Menüelement bereit Statusleistentext.|  
|[COleControl::GetNotSupported](#getnotsupported)|Verhindert den Zugriff auf den Eigenschaftswert eines Steuerelements, durch den Benutzer.|  
|[COleControl::GetReadyState](#getreadystate)|Gibt das Steuerelement Bereitschaftsstatus zurück.|  
|[COleControl::GetRectInContainer](#getrectincontainer)|Gibt das Rechteck des Steuerelements relativ zu seinem Container zurück.|  
|[COleControl::GetStockTextMetrics](#getstocktextmetrics)|Gibt die Metriken für die vordefinierte Schriftarteigenschaft zurück.|  
|[COleControl::GetText](#gettext)|Gibt den Wert der Systemeigenschaft oder Beschriftungstitel zurück.|  
|[COleControl:: GetWindowlessDropTarget](#getwindowlessdroptarget)|Außer Kraft setzen Sie, um ein fensterloses Steuerelement nicht das Ziel des Drag und drop-Operationen zu ermöglichen.|  
|[COleControl::InitializeIIDs](#initializeiids)|Benachrichtigt die Basisklasse, von die IIDs, die das Steuerelement verwendet wird.|  
|[COleControl::InternalGetFont](#internalgetfont)|Gibt eine `CFontHolder` -Objekt für die vordefinierte Schriftarteigenschaft.|  
|[COleControl::InternalGetText](#internalgettext)|Ruft die Beschriftung oder den Text-Systemeigenschaft ab.|  
|[COleControl::InternalSetReadyState](#internalsetreadystate)|Legt das Steuerelement Bereitschaftsstatus und löst das Ereignis kann jetzt der statusänderung.|  
|[COleControl::InvalidateControl](#invalidatecontrol)|Erklärt einen Bereich des angezeigten Steuerelements, verursacht es neu gezeichnet wird.|  
|[COleControl::InvalidateRgn](#invalidatergn)|Erklärt die Containerfenster Clientbereich im angegebenen Bereich liegt. Kann verwendet werden, in der Region Fensterlose Steuerelemente neu zeichnet.|  
|[COleControl::IsConvertingVBX](#isconvertingvbx)|Ermöglicht spezielle Laden eines OLE-Steuerelements.|  
|[COleControl::IsModified](#ismodified)|Bestimmt, ob der Zustand des Steuerelements geändert wurde.|  
|[COleControl::IsOptimizedDraw](#isoptimizeddraw)|Gibt an, ob der Container für den aktuellen Zeichenvorgang optimierte Zeichnung unterstützt.|  
|[COleControl::IsSubclassedControl](#issubclassedcontrol)|Wird aufgerufen, um zu bestimmen, wenn der Steuerelement-Unterklassen eines Windows-Steuerelement.|  
|[COleControl::Load](#load)|Setzt alle vorherigen asynchronen Daten und initiiert ein neue Laden von asynchronen Steuerelementeigenschaft.|  
|[COleControl::LockInPlaceActive](#lockinplaceactive)|Bestimmt, ob das Steuerelement vom Container deaktiviert werden kann.|  
|[COleControl::OnAmbientPropertyChange](#onambientpropertychange)|Wird aufgerufen, wenn eine Ambiente-Eigenschaft geändert wird.|  
|[COleControl::OnAppearanceChanged](#onappearancechanged)|Wird aufgerufen, wenn die Systemeigenschaft Darstellung geändert wird.|  
|[COleControl::OnBackColorChanged](#onbackcolorchanged)|Wird aufgerufen, wenn die vordefinierte BackColor-Eigenschaft geändert wird.|  
|[COleControl::OnBorderStyleChanged](#onborderstylechanged)|Wird aufgerufen, wenn die Systemeigenschaft BorderStyle geändert wird.|  
|[COleControl::OnClick](#onclick)|Wird aufgerufen, um die Stock auf auslösen Ereignis.|  
|[COleControl::OnClose](#onclose)|Benachrichtigt das Steuerelement, `IOleControl::Close` aufgerufen wurde.|  
|[COleControl::OnDoVerb](#ondoverb)|Wird aufgerufen, nachdem ein kontrollverb ausgeführt wurde.|  
|[COleControl:: OnDraw aufgerufen](#ondraw)|Wird aufgerufen, wenn ein Steuerelement angefordert wird, sich selbst neu zeichnet.|  
|[OnDrawMetafile](#ondrawmetafile)|Vom Container aufgerufen, wenn ein Steuerelement zum Neuzeichnen selbst mit einem Metadatei-Gerätekontext angefordert wird.|  
|[COleControl::OnEdit](#onedit)|Aufgerufen vom Container UI aktivieren ein OLE-Steuerelements.|  
|[COleControl::OnEnabledChanged](#onenabledchanged)|Wird aufgerufen, wenn der Bestand Enabled-Eigenschaft geändert wird.|  
|[COleControl::OnEnumVerbs](#onenumverbs)|Wird aufgerufen, durch den Container des Steuerelements Verben aufgelistet werden.|  
|[COleControl::OnEventAdvise](#oneventadvise)|Wird aufgerufen, wenn Ereignishandler verbunden oder von einem Steuerelement getrennt sind.|  
|[COleControl::OnFontChanged](#onfontchanged)|Wird aufgerufen, wenn die vordefinierte Schriftarteigenschaft geändert wird.|  
|[COleControl::OnForeColorChanged](#onforecolorchanged)|Wird aufgerufen, wenn die vordefinierte ForeColor-Eigenschaft geändert wird.|  
|[COleControl::OnFreezeEvents](#onfreezeevents)|Wird aufgerufen, wenn ein Steuerelement Ereignisse nicht eingefroren oder gesperrt sind.|  
|[COleControl::OnGetColorSet](#ongetcolorset)|Benachrichtigt das Steuerelement, `IOleObject::GetColorSet` aufgerufen wurde.|  
|[COleControl::OnGetControlInfo](#ongetcontrolinfo)|Mnemonischen Informationen für den Container.|  
|[COleControl::OnGetDisplayString](#ongetdisplaystring)|Wird aufgerufen, um eine Zeichenfolge zum Darstellen eines Eigenschaftswerts zu erhalten.|  
|[COleControl::OnGetInPlaceMenu](#ongetinplacemenu)|Fordert das Handle für das Steuerelement Menü, das zusammengeführt werden mit dem Container.|  
|[COleControl::OnGetNaturalExtent](#ongetnaturalextent)|Außer Kraft setzen Sie, um die Größe des Steuerelements anzeigen, die die vorgeschlagene Größe und Block-Modus am nächsten abzurufen.|  
|[COleControl::OnGetPredefinedStrings](#ongetpredefinedstrings)|Gibt die Zeichenfolgen, die möglichen Werte für eine Eigenschaft darstellen.|  
|[COleControl::OnGetPredefinedValue](#ongetpredefinedvalue)|Gibt den Wert, der eine vordefinierte Zeichenfolge entspricht.|  
|[COleControl::OnGetViewExtent](#ongetviewextent)|Außer Kraft setzen Sie, um die Größe des Steuerelements Anzeigebereiche abzurufen (dient zum Zeichnen mit zwei Durchläufen aktivieren).|  
|[COleControl::OnGetViewRect](#ongetviewrect)|Überschreiben Sie, um die Größe des Steuerelements in einem Rechteck, beginnend an einer bestimmten Position zu konvertieren.|  
|[COleControl::OnGetViewStatus](#ongetviewstatus)|Außer Kraft setzen Sie, um das Steuerelement Anzeigen des Status abzurufen.|  
|[COleControl::OnHideToolBars](#onhidetoolbars)|Vom Container aufgerufen, wenn das Steuerelement der Benutzeroberfläche deaktiviert wird.|  
|[COleControl::OnInactiveMouseMove](#oninactivemousemove)|Außerkraftsetzung für den Container für das Steuerelement inaktiv, unter der Mauszeiger Verteilung haben `WM_MOUSEMOVE` Nachrichten an das Steuerelement.|  
|[COleControl::OnInactiveSetCursor](#oninactivesetcursor)|Außerkraftsetzung für den Container für das Steuerelement inaktiv, unter der Mauszeiger Verteilung haben `WM_SETCURSOR` Nachrichten an das Steuerelement.|  
|[COleControl::OnKeyDownEvent](#onkeydownevent)|Wird aufgerufen, nachdem die vordefinierte KeyDown-Ereignis ausgelöst wurde.|  
|[COleControl::OnKeyPressEvent](#onkeypressevent)|Wird aufgerufen, nachdem die vordefinierte KeyPress-Ereignis ausgelöst wurde.|  
|[COleControl::OnKeyUpEvent](#onkeyupevent)|Wird aufgerufen, nachdem die vordefinierte KeyUp-Ereignis ausgelöst wurde.|  
|[COleControl::OnMapPropertyToPage](#onmappropertytopage)|Gibt an, welche Eigenschaftenseite zum Bearbeiten einer Eigenschaft verwendet werden soll.|  
|[COleControl::OnMnemonic](#onmnemonic)|Wird aufgerufen, wenn eine mnemonische Taste des Steuerelements gedrückt wurde.|  
|[COleControl::OnProperties](#onproperties)|Wird aufgerufen, wenn das Steuerelement "Eigenschaften" Verb aufgerufen wurde.|  
|[COleControl::OnQueryHitPoint](#onqueryhitpoint)|Überschreiben Sie Abfrage, ob die Anzeige eines Steuerelements auf einem bestimmten Zeitpunkt überlappt.|  
|[COleControl::OnQueryHitRect](#onqueryhitrect)|Überschreiben Sie Abfrage, ob die Anzeige eines Steuerelements auf einem beliebigen Punkt in einem angegebenen Rechteck überlappt.|  
|[COleControl::OnRenderData](#onrenderdata)|Wird aufgerufen, durch das Framework zum Abrufen von Daten im angegebenen Format.|  
|[COleControl::OnRenderFileData](#onrenderfiledata)|Wird aufgerufen, durch das Framework zum Abrufen von Daten aus einer Datei im angegebenen Format.|  
|[COleControl::OnRenderGlobalData](#onrenderglobaldata)|Wird aufgerufen, durch das Framework zum Abrufen von Daten aus dem globalen Arbeitsspeicher im angegebenen Format.|  
|[COleControl:: OnResetState ein](#onresetstate)|Eigenschaften des Steuerelements zurückgesetzt auf die Standardwerte.|  
|[COleControl:: OnSetClientSite](#onsetclientsite)|Benachrichtigt das Steuerelement, `IOleControl::SetClientSite` aufgerufen wurde.|  
|[COleControl::OnSetData](#onsetdata)|Die Daten des Steuerelements ersetzt durch einen anderen Wert.|  
|[COleControl::OnSetExtent](#onsetextent)|Wird aufgerufen, nachdem Ausmaß des Steuerelements geändert wurde.|  
|[COleControl::OnSetObjectRects](#onsetobjectrects)|Wird aufgerufen, nachdem das Steuerelement Dimensionen geändert wurden.|  
|[COleControl::OnShowToolBars](#onshowtoolbars)|Wird aufgerufen, wenn das Steuerelement Benutzeroberfläche aktiviert wurde.|  
|[COleControl::OnTextChanged](#ontextchanged)|Wird aufgerufen, wenn die Stock Text oder Caption-Eigenschaft geändert wird.|  
|[COleControl::OnWindowlessMessage](#onwindowlessmessage)|Verarbeitet Windows-Nachrichten (mit Ausnahme des Tastatur- und Nachrichten) für fensterlose Steuerelemente.|  
|[COleControl::ParentToClient](#parenttoclient)|Übersetzt einen Punkt relativ zum Ursprung des Containers, bis zu einem Zeitpunkt relativ zum Ursprung des Steuerelements an.|  
|[COleControl::PostModalDialog](#postmodaldialog)|Benachrichtigt dem Container ein modales Dialogfeld geschlossen wurde.|  
|[COleControl::PreModalDialog](#premodaldialog)|Benachrichtigt den Container, die ein modales Dialogfeld angezeigt werden.|  
|[COleControl::RecreateControlWindow](#recreatecontrolwindow)|Zerstört und neu erstellt das Fenster des Steuerelements.|  
|[COleControl::Refresh](#refresh)|Erzwingt das Neuzeichnen der Darstellung des Steuerelements.|  
|[COleControl::ReleaseCapture](#releasecapture)|Versionen Mauseingaben aufzufangen.|  
|[COleControl::ReleaseDC](#releasedc)|Gibt den Anzeigegerätekontext eines Containers ein fensterloses Steuerelement frei.|  
|[COleControl::ReparentControlWindow](#reparentcontrolwindow)|Setzt das übergeordnete Element des Steuerelementfensters zurück.|  
|[COleControl::ResetStockProps](#resetstockprops)|Initialisiert `COleControl` vordefinierte Eigenschaften mit ihren Standardwerten.|  
|[COleControl::ResetVersion](#resetversion)|Initialisiert die Versionsnummer, die einem angegebenen Wert.|  
|[COleControl::ScrollWindow](#scrollwindow)|Ermöglicht ein fensterloses Steuerelement um einen Bereich innerhalb der direkten aktives Image auf die Anzeige zu scrollen.|  
|[COleControl::SelectFontObject](#selectfontobject)|Wählt eine benutzerdefinierte Schriftarteigenschaft in einem Gerätekontext.|  
|[COleControl:: SelectStockFont](#selectstockfont)|Wählt die vordefinierte Schriftarteigenschaft einen Gerätekontext.|  
|[COleControl::SerializeExtent](#serializeextent)|Serialisiert, oder der Speicherplatz für das Steuerelement initialisiert.|  
|[COleControl::SerializeStockProps](#serializestockprops)|Serialisiert oder initialisiert die `COleControl` Basiseigenschaften.|  
|[COleControl::SerializeVersion](#serializeversion)|Serialisiert oder Versionsinformationen für das Steuerelement initialisiert.|  
|[COleControl::SetAppearance](#setappearance)|Legt den Wert der Systemeigenschaft Darstellung fest.|  
|[COleControl::SetBackColor](#setbackcolor)|Legt den Wert der Systemeigenschaft BackColor-Eigenschaft.|  
|[COleControl::SetBorderStyle](#setborderstyle)|Legt den Wert der Systemeigenschaft Rahmenart fest.|  
|[COleControl::SetCapture](#setcapture)|Bewirkt, dass das Steuerelement Containerfenster auszuführenden Besitz der Mausauswahl im Auftrag des Steuerelements.|  
|[COleControl::SetControlSize](#setcontrolsize)|Legt die Position und Größe des OLE-Steuerelements.|  
|[COleControl::SetEnabled](#setenabled)|Legt den Wert der Aktie Enabled-Eigenschaft.|  
|[COleControl::SetFocus](#setfocus)|Bewirkt, dass das Steuerelement Containerfenster, schalten Sie Namen für das Steuerelement den Eingabefokus besitzt.|  
|[COleControl::SetFont](#setfont)|Legt den Wert, der die vordefinierte Schriftarteigenschaft.|  
|[COleControl::SetForeColor](#setforecolor)|Legt den Wert der Systemeigenschaft ForeColor-Eigenschaft.|  
|[COleControl::SetInitialSize](#setinitialsize)|Legt die Größe eines OLE-Steuerelements, wenn in einem Container erstmals angezeigt.|  
|[COleControl::SetModifiedFlag](#setmodifiedflag)|Ändert den geänderten Zustand eines Steuerelements an.|  
|[COleControl::SetNotPermitted](#setnotpermitted)|Gibt an, dass eine Anforderung bearbeiten fehlgeschlagen ist.|  
|[COleControl::SetNotSupported](#setnotsupported)|Verhindert die Änderung an den Eigenschaftswert eines Steuerelements, durch den Benutzer.|  
|[COleControl::SetRectInContainer](#setrectincontainer)|Legt das Rechteck des Steuerelements relativ zu seinem Container.|  
|[COleControl::SetText](#settext)|Legt den Wert der Systemeigenschaft oder Beschriftungstitel fest.|  
|[ThrowError](#throwerror)|Signalisiert, die in einer OLE-Steuerelements ein Fehler aufgetreten ist.|  
|[COleControl::TransformCoords](#transformcoords)|Transformationen Koordinatenwerte zwischen einem Container und das Steuerelement an.|  
|[Memberfunktion COleControl:: TranslateColor](#translatecolor)|Konvertiert eine **OLE_COLOR** -Wert in einen **COLORREF** Wert.|  
|[COleControl::WillAmbientsBeValidDuringLoad](#willambientsbevalidduringload)|Bestimmt, ob Umgebungseigenschaften das nächste Mal zur Verfügung stehen, wenn das Steuerelement geladen wird.|  
|[COleControl::WindowProc](#windowproc)|Stellt eine Windows-Prozedur für eine `COleControl` Objekt.|  
  
### <a name="protected-methods"></a>Geschützte Methoden  
  
|Name|Beschreibung|  
|----------|-----------------|  
|[COleControl::DrawContent](#drawcontent)|Vom Framework aufgerufen, wenn die Darstellung des Steuerelements muss aktualisiert werden.|  
|[COleControl::DrawMetafile](#drawmetafile)|Wird vom Framework aufgerufen, wenn es sich bei der Gerätekontext Metadatei verwendet wird.|  
|[COleControl::IsInvokeAllowed](#isinvokeallowed)|Ermöglicht die Automatisierung der Methodenaufruf.|  
|[COleControl::SetInitialDataFormats](#setinitialdataformats)|Vom Framework aufgerufen wird, initialisieren die Liste der Datenformate, die vom Steuerelement unterstützt wird.|  
  
## <a name="remarks"></a>Hinweise  
 Abgeleitet von `CWnd`, diese Klasse erbt alle die Funktionalität von einem Windows-Fensterobjekt und zusätzliche Funktionen, die speziell für OLE, wie z. B. das Auslösen von Ereignissen und die Fähigkeit zur Unterstützung von Methoden und Eigenschaften.  
  
 OLE-Steuerelemente in der OLE-containeranwendungen eingefügt werden können und kommunizieren mit dem Container über eine bidirektionale System von Auslösen von Ereignissen und Methoden und Eigenschaften für den Container verfügbar machen. Beachten Sie, dass der standard OLE-Container unterstützen nur die grundlegende Funktionalität eines OLE-Steuerelements. Sie können keine erweiterten Funktionen von OLE-Steuerelements unterstützen. Auslösen von Ereignissen tritt auf, wenn Ereignisse an den Container durch bestimmte Aktionen in das Steuerelement gesendet werden. Wiederum kommuniziert der Container mit dem Steuerelement über einen verfügbar gemachten Satz von Methoden und Eigenschaften, die analog zu den Memberfunktionen und Datenmember einer C++-Klasse. Dieser Ansatz ermöglicht den Entwickler, steuern die Darstellung des Steuerelements und den Container zu benachrichtigen, wenn bestimmte Aktionen ausgeführt werden.  
  
## <a name="windowless-controls"></a>Fensterlose Steuerelemente  
 OLE-Steuerelemente können verwendete direkte aktive Fenster des sein. Fensterlose Steuerelemente haben erhebliche Vorteile:  
  
-   Fensterlose Steuerelemente können transparent und viereckig sein.  
  
-   Fensterlose Steuerelemente schnellere Instanz Größe und die Erstellung des Objekts  
  
 Ein Fenster erforderlich Steuerelemente nicht. Dienste, die ein Fenster bietet können problemlos über ein einziges freigegebenen Fenster (normalerweise des Containers) und einem gewissen Grad verteilen Code bereitgestellt werden. Ein Fenster ist meist eine unnötige Komplikation für das Objekt.  
  
 Wenn fensterloser Aktivierung verwendet wird, ist der Container (die ein Fenster verfügt) für die Bereitstellung von Diensten, die andernfalls vom Fenster des Steuerelements bereitgestellt würden zuständig. Wenn das Steuerelement den Tastaturfokus Abfragen, Fragen Sie das Erfassen von Mauseingaben oder erhalten einen Gerätekontext, werden diese Vorgänge vom Container verwaltet. Die `COleControl` [fensterlose Operation Memberfunktionen](http://msdn.microsoft.com/en-us/e9e28f79-9a70-4ae4-a5aa-b3e92f1904df) rufen Sie diese Vorgänge für den Container.  
  
 Wenn fensterloser Aktivierung aktiviert ist, geben Sie die Container-Delegaten Nachrichten an des Steuerelements `IOleInPlaceObjectWindowless` Schnittstelle (eine Erweiterung der [IOleInPlaceObject](http://msdn.microsoft.com/library/windows/desktop/ms692646) fensterlose Supportzwecken). `COleControl`die Implementierung dieser Schnittstelle werden diese Nachrichten über das Steuerelement meldungszuordnung, verteilen, nach dem Anpassen der Maus entsprechend koordiniert. Sie können diese Nachrichten wie gewöhnliche fenstermeldungen, verarbeiten, durch Hinzufügen der entsprechenden Einträge in die meldungszuordnung.  
  
 Sie sollten immer verwenden, in einem fensterloses Steuerelement die `COleControl` Memberfunktionen anstelle der entsprechenden `CWnd` Memberfunktionen oder ihre zugehörigen Windows-API-Funktionen.  
  
 OLE-Steuerelementobjekte können auch ein Fenster erstellen, nur, wenn sie aktiv ist, werden jedoch der verbleibende Arbeitsaufwand für den inaktiven / aktiv-Übergang erforderlich steigt und die Geschwindigkeit des Übergangs ausfällt. Es gibt Fälle, wenn dies ein Problem aufgetreten ist: Betrachten Sie beispielsweise ein Raster von Textfeldern. Wenn Cursoring oben oder unten, bis die Spalte, jedes Steuerelement direktes muss aktiviert und anschließend deaktiviert. Die Geschwindigkeit des Übergangs inaktiv/aktiv wirkt sich direkt auf die Geschwindigkeit des Bildlaufs aus.  
  
 Weitere Informationen zum Entwickeln von einer OLE-Steuerelement-Framework finden Sie in den Artikeln [MFC-ActiveX-Steuerelemente](../../mfc/mfc-activex-controls.md) und [Übersicht: Erstellen einer MFC-ActiveX-Steuerelement-Programm](../../mfc/reference/mfc-activex-control-wizard.md). Informationen zum Optimieren von OLE-Steuerelemente, einschließlich der fensterlose und flimmerfreier-Steuerelemente finden Sie unter [MFC-ActiveX-Steuerelemente: Optimierung](../../mfc/mfc-activex-controls-optimization.md).  
  
## <a name="inheritance-hierarchy"></a>Vererbungshierarchie  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  
  
 [CWnd](../../mfc/reference/cwnd-class.md)  
  
 `COleControl`  
  
## <a name="requirements"></a>Anforderungen  
 **Header:** afxctl.h  
  
##  <a name="ambientbackcolor"></a>COleControl::AmbientBackColor  
 Gibt den Wert der ambient BackColor-Eigenschaft.  
  
```  
OLE_COLOR AmbientBackColor();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Der aktuelle Wert des Containers ambient BackColor-Eigenschaft, falls vorhanden. Wenn die Eigenschaft nicht unterstützt wird, gibt diese Funktion den systemdefinierten Windows die Farbe des Hintergrunds zurück.  
  
### <a name="remarks"></a>Hinweise  
 Die Ambiente-BackColor-Eigenschaft ist für alle Steuerelemente verfügbar und wird durch den Container definiert. Beachten Sie, dass der Container nicht erforderlich ist, um diese Eigenschaft unterstützen.  
  
##  <a name="ambientdisplayname"></a>COleControl::AmbientDisplayName  
 Der Name, der der Container des Steuerelements zugewiesen wurde, kann in dem Benutzer angezeigten Fehlermeldungen verwendet werden.  
  
```  
CString AmbientDisplayName();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Der Name des OLE-Steuerelements. Der Standardwert ist eine Zeichenfolge der Länge 0 (null).  
  
### <a name="remarks"></a>Hinweise  
 Beachten Sie, dass der Container nicht erforderlich ist, um diese Eigenschaft unterstützen.  
  
##  <a name="ambientfont"></a>COleControl::AmbientFont  
 Gibt den Wert der ambient-Font-Eigenschaft.  
  
```  
LPFONTDISP AmbientFont();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Ein Zeiger auf den Container Ambiente-Schriftart-Dispatch-Schnittstelle. Der Standardwert ist **NULL**. Wenn die Rückgabe nicht gleich **NULL**, Sie sind verantwortlich für die Freigabe der Schriftartformats durch Aufrufen seiner [IUnknown:: Release](http://msdn.microsoft.com/library/windows/desktop/ms682317) Memberfunktion.  
  
### <a name="remarks"></a>Hinweise  
 Die Ambiente-Font-Eigenschaft wird definiert durch den Container und für alle Steuerelemente verfügbar waren. Beachten Sie, dass der Container nicht erforderlich ist, um diese Eigenschaft unterstützen.  
  
##  <a name="ambientforecolor"></a>COleControl::AmbientForeColor  
 Gibt den Wert der ambient ForeColor-Eigenschaft.  
  
```  
OLE_COLOR AmbientForeColor();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Der aktuelle Wert des Containers ambient ForeColor-Eigenschaft, falls vorhanden. Diese Funktion gibt die Textfarbe des vordefinierten Windows, wenn nicht unterstützt.  
  
### <a name="remarks"></a>Hinweise  
 Die Ambiente-ForeColor-Eigenschaft ist für alle Steuerelemente verfügbar und wird durch den Container definiert. Beachten Sie, dass der Container nicht erforderlich ist, um diese Eigenschaft unterstützen.  
  
##  <a name="ambientlocaleid"></a>COleControl:: AmbientLocaleID  
 Gibt den Container Gebietsschema-ID zurück.  
  
```  
LCID AmbientLocaleID();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Der Wert des Containers LocaleID-Eigenschaft, falls vorhanden. Wenn diese Eigenschaft nicht unterstützt wird, gibt diese Funktion 0 zurück.  
  
### <a name="remarks"></a>Hinweise  
 Der LocaleID-Wert können das Steuerelement seine Benutzeroberfläche für bestimmte Gebietsschemas angepasst werden kann. Beachten Sie, dass der Container nicht erforderlich ist, um diese Eigenschaft unterstützen.  
  
##  <a name="ambientappearance"></a>COleControl::AmbientAppearance  
 Ruft die aktuelle Darstellung-Einstellung für das Steuerelementobjekt ab.  
  
```  
short AmbientAppearance();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Die Darstellung des Steuerelements:  
  
- **0** Flatfile-Darstellung  
  
- **1** 3D-Darstellung  
  
### <a name="remarks"></a>Hinweise  
 Mit dieser Funktion wird zum Abrufen des aktuellen Werts der **DISPID_AMBIENT_APPEARANCE** -Eigenschaft für das Steuerelement.  
  
##  <a name="ambientscaleunits"></a>COleControl::AmbientScaleUnits  
 Gibt den Typ der Einheiten, die vom Container verwendeten zurück.  
  
```  
CString AmbientScaleUnits();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Eine Zeichenfolge mit dem Ambiente "ScaleUnits" des Containers. Wenn diese Eigenschaft nicht unterstützt wird, gibt diese Funktion eine Zeichenfolge der Länge 0 (null) zurück.  
  
### <a name="remarks"></a>Hinweise  
 Der Container "ScaleUnits" Umgebungseigenschaft kann verwendet werden, zum Anzeigen von Positionen oder Dimensionen, die mit der ausgewählten Einheit, z. B. Twips oder Zentimeter versehen. Beachten Sie, dass der Container nicht erforderlich ist, um diese Eigenschaft unterstützen.  
  
##  <a name="ambientshowgrabhandles"></a>COleControl::AmbientShowGrabHandles  
 Bestimmt, ob der Container die im Steuerelement anzuzeigende Ziehpunkte für sich selbst bei Aktivierung kann.  
  
```  
BOOL AmbientShowGrabHandles();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Wert ungleich NULL, wenn bei Ziehpunkten angezeigt werden soll; andernfalls 0. Wenn diese Eigenschaft nicht unterstützt wird, gibt diese Funktion ungleich NULL zurück.  
  
### <a name="remarks"></a>Hinweise  
 Beachten Sie, dass der Container nicht erforderlich ist, um diese Eigenschaft unterstützen.  
  
##  <a name="ambientshowhatching"></a>COleControl::AmbientShowHatching  
 Bestimmt, ob der Container die im Steuerelement selbst mit einem schraffierten anzuzeigende kann Muster, wenn UI aktiv.  
  
```  
BOOL AmbientShowHatching();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Wert ungleich NULL, wenn die Schraffur angezeigt werden sollen; andernfalls 0. Wenn diese Eigenschaft nicht unterstützt wird, gibt diese Funktion ungleich NULL zurück.  
  
### <a name="remarks"></a>Hinweise  
 Beachten Sie, dass der Container nicht erforderlich ist, um diese Eigenschaft unterstützen.  
  
##  <a name="ambienttextalign"></a>COleControl::AmbientTextAlign  
 Bestimmt die ambient textausrichtung, die von dem Steuerelementcontainer bevorzugt.  
  
```  
short AmbientTextAlign();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Der Status des Containers ambient TextAlign-Eigenschaft. Wenn diese Eigenschaft nicht unterstützt wird, gibt diese Funktion 0 zurück.  
  
 Im folgenden finden eine Liste von gültigen Werten:  
  
|Rückgabewert|Bedeutung|  
|------------------|-------------|  
|0|Allgemeine Ausrichtung (Zahlen auf den richtigen, Text auf der linken Seite).|  
|1|Links ausrichten|  
|2|Center |  
|3|Rechtsbündig|  
  
### <a name="remarks"></a>Hinweise  
 Diese Eigenschaft ist für alle Arten von Steuerelementen eingebettet verfügbar und wird durch den Container definiert. Beachten Sie, dass der Container nicht erforderlich ist, um diese Eigenschaft unterstützen.  
  
##  <a name="ambientuidead"></a>COleControl::AmbientUIDead  
 Bestimmt, ob der Container das Steuerelement auf der Benutzeroberfläche Aktionen reagieren möchte.  
  
```  
BOOL AmbientUIDead();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Wert ungleich NULL, wenn das Steuerelement auf der Benutzeroberfläche Aktionen reagieren soll; andernfalls 0. Wenn diese Eigenschaft nicht unterstützt wird, gibt diese Funktion 0 zurück.  
  
### <a name="remarks"></a>Hinweise  
 Angenommen, ein Container kann festlegen, um **"true"** im Entwurfsmodus.  
  
##  <a name="ambientusermode"></a>COleControl::AmbientUserMode  
 Bestimmt, ob der Container im Entwurfsmodus oder im Benutzermodus befindet.  
  
```  
BOOL AmbientUserMode();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Wert ungleich NULL, wenn der Container im Benutzermodus ist; andernfalls 0 (im Entwurfsmodus). Wenn diese Eigenschaft nicht unterstützt wird, gibt diese Funktion TRUE zurück.  
  
### <a name="remarks"></a>Hinweise  
 Angenommen, ein Container kann festlegen, um **"false"** im Entwurfsmodus.  
  
##  <a name="boundpropertychanged"></a>COleControl::BoundPropertyChanged  
 Signalisiert, die den Wert der gebundenen Eigenschaft geändert wurde.  
  
```  
void BoundPropertyChanged(DISPID dispid);
```  
  
### <a name="parameters"></a>Parameter  
 `dispid`  
 Die Dispatch-ID einer gebundene Eigenschaft des Steuerelements.  
  
### <a name="remarks"></a>Hinweise  
 Dies muss aufgerufen werden jedes Mal, wenn der Wert der Eigenschaft ändert, sogar in Fällen, in dem die Änderung nicht über die Eigenschaft vorgenommen wurde, Methode festgelegt. Achten Sie besonders gebundener Eigenschaften, die Membervariablen zugeordnet sind. Jedes Mal, wenn diese ein Member Variable geändert wird, `BoundPropertyChanged` muss aufgerufen werden.  
  
##  <a name="boundpropertyrequestedit"></a>COleControl::BoundPropertyRequestEdit  
 Fordert die Berechtigung für die `IPropertyNotifySink` Schnittstelle gebundene Eigenschaft-Wert, der vom Steuerelement bereitgestellte zu ändern.  
  
```  
BOOL BoundPropertyRequestEdit(DISPID dispid);
```  
  
### <a name="parameters"></a>Parameter  
 `dispid`  
 Die Dispatch-ID einer gebundene Eigenschaft des Steuerelements.  
  
### <a name="return-value"></a>Rückgabewert  
 Wert ungleich NULL, wenn die Änderung zulässig ist; andernfalls 0. Der Standardwert ist ungleich NULL.  
  
### <a name="remarks"></a>Hinweise  
 Berechtigung verweigert wird, muss das Steuerelement nicht den Wert der Eigenschaftenänderung lassen. Dies kann erfolgen, indem entweder ignoriert oder Fehlschlagen der Aktion, die versucht, den Eigenschaftswert zu ändern.  
  
##  <a name="clienttoparent"></a>COleControl::ClientToParent  
 Übersetzt die Koordinaten der `pPoint` in übergeordneten Koordinaten.  
  
```  
virtual void ClientToParent(
    LPCRECT lprcBounds, 
    LPPOINT pPoint) const;  
```  
  
### <a name="parameters"></a>Parameter  
 `lprcBounds`  
 Zeiger zu den Grenzen des OLE-Steuerelements innerhalb des Containers. Den Bereich des gesamten Steuerelements einschließlich Rahmen und Bildlaufleisten, aber nicht den Clientbereich.  
  
 `pPoint`  
 Ein Zeiger auf die OLE-Clientzugriffspunkt Bereich in die Koordinaten des übergeordneten Elements (Container) übersetzt werden.  
  
### <a name="remarks"></a>Hinweise  
 Bei der Eingabe `pPoint` ist relativ zum Ursprung des Clientbereichs des OLE-Steuerelements (oberen linken Ecke des Clientbereichs des Steuerelements). Bei der Ausgabe `pPoint` ist relativ zum Ursprung des übergeordneten Elements (obere linke Ecke des Containers).  
  
##  <a name="clipcaretrect"></a>COleControl::ClipCaretRect  
 Passt ein Caretzeichen Rechteck an, wenn es sich überschneidenden, nicht transparenten Objekte vollständig oder teilweise abgedeckt wird.  
  
```  
BOOL ClipCaretRect(LPRECT lpRect);
```  
  
### <a name="parameters"></a>Parameter  
 `lpRect`  
 Bei Eingabe einen Zeiger auf eine [RECT](../../mfc/reference/rect-structure1.md) -Struktur, enthält der Bereich Caretzeichen angepasst werden. Bei der Ausgabe im Bereich für den angepassten Caretzeichen oder **NULL** , wenn die Einfügemarke Rechteck vollständig abgedeckt wird.  
  
### <a name="return-value"></a>Rückgabewert  
 Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).  
  
### <a name="remarks"></a>Hinweise  
 Ein Caretzeichen ist eine blinkende Linie, blockieren oder Bitmap, die in der Regel an, in denen Text- oder Grafikelemente eingefügt werden soll.  
  
 Ein fensterlose-Objekt kann nicht sicher ein Caretzeichen anzeigen, ohne zunächst geprüft wird, gibt an, ob der Textcursor ganz oder teilweise ausgeblendet ist, indem überlappende Objekte. Um, die möglich ist, können ein Objekt `ClipCaretRect` angepasst Einfügemarke abrufen (reduziert) um sicherzustellen, dass er stimmt mit den Ausschneidebereich.  
  
 Objekte erstellen ein Caretzeichen das Caretzeichen Rechteck senden soll `ClipCaretRect` und verwenden Sie das angepasste Rechteck für die Einfügemarke. Diese Methode gibt zurück, wenn die Einfügemarke vollständig ausgeblendet ist, **"false"** und die Einfügemarke sollte nicht angezeigt werden alle in diesem Fall.  
  
##  <a name="colecontrol"></a>COleControl::COleControl  
 Erstellt ein `COleControl`-Objekt.  
  
```  
COleControl();
```  
  
### <a name="remarks"></a>Hinweise  
 Diese Funktion ist normalerweise nicht direkt aufgerufen. Stattdessen wird der OLE-Steuerelements in der Regel von Klassenfactory erstellt.  
  
##  <a name="controlinfochanged"></a>COleControl::ControlInfoChanged  
 Rufen Sie diese Funktion, wenn der Satz von mnemonische Zeichen vom Steuerelement unterstützt geändert hat.  
  
```  
void ControlInfoChanged();
```  
  
### <a name="remarks"></a>Hinweise  
 Nach dem Empfang dieser benachrichtigungs wird erhält der Container des Steuerelements den neuen Satz mnemonischen von einem Aufruf an [IOleControl::GetControlInfo](http://msdn.microsoft.com/library/windows/desktop/ms693730). Beachten Sie, dass der Container So reagieren Sie auf diese Benachrichtigung nicht erforderlich ist.  
  
##  <a name="displayerror"></a>COleControl::DisplayError  
 Vom Framework aufgerufen, nachdem die vordefinierte Error-Ereignis behandelt wurde, (es sei denn, der Ereignishandler die Anzeige des Fehlers unterdrückt wurde).  
  
```  
virtual void DisplayError(
    SCODE scode,  
    LPCTSTR lpszDescription,  
    LPCTSTR lpszSource,  
    LPCTSTR lpszHelpFile,  
    UINT nHelpID);
```  
  
### <a name="parameters"></a>Parameter  
 *SCODE*  
 Der Code Statuswert gemeldet werden. Eine vollständige Liste der möglichen Fehlercodes, finden Sie im Artikel [ActiveX-Steuerelemente: Weiterführende Themen](../../mfc/mfc-activex-controls-advanced-topics.md).  
  
 `lpszDescription`  
 Die Beschreibung des Fehlers, der gemeldet wird.  
  
 *lpszSource*  
 Der Name des Moduls, das den Fehler (in der Regel der Name des Moduls OLE-Steuerelement) generiert.  
  
 `lpszHelpFile`  
 Der Name der Hilfedatei, die eine Beschreibung des Fehlers enthält.  
  
 `nHelpID`  
 Die Hilfe-ID für den Fehler gemeldet wird.  
  
### <a name="remarks"></a>Hinweise  
 Standardmäßig zeigt ein Meldungsfeld mit der Beschreibung des Fehlers, der in enthaltenen `lpszDescription`.  
  
 Überschreiben Sie diese Funktion, um anzupassen, wie Fehler angezeigt werden.  
  
##  <a name="doclick"></a>COleControl::DoClick  
 Simuliert die Maus auf das Steuerelement.  
  
```  
void DoClick();
```  
  
### <a name="remarks"></a>Hinweise  
 Die überschreibbare `COleControl::OnClick` Memberfunktion aufgerufen werden, und ein Aktienkurs Click-Ereignis ausgelöst wird, wenn das Steuerelement unterstützt.  
  
 Diese Funktion wird unterstützt, indem Sie die `COleControl` -Basisklasse als vordefinierte Methode DoClick aufgerufen. Weitere Informationen finden Sie im Artikel [ActiveX-Steuerelemente: Methoden](../../mfc/mfc-activex-controls-methods.md).  
  
##  <a name="dopropexchange"></a>COleControl:: DoPropExchange  
 Wird aufgerufen, durch das Framework beim Laden oder Speichern eines Steuerelements aus einer permanenten Speicher-Darstellung, wie z. B. einen Stream oder eine Eigenschaft festlegen.  
  
```  
virtual void DoPropExchange(CPropExchange* pPX);
```  
  
### <a name="parameters"></a>Parameter  
 `pPX`  
 Ein Zeiger auf eine `CPropExchange` Objekt. Das Framework verwendet dieses Objekt aus, um den Kontext der Exchange-Eigenschaft, darunter seine Richtung einzurichten.  
  
### <a name="remarks"></a>Hinweise  
 Diese Funktion nimmt normalerweise Sie Aufrufe an die **PX_** Funktionsreihe zum Laden oder Speichern von bestimmten benutzerdefinierten Eigenschaften eines OLE-Steuerelements.  
  
 Wenn der Steuerelement-Assistent zum Erstellen des OLE-Steuerelement-Projekts verwendet wurde, wird die überschriebene Version dieser Funktion die Basiseigenschaften, die von unterstützt Serialisieren `COleControl` durch einen Aufruf der Funktion der Basisklasse `COleControl::DoPropExchange`. Wenn Sie eine benutzerdefinierte Eigenschaften der OLE-Steuerelements hinzufügen, müssen Sie diese Funktion, um die Serialisierung der neuen Eigenschaften zu ändern. Weitere Informationen zur Serialisierung finden Sie im Artikel [ActiveX-Steuerelemente: Serialisierung](../../mfc/mfc-activex-controls-serializing.md).  
  
##  <a name="dosuperclasspaint"></a>COleControl::DoSuperclassPaint  
 Zeichnet ein OLE-Steuerelements, das von einem Windows-Steuerelement als Unterklasse.  
  
```  
void DoSuperclassPaint(
    CDC* pDC,  
    const CRect& rcBounds);
```  
  
### <a name="parameters"></a>Parameter  
 `pDC`  
 Ein Zeiger auf den Gerätekontext, der dem Steuerelementcontainer.  
  
 `rcBounds`  
 Der Bereich, in dem das Steuerelement ist, gezeichnet werden.  
  
### <a name="remarks"></a>Hinweise  
 Rufen Sie diese Funktion, um das Zeichnen eines inaktiven OLE-Steuerelements ordnungsgemäß zu verarbeiten. Diese Funktion sollte nur verwendet werden, wenn die OLE Steuern von Unterklassen ein Windows-Steuerelements und, in aufgerufen werden der `OnDraw` -Funktion des Steuerelements.  
  
 Weitere Informationen zu dieser Funktion und einer Fenstersteuerelement, finden Sie im Artikel [ActiveX-Steuerelemente: einer Fenstersteuerelement](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md).  
  
##  <a name="drawcontent"></a>COleControl::DrawContent  
 Vom Framework aufgerufen, wenn die Darstellung des Steuerelements muss aktualisiert werden.  
  
```  
void DrawContent(
    CDC* pDC,  
    CRect& rc);
```  
  
### <a name="parameters"></a>Parameter  
 `pDC`  
 Ein Zeiger auf den Gerätekontext.  
  
 `rc`  
 Rechteckige Bereich, gezeichnet werden soll.  
  
### <a name="remarks"></a>Hinweise  
 Diese Funktion ruft direkt die überschreibbare `OnDraw` Funktion.  
  
##  <a name="drawmetafile"></a>COleControl::DrawMetafile  
 Wird vom Framework aufgerufen, wenn es sich bei der Gerätekontext Metadatei verwendet wird.  
  
```  
void DrawMetafile(
    CDC* pDC,  
    CRect& rc);
```  
  
### <a name="parameters"></a>Parameter  
 `pDC`  
 Ein Zeiger auf den Gerätekontext Metadatei.  
  
 `rc`  
 Rechteckige Bereich, gezeichnet werden soll.  
  
##  <a name="enablesimpleframe"></a>COleControl::EnableSimpleFrame  
 Ermöglicht das einfache Frame Merkmal für OLE-Steuerelements an.  
  
```  
void EnableSimpleFrame();
```  
  
### <a name="remarks"></a>Hinweise  
 Dieses Merkmal ermöglicht eine Steuerung visual Kapselung der andere Steuerelemente, aber nicht "true" OLE-Kapselung zu unterstützen. Ein Beispiel wäre ein Gruppenfeld in mehrere Steuerelemente. Diese Steuerelemente sind nicht enthaltenen OLE, aber sie sind in der gleichen Gruppenfeld.  
  
##  <a name="exchangeextent"></a>COleControl::ExchangeExtent  
 Serialisiert oder den Zustand des Steuerelements Ausmaß initialisiert (seiner Dimensionen in **HIMETRIC** Einheiten).  
  
```  
BOOL ExchangeExtent(CPropExchange* pPX);
```  
  
### <a name="parameters"></a>Parameter  
 `pPX`  
 Ein Zeiger auf eine [CPropExchange](../../mfc/reference/cpropexchange-class.md) Objekt. Das Framework verwendet dieses Objekt aus, um den Kontext der Exchange-Eigenschaft, darunter seine Richtung einzurichten.  
  
### <a name="return-value"></a>Rückgabewert  
 Wert ungleich NULL, wenn die Funktion erfolgreich ausgeführt wurde; andernfalls 0.  
  
### <a name="remarks"></a>Hinweise  
 Diese Funktion wird normalerweise aufgerufen, indem Sie die standardmäßige Implementierung des `COleControl::DoPropExchange`.  
  
##  <a name="exchangestockprops"></a>COleControl::ExchangeStockProps  
 Serialisiert oder den Status der vordefinierten Eigenschaften des Steuerelements initialisiert.  
  
```  
void ExchangeStockProps(CPropExchange* pPX);
```  
  
### <a name="parameters"></a>Parameter  
 `pPX`  
 Ein Zeiger auf eine [CPropExchange](../../mfc/reference/cpropexchange-class.md) Objekt. Das Framework verwendet dieses Objekt aus, um den Kontext der Exchange-Eigenschaft, darunter seine Richtung einzurichten.  
  
### <a name="remarks"></a>Hinweise  
 Diese Funktion wird normalerweise aufgerufen, indem Sie die standardmäßige Implementierung des `COleControl::DoPropExchange`.  
  
##  <a name="exchangeversion"></a>COleControl:: ExchangeVersion  
 Serialisiert oder den Status der Versionsinformationen eines Steuerelements initialisiert.  
  
```  
BOOL ExchangeVersion(
    CPropExchange* pPX,  
    DWORD dwVersionDefault,  
    BOOL bConvert = TRUE);
```  
  
### <a name="parameters"></a>Parameter  
 `pPX`  
 Ein Zeiger auf eine `CPropExchange` Objekt. Das Framework verwendet dieses Objekt aus, um den Kontext der Exchange-Eigenschaft, darunter seine Richtung einzurichten.  
  
 `dwVersionDefault`  
 Die aktuelle Versionsnummer des Steuerelements.  
  
 `bConvert`  
 Gibt an, ob es sich bei permanente Daten konvertiert werden sollen, in das aktuelle Format, wenn gespeichert oder verwaltet werden, im gleichen Format, das geladen wurde.  
  
### <a name="return-value"></a>Rückgabewert  
 Wert ist ungleich NULL, der die Funktion erfolgreich ausgeführt wurde; andernfalls 0.  
  
### <a name="remarks"></a>Hinweise  
 Dies ist in der Regel wird die erste Funktion aufgerufen, die für ein Steuerelement: f Überschreibung von `COleControl::DoPropExchange`. Beim Laden von dieser Funktion liest die Versionsnummer der permanenten Daten und wird das Versionsattribut des der [CPropExchange](../../mfc/reference/cpropexchange-class.md) Objekt entsprechend. Beim Speichern, schreibt dieser Funktion die Versionsnummer der persistenten Daten.  
  
 Weitere Informationen zur Persistenz und versionsverwaltung finden Sie im Artikel [ActiveX-Steuerelemente: Serialisierung](../../mfc/mfc-activex-controls-serializing.md).  
  
##  <a name="fireclick"></a>COleControl::FireClick  
 Wird vom Framework aufgerufen, wenn die Maus über ein aktives Steuerelement geklickt wird.  
  
```  
void FireClick();
```  
  
### <a name="remarks"></a>Hinweise  
 Wenn dieses Ereignis als ein benutzerdefiniertes Ereignis definiert ist, bestimmen Sie, wann das Ereignis ausgelöst wird.  
  
 Für automatische ausgelöst Click-Ereignis auftritt, benötigen ereigniszuordnung des Steuerelements ein Aktienkurs auf Ereignis definiert.  
  
##  <a name="firedblclick"></a>COleControl::FireDblClick  
 Wird vom Framework aufgerufen, wenn die Maus über ein aktives Steuerelement doppelgeklickt wird.  
  
```  
void FireDblClick();
```  
  
### <a name="remarks"></a>Hinweise  
 Wenn dieses Ereignis als ein benutzerdefiniertes Ereignis definiert ist, bestimmen Sie, wann das Ereignis ausgelöst wird.  
  
 Für automatische Auslösen einer DblClick-Ereignis eintritt, müssen die ereigniszuordnung des Steuerelements ein vordefiniertes DblClick-Ereignis definiert.  
  
##  <a name="fireerror"></a>COleControl:: FireError  
 Wird ausgelöst, die vordefinierte Error-Ereignis.  
  
```  
void FireError(
    SCODE scode,  
    LPCTSTR lpszDescription,  
    UINT nHelpID = 0);
```  
  
### <a name="parameters"></a>Parameter  
 *SCODE*  
 Der Code Statuswert gemeldet werden. Eine vollständige Liste der möglichen Fehlercodes, finden Sie im Artikel [ActiveX-Steuerelemente: Weiterführende Themen](../../mfc/mfc-activex-controls-advanced-topics.md).  
  
 `lpszDescription`  
 Die Beschreibung des Fehlers, der gemeldet wird.  
  
 `nHelpID`  
 Die Hilfe-ID des Fehlers, der gemeldet wird.  
  
### <a name="remarks"></a>Hinweise  
 Dieses Ereignis bietet eine Möglichkeit zum Angeben sein können, an den entsprechenden Stellen in Ihrem Code, dass im Steuerelement ein Fehler aufgetreten ist. Im Gegensatz zu anderen vordefinierten Ereignissen, z. B. auf oder MouseMove wird Fehler durch das Framework niemals ausgelöst.  
  
 Aufrufen, um Fehler zu melden, die während einer Get-Eigenschaftsfunktion, Eigenschaft Set-Funktion oder Automatisierungsmethode auftritt, [ThrowError](#throwerror).  
  
 Die Implementierung eines OLE-Steuerelements Stock Fehler Ereignis verwendet ein `SCODE` Wert. Wenn das Steuerelement dieses Ereignis verwendet und in Visual Basic 4.0 verwendet werden soll, erhalten Sie Fehler, da die `SCODE` Wert wird in Visual Basic nicht unterstützt.  
  
 Um dieses Problem zu beheben, ändern Sie manuell die `SCODE` Parameter in des Steuerelements. ODL-Datei eine **lang**. Darüber hinaus eine beliebige benutzerdefinierte Ereignis, eine Methode oder eine Eigenschaft, verwendet eine `SCODE` Parameter bewirkt auch, dass das gleiche Problem.  
  
##  <a name="fireevent"></a>COleControl::  
 Löst ein benutzerdefiniertes Ereignis über das Steuerelement mit einer beliebigen Anzahl von optionalen Argumenten.  
  
```  
void AFX_CDECL FireEvent(
    DISPID dispid,  
    BYTE* pbParams,  
 ...);
```  
  
### <a name="parameters"></a>Parameter  
 `dispid`  
 Die Dispatch-ID des Ereignisses ausgelöst werden.  
  
 `pbParams`  
 Ein Deskriptor für das Ereignis Parametertypen.  
  
### <a name="remarks"></a>Hinweise  
 Diese Funktion sollte in der Regel nicht direkt aufgerufen werden. Stattdessen werden Sie die Ereignisse auslösen Funktionen im Ereignis Map-Abschnitt der Deklaration der Klasse des Steuerelements aufgerufen.  
  
 Die `pbParams` Argument ist eine durch Leerzeichen getrennte Liste von **VTS_**. Einer oder mehrere dieser Werte, durch Leerzeichen (nicht Kommas) getrennt, gibt bzw. geben die Parameterliste der Funktion an. Folgende Werte sind möglich:  
  
|Symbol|Parametertyp|  
|------------|--------------------|  
|**VTS_COLOR**|**OLE_COLOR**|  
|**VTS_FONT**|**IFontDisp\***|  
|**VTS_HANDLE**|`HWND`|  
|**VTS_PICTURE**|**Lpicturedisp\***|  
|**VTS_OPTEXCLUSIVE**|**OLE_OPTEXCLUSIVE\***|  
|**VTS_TRISTATE**|**OLE_TRISTATE**|  
|**VTS_XPOS_HIMETRIC**|**OLE_XPOS_HIMETRIC**|  
|**VTS_YPOS_HIMETRIC**|**OLE_YPOS_HIMETRIC**|  
|**VTS_XPOS_PIXELS**|**OLE_XPOS_PIXELS**|  
|**VTS_YPOS_PIXELS**|**OLE_YPOS_PIXELS**|  
|**VTS_XSIZE_PIXELS**|**OLE_XSIZE_PIXELS**|  
|**VTS_YSIZE_PIXELS**|**OLE_XSIZE_PIXELS**|  
|**VTS_XSIZE_HIMETRIC**|**OLE_XSIZE_HIMETRIC**|  
|**VTS_YSIZE_HIMETRIC**|**OLE_XSIZE_HIMETRIC**|  
  
> [!NOTE]
>  Zusätzliche Variante Konstanten für alle variant-Typen, mit Ausnahme von definiert wurden **VTS_FONT** und **VTS_PICTURE**, die einen Zeiger auf die Konstante variant-Daten bereitstellen. Diese Konstanten sind benannt der **VTS_P** `constantname` Konvention. Beispielsweise **VTS_PCOLOR** ist ein Zeiger auf eine **VTS_COLOR** konstant.  
  
##  <a name="firekeydown"></a>COleControl::FireKeyDown  
 Wird vom Framework aufgerufen, wenn eine Taste gedrückt wird, während das Steuerelement UI aktiv ist.  
  
```  
void FireKeyDown(
    USHORT* pnChar,  
    short nShiftState);
```  
  
### <a name="parameters"></a>Parameter  
 `pnChar`  
 Zeiger auf den virtueller Tastencode-Wert, der die gedrückte Taste. Eine Liste der standardmäßigen virtuellen Tastencodes finden Sie unter Winuser.h  
  
 `nShiftState`  
 Enthält eine Kombination der folgenden Flags:  
  
- **SHIFT_MASK** die UMSCHALTTASTE gedrückt wurde, während der Aktion.  
  
- **CTRL_MASK** die STRG-Taste gedrückt wurde, während der Aktion.  
  
- **ALT_MASK** die ALT-Taste gedrückt wurde, während der Aktion.  
  
### <a name="remarks"></a>Hinweise  
 Wenn dieses Ereignis als ein benutzerdefiniertes Ereignis definiert ist, bestimmen Sie, wann das Ereignis ausgelöst wird.  
  
 Für automatische Auslösen einer KeyDown-Ereignis eintritt, müssen die ereigniszuordnung des Steuerelements ein vordefiniertes KeyDown-Ereignis definiert.  
  
##  <a name="firekeypress"></a>COleControl::FireKeyPress  
 Wird vom Framework aufgerufen, wenn eine Taste gedrückt und losgelassen wird, während das benutzerdefinierte Steuerelement innerhalb des Containers UI aktiv ist.  
  
```  
void FireKeyPress(USHORT* pnChar);
```  
  
### <a name="parameters"></a>Parameter  
 `pnChar`  
 Ein Zeiger auf den Zeichenwert, der die gedrückte Taste.  
  
### <a name="remarks"></a>Hinweise  
 Wenn dieses Ereignis als ein benutzerdefiniertes Ereignis definiert ist, bestimmen Sie, wann das Ereignis ausgelöst wird.  
  
 Der Empfänger des Ereignisses darf ändern `pnChar`, z. B. alle Kleinbuchstaben in Großbuchstaben konvertieren. Wenn Sie das geänderte Zeichen überprüfen möchten, überschreiben `OnKeyPressEvent`.  
  
 Für automatische Auslösen einer KeyPress-Ereignis eintritt, müssen die ereigniszuordnung des Steuerelements ein vordefiniertes KeyPress-Ereignis definiert.  
  
##  <a name="firekeyup"></a>COleControl::FireKeyUp  
 Wird vom Framework aufgerufen, wenn eine Taste losgelassen wird, während das benutzerdefinierte Steuerelement innerhalb des Containers UI aktiv ist.  
  
```  
void FireKeyUp(
    USHORT* pnChar,  
    short nShiftState);
```  
  
### <a name="parameters"></a>Parameter  
 `pnChar`  
 Zeiger auf den virtueller Tastencode-Wert, der den freigegebenen Schlüssel. Eine Liste der standardmäßigen virtuellen Tastencodes finden Sie unter Winuser.h  
  
 `nShiftState`  
 Enthält eine Kombination der folgenden Flags:  
  
- **SHIFT_MASK** die UMSCHALTTASTE gedrückt wurde, während der Aktion.  
  
- **CTRL_MASK** die STRG-Taste gedrückt wurde, während der Aktion.  
  
- **ALT_MASK** die ALT-Taste gedrückt wurde, während der Aktion.  
  
### <a name="remarks"></a>Hinweise  
 Wenn dieses Ereignis als ein benutzerdefiniertes Ereignis definiert ist, bestimmen Sie, wann das Ereignis ausgelöst wird.  
  
 Für automatische Auslösen einer KeyUp-Ereignis eintritt, müssen die ereigniszuordnung des Steuerelements ein vordefiniertes KeyUp-Ereignis definiert.  
  
##  <a name="firemousedown"></a>COleControl::FireMouseDown  
 Wird vom Framework aufgerufen, wenn eine Maustaste, über ein aktives benutzerdefinierte Steuerelement gedrückt wird.  
  
```  
void FireMouseDown(
    short nButton,  
    short nShiftState,  
    OLE_XPOS_PIXELS x,  
    OLE_YPOS_PIXELS y);
```  
  
### <a name="parameters"></a>Parameter  
 `nButton`  
 Der numerische Wert der Maustaste gedrückt. Es kann einen der folgenden Werte enthalten:  
  
- **LEFT_BUTTON** die linke Maustaste gedrückt wurde.  
  
- **MIDDLE_BUTTON** die mittleren Maustaste gedrückt wurde.  
  
- **RIGHT_BUTTON** die rechte Maustaste gedrückt wurde.  
  
 `nShiftState`  
 Enthält eine Kombination der folgenden Flags:  
  
- **SHIFT_MASK** die UMSCHALTTASTE gedrückt wurde, während der Aktion.  
  
- **CTRL_MASK** die STRG-Taste gedrückt wurde, während der Aktion.  
  
- **ALT_MASK** die ALT-Taste gedrückt wurde, während der Aktion.  
  
 *x*  
 Die X-Koordinate des Cursors an, wenn eine Maustaste gedrückt wurde. Die Koordinate ist relativ zur linken oberen Ecke des Steuerelementfensters.  
  
 *y*  
 Die y-Koordinate des Cursors an, wenn eine Maustaste gedrückt wurde. Die Koordinate ist relativ zur linken oberen Ecke des Steuerelementfensters.  
  
### <a name="remarks"></a>Hinweise  
 Wenn dieses Ereignis als ein benutzerdefiniertes Ereignis definiert ist, bestimmen Sie, wann das Ereignis ausgelöst wird.  
  
 Für automatische Auslösen einer MouseDown-Ereignis eintritt, müssen die ereigniszuordnung des Steuerelements ein vordefiniertes MouseDown-Ereignis definiert.  
  
##  <a name="firemousemove"></a>COleControl::FireMouseMove  
 Wird vom Framework aufgerufen, wenn der Mauszeiger über ein aktives benutzerdefinierte Steuerelement bewegt wird.  
  
```  
void FireMouseMove(
    short nButton,  
    short nShiftState,  
    OLE_XPOS_PIXELS x,  
    OLE_YPOS_PIXELS y);
```  
  
### <a name="parameters"></a>Parameter  
 `nButton`  
 Der numerische Wert der Maustasten gedrückt. Enthält eine Kombination der folgenden Werte an:  
  
- **LEFT_BUTTON** die linke Maustaste gedrückt wurde, während der Aktion.  
  
- **MIDDLE_BUTTON** die mittleren Maustaste gedrückt wurde, während der Aktion.  
  
- **RIGHT_BUTTON** die rechte Maustaste gedrückt wurde, während der Aktion.  
  
 `nShiftState`  
 Enthält eine Kombination der folgenden Flags:  
  
- **SHIFT_MASK** die UMSCHALTTASTE gedrückt wurde, während der Aktion.  
  
- **CTRL_MASK** die STRG-Taste gedrückt wurde, während der Aktion.  
  
- **ALT_MASK** die ALT-Taste gedrückt wurde, während der Aktion.  
  
 *x*  
 Die X-Koordinate des Cursors. Die Koordinate ist relativ zur linken oberen Ecke des Steuerelementfensters.  
  
 *y*  
 Die y-Koordinate des Cursors. Die Koordinate ist relativ zur linken oberen Ecke des Steuerelementfensters.  
  
### <a name="remarks"></a>Hinweise  
 Wenn dieses Ereignis als ein benutzerdefiniertes Ereignis definiert ist, bestimmen Sie, wann das Ereignis ausgelöst wird.  
  
 Für automatische Auslösen einer MouseMove-Ereignis eintritt, müssen die ereigniszuordnung des Steuerelements ein vordefiniertes MouseMove-Ereignis definiert.  
  
##  <a name="firemouseup"></a>COleControl::FireMouseUp  
 Wird vom Framework aufgerufen, wenn eine Maustaste, über ein aktives benutzerdefinierte Steuerelement losgelassen wird.  
  
```  
void FireMouseUp(
    short nButton,  
    short nShiftState,  
    OLE_XPOS_PIXELS x,  
    OLE_YPOS_PIXELS y);
```  
  
### <a name="parameters"></a>Parameter  
 `nButton`  
 Der numerische Wert, der die Maustaste freigegeben werden soll. Es kann einen der folgenden Werte aufweisen:  
  
- **LEFT_BUTTON** die linke Maustaste losgelassen wurde.  
  
- **MIDDLE_BUTTON** die mittlere Maustaste losgelassen wurde.  
  
- **RIGHT_BUTTON** die rechte Maustaste losgelassen wurde.  
  
 `nShiftState`  
 Enthält eine Kombination der folgenden Flags:  
  
- **SHIFT_MASK** die UMSCHALTTASTE gedrückt wurde, während der Aktion.  
  
- **CTRL_MASK** die STRG-Taste gedrückt wurde, während der Aktion.  
  
- **ALT_MASK** die ALT-Taste gedrückt wurde, während der Aktion.  
  
 *x*  
 Die X-Koordinate des Cursors an, wenn eine Maustaste losgelassen wurde. Die Koordinate ist relativ zur linken oberen Ecke des Steuerelementfensters.  
  
 *y*  
 Die y-Koordinate eines Cursors, wenn eine Maustaste losgelassen wurde. Die Koordinate ist relativ zur linken oberen Ecke des Steuerelementfensters.  
  
### <a name="remarks"></a>Hinweise  
 Wenn dieses Ereignis als ein benutzerdefiniertes Ereignis definiert ist, bestimmen Sie, wann das Ereignis ausgelöst wird.  
  
 Für automatische Auslösen einer MouseUp-Ereignis eintritt, müssen die ereigniszuordnung des Steuerelements ein vordefiniertes MouseUp-Ereignis definiert.  
  
##  <a name="firereadystatechange"></a>COleControl::FireReadyStateChange  
 Löst ein Ereignis mit dem aktuellen Wert des Status des Steuerelements bereit.  
  
```  
void FireReadyStateChange();
```  
  
### <a name="remarks"></a>Hinweise  
 Der Status "bereit" ist einer der folgenden Werte möglich:  
  
 **READYSTATE_UNINITIALIZED**  
 Initialisierung Standardstatus  
  
 **READYSTATE_LOADING**  
 Steuerelement ist seine Eigenschaften derzeit geladen werden.  
  
 **READYSTATE_LOADED**  
 Steuerelement wurde initialisiert.  
  
 **READYSTATE_INTERACTIVE**  
 Das Steuerelement genügend Daten für die interaktive werden jedoch nicht alle asynchrone Daten werden noch geladen.  
  
 `READYSTATE_COMPLETE`  
 Steuerelement verfügt über alle ihre Daten  
  
 Verwendung [GetReadyState abrufbar](#getreadystate) aktuelle Bereitschaft des Steuerelements zu bestimmen.  
  
 [InternalSetReadyState beispielsweise](#internalsetreadystate) ändert den Status "bereit" mit dem angegebenen Wert und ruft dann `FireReadyStateChange`.  
  
##  <a name="getactivationpolicy"></a>COleControl:: GetActivationPolicy  
 Ändert das Standardverhalten für die Aktivierung eines Steuerelements, das unterstützt die `IPointerInactive` Schnittstelle.  
  
```  
virtual DWORD GetActivationPolicy();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Eine Kombination aus Flags aus der **POINTERINACTIVE** Enumeration. Mögliche Flags sind:  
  
 **POINTERINACTIVE_ACTIVATEONENTRY**  
 Das Objekt sollte direktes aktiviert, wenn der Mauszeiger während eines Verschiebevorgangs Maus bewegt.  
  
 **POINTERINACTIVE_DEACTIVATEONLEAVE**  
 Das Objekt sollte deaktiviert werden, wenn der Mauszeiger über das Objekt bei einer Maus Verschiebevorgangs verlässt.  
  
 **POINTERINACTIVE_ACTIVATEONDRAG**  
 Das Objekt sollte werden aktiviert, wenn die Maus über diese gezogen wird, während eines Ziehvorgangs an Ort und drop-Vorgangs.  
  
### <a name="remarks"></a>Hinweise  
 Wenn die `IPointerInactive` Schnittstelle aktiviert ist, wird der Container Delegieren `WM_SETCURSOR` und `WM_MOUSEMOVE` Nachrichten darauf. `COleControl`die Implementierung dieser Schnittstelle werden diese Nachrichten über das Steuerelement meldungszuordnung, verteilen, nach dem Anpassen der Maus entsprechend koordiniert.  
  
 Wenn der Container empfängt eine `WM_SETCURSOR` oder `WM_MOUSEMOVE` Nachricht mit den Mauszeiger über einem inaktiven Objekt unterstützen `IPointerInactive`, sollten sie aufrufen `GetActivationPolicy` auf die Schnittstelle und return Flags aus der **POINTERINACTIVE** Enumeration.  
  
 Indem Sie die entsprechenden Einträge an die meldungszuordnung kann diese Nachrichten genau wie normale Windows-Meldungen verarbeitet werden. In Ihrer Handler vermeiden Sie die Verwendung der `m_hWnd` Membervariablen gespeichert (oder alle Memberfunktionen, die verwendet werden) erst überprüfen, dass der Wert nicht **NULL**.  
  
 Jedes Objekt gedacht mehr als legen Sie den Mauszeiger und/oder eine Mauszeigerposition ausgelöste Ereignis auslösen, z. B. als spezielles visuelles Feedback, anzuzeigen sollte Zurückgeben der **POINTERINACTIVE_ACTIVATEONENTRY** kennzeichnen und zeichnen Sie das Feedback nur, wenn active. Wenn das Objekt dieses Flag zurückgibt, der Container aktivieren sie direkte sofort und anschließend weiterleiten, dieselbe Meldung, die den Aufruf von ausgelöst sollte `GetActivationPolicy`.  
  
 Wenn beide die **POINTERINACTIVE_ACTIVATEONENTRY** und **POINTERINACTIVE_DEACTIVATEONLEAVE** Flags werden zurückgegeben, und klicken Sie dann das Objekt wird nur aktiviert, wenn der Mauszeiger über das Objekt befindet. Wenn nur die **POINTERINACTIVE_ACTIVATEONENTRY** Flag wird zurückgegeben, und klicken Sie dann das Objekt wird nur aktiviert, sobald bei der Mauszeiger auf das Objekt bewegt.  
  
 Sie sollten auch ein Inaktives Steuerelement nicht das Ziel einer OLE-Drag und drop-Vorgangs. Dies erfordert, aktivieren das Steuerelement zum Zeitpunkt, den der Benutzer auf, ein Objekt bewegt, damit das Fenster des Steuerelements als Ablageziel registriert werden kann. Um während eines Ziehvorgangs-Aktivierung zu veranlassen, zurückzugeben der **POINTERINACTIVE_ACTIVATEONDRAG** Kennzeichen:  
  
 [!code-cpp[NVC_MFCAxCtl Nr. 1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]  
  
 Die Informationen übermittelt von `GetActivationPolicy` nicht von einem Container zwischengespeichert werden. Stattdessen sollte diese Methode aufgerufen werden, jedes Mal, wenn der Mauszeiger in einem inaktiven Objekt eintritt.  
  
 Wenn einem inaktiven Objekt direktes aktiviert, wenn der Mauszeiger bewegt wird, es werden keine anfordert, sollte dessen Container nachfolgende dispatch `WM_SETCURSOR` Nachrichten an dieses Objekt durch Aufrufen von [OnInactiveSetCursor](#oninactivesetcursor) solange sich der Mauszeiger über dem Objekt bleibt.  
  
 Aktivieren der `IPointerInactive` Schnittstelle in der Regel bedeutet, dass Sie das Steuerelement für die Verarbeitung von Maus Nachrichten jederzeit geeignet sein soll. Dieses Verhalten in einem Container abgerufen wird, die nicht unterstützt die `IPointerInactive` -Schnittstelle, müssen Sie das Steuerelement immer aktiviert werden, wenn sichtbar ist, was bedeutet, dass das Steuerelement muss die **OLEMISC_ACTIVATEWHENVISIBLE** Flag zwischen den verschiedenen Flags. Um zu verhindern, dass dieses Flag aus Effekt in einem Container durchzuführen, unterstützt jedoch `IPointerInactive`, Sie können auch angeben, die **OLEMISC_IGNOREACTIVATEWHENVISIBLE** Kennzeichen:  
  
 [!code-cpp[NVC_MFCAxCtl #10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]  
  
##  <a name="getambientproperty"></a>COleControl:: GetAmbientProperty  
 Ruft den Wert der ambient-Eigenschaft des Containers ab.  
  
```  
BOOL GetAmbientProperty(
    DISPID dispid,  
    VARTYPE vtProp,  
    void* pvProp);
```  
  
### <a name="parameters"></a>Parameter  
 *dwDispid*  
 Die Dispatch-ID der gewünschten ambient-Eigenschaft.  
  
 `vtProp`  
 Ein variant-Typ-Tag, der angibt, der Typ des Werts im zurückzugebenden `pvProp`.  
  
 `pvProp`  
 Ein Zeiger auf die Adresse der Variablen, die den Wert der Eigenschaft empfangen oder Rückgabewert. Der tatsächliche Typ des this-Zeigers muss den vom angegebenen Typ übereinstimmen `vtProp`.  
  
|vtProp|Typ des pvProp|  
|------------|--------------------|  
|`VT_BOOL`|**BOOL\***|  
|`VT_BSTR`|**CString\***|  
|`VT_I2`|**kurze\***|  
|`VT_I4`|**lange\***|  
|`VT_R4`|**"float"\***|  
|`VT_R8`|**Double\***|  
|`VT_CY`|**CY\***|  
|**DEN WERT VT_COLOR**|**OLE_COLOR\***|  
|**VT_DISPATCH**|**LPDISPATCH\***|  
|**VT_FONT**|**LPFONTDISP\***|  
  
### <a name="return-value"></a>Rückgabewert  
 Der Wert ist ungleich NULL, wenn die Ambiente-Eigenschaft unterstützt wird; andernfalls 0.  
  
### <a name="remarks"></a>Hinweise  
 Bei Verwendung von `GetAmbientProperty` legen Sie zum Abrufen der Umgebungseigenschaften "DisplayName" und "ScaleUnits" `vtProp` auf `VT_BSTR` und `pvProp` auf **CString\***. Wenn Sie die Ambiente-Font-Eigenschaft abrufen, festlegen `vtProp` auf **VT_FONT** und `pvProp` auf **LPFONTDISP\***.  
  
 Beachten Sie, dass Funktionen wie z. B. bereits für allgemeine Umgebungseigenschaften, angegeben wurden [AmbientBackColor](#ambientbackcolor) und [AmbientFont](#ambientfont).  
  
##  <a name="getappearance"></a>COleControl::GetAppearance  
 Implementiert die Funktion Get stock Darstellung-Eigenschaft des Steuerelements an.  
  
```  
short GetAppearance ();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Der Rückgabewert gibt an, die aktuelle Einstellung für die Darstellung als eine **kurze** ( `VT_I2`) Wert, wenn erfolgreich. Dieser Wert ist 0 (null), wenn die Darstellung des Steuerelements Flatfile und 1 ist, ist die Darstellung des Steuerelements 3D.  
  
##  <a name="getbackcolor"></a>COleControl::GetBackColor  
 Implementiert die Get-Funktion des vordefinierten BackColor-Eigenschaft des Steuerelements an.  
  
```  
OLE_COLOR GetBackColor();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Der Rückgabewert gibt die aktuelle Hintergrundfarbe als eine **OLE_COLOR** Wert, wenn erfolgreich. Dieser Wert übersetzt werden kann, um eine **COLORREF** Wert mit einem Aufruf von `TranslateColor`.  
  
##  <a name="getborderstyle"></a>COleControl::GetBorderStyle  
 Implementiert die Funktion Get der vordefinierten BorderStyle-Eigenschaft des Steuerelements an.  
  
```  
short GetBorderStyle();
```  
  
### <a name="return-value"></a>Rückgabewert  
 1, wenn das Steuerelement einen normalen Rahmen hat; 0, wenn das Steuerelement kein Rahmen hat.  
  
##  <a name="getcapture"></a>COleControl::GetCapture  
 Bestimmt, ob die `COleControl` Objekt hat die Mauseingaben aufzufangen.  
  
```  
CWnd* GetCapture();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Gibt zurück, wenn das Steuerelement aktiviert und das fensterlose, **dies** , wenn das Steuerelement gerade das Erfassen von Mauseingaben (wie von der Container des Steuerelements angegeben wird), hat oder **NULL** , wenn sie nicht über die Erfassung verfügt.  
  
 Anderenfalls gibt die `CWnd` -Objekt, das die mausaufzeichnung verfügen (wie `CWnd::GetCapture`).  
  
### <a name="remarks"></a>Hinweise  
 Ein aktiviertes fensterloses Steuerelement empfängt die Maus erfassen, wenn [SetCapture](#setcapture) aufgerufen wird.  
  
##  <a name="getclassid"></a>COleControl::GetClassID  
 Vom Framework aufgerufen, die OLE-Klassen-ID des Steuerelements abzurufen.  
  
```  
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;  
```  
  
### <a name="parameters"></a>Parameter  
 *pclsid*  
 Zeiger auf den Speicherort der Klassen-ID.  
  
### <a name="return-value"></a>Rückgabewert  
 Wert ungleich NULL, wenn der Aufruf nicht erfolgreich war; andernfalls 0.  
  
### <a name="remarks"></a>Hinweise  
 In der Regel implementiert, indem die [IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex).  
  
##  <a name="getclientoffset"></a>COleControl::GetClientOffset  
 Ruft die Differenz zwischen der oberen linken Ecke des rechteckigen Bereich des Steuerelements und der oberen linken Ecke des Clientbereichs ab.  
  
```  
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;  
```  
  
### <a name="parameters"></a>Parameter  
 *pdxOffset*  
 Ein Zeiger auf den horizontalen Offset des Clientbereichs des OLE-Steuerelements.  
  
 *pdyOffset*  
 Ein Zeiger auf den vertikalen Offset des Clientbereichs des OLE-Steuerelements.  
  
### <a name="remarks"></a>Hinweise  
 OLE-Steuerelements verfügt über einen rechteckigen Bereich innerhalb des Containers. Das den Clientbereich des Steuerelements ist das Ausschließen von Rahmen und Bildlaufleisten Steuerelementbereich. Der Offset von abgerufenen `GetClientOffset` ist der Unterschied zwischen der oberen linken Ecke des rechteckigen Bereich des Steuerelements und der oberen linken Ecke des Clientbereichs. Wenn das Steuerelement nicht-Client-Elemente als standard Rahmen und Bildlaufleisten verfügt, überschreiben Sie diese Memberfunktion um den Offset anzugeben.  
  
##  <a name="getclientrect"></a>COleControl::GetClientRect  
 Ruft die Größe des Clientbereichs des Steuerelements ab.  
  
```  
virtual void GetClientRect(LPRECT lpRect) const;  
```  
  
### <a name="parameters"></a>Parameter  
 `lpRect`  
 Zeiger auf eine `RECT` Struktur, die die Abmessungen des Clientbereichs der fensterloses Steuerelement enthält, d. h. die Größe des Steuerelements minus Fensterrahmen, Frames, Bildlaufleisten und So weiter. Die `lpRect` Parameter gibt die Größe des Steuerelements Clientrechteck, nicht seine Position an.  
  
##  <a name="getclientsite"></a>COleControl::GetClientSite  
 Fragt ein Objekt für den Zeiger an den aktuellen Clientstandort innerhalb des Containers.  
  
```  
LPOLECLIENTSITE GetClientSite();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Ein Zeiger auf die aktuelle Clientstandort des Steuerelements in dessen Container.  
  
### <a name="remarks"></a>Hinweise  
 Der zurückgegebene Zeiger verweist auf eine Instanz von `IOleClientSite`. Die `IOleClientSite` Schnittstelle, die von Containern implementiert wird das Objekt Überblick über seinen Kontext: an, wo es im Dokument, in dem er seinen Speicher, Benutzeroberfläche und andere Ressourcen ruft verankert ist.  
  
##  <a name="getcontrolflags"></a>COleControl:: GetControlFlags  
 Ruft die Steuerelement-Flageinstellungen ab.  
  
```  
virtual DWORD GetControlFlags();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Ein ORed Kombination der Flags in der Enumeration ControlFlags:  
  
```  
enum ControlFlags {
    fastBeginPaint = 0x0001,
    clipPaintDC = 0x0002,
    pointerInactive = 0x0004,
    noFlickerActivate = 0x0008,
    windowlessActivate = 0x0010,
    canOptimizeDraw = 0x0020,
    };  
```  
  
### <a name="remarks"></a>Hinweise  
 Standardmäßig `GetControlFlags` gibt `fastBeginPaint | clipPaintDC`.  
  
 `fastBeginPaint`  
 Wenn festgelegt, verwendet eine Begin-Paint-Funktion für OLE-Steuerelemente anstelle von zugeschnitten sind die [BeginPaint](http://msdn.microsoft.com/library/windows/desktop/dd183362) API (standardmäßig festgelegt).  
  
 `clipPaintDC`  
 Wenn nicht festgelegt, wird den Aufruf von deaktiviert `IntersectClipRect` von vorgenommenen `COleControl` und erhält einen geringen Leistungsvorteil. Wenn Sie fensterlosen Aktivierung verwenden, ist das Flag keine Auswirkung.  
  
 `pointerInactive`  
 Wenn festgelegt, Mausinteraktion enthält, während das Steuerelement aktiv ist, durch Aktivieren der `COleControl`des Implementierung der `IPointerInactive` -Schnittstelle, die standardmäßig deaktiviert ist.  
  
 `noFlickerActivate`  
 Wenn festgelegt, zusätzliche Zeichenvorgänge und die damit verbundene Flimmern vermieden. Wird verwendet, wenn das Steuerelement selbst in die inaktiven und den aktiven Status identisch zeichnet. Wenn Sie fensterlosen Aktivierung verwenden, ist das Flag keine Auswirkung.  
  
 `windowlessActivate`  
 Wenn festgelegt, wird das Steuerelement verwendeten fensterlosen Aktivierung angibt.  
  
 `canOptimizeDraw`  
 Wenn festgelegt ist, gibt an, dass das Steuerelement optimierte Zeichnung ausgeführt werden, wenn der Container unterstützt.  
  
 Weitere Informationen zu `GetControlFlags` und andere Optimierungen der OLE-Steuerelemente finden Sie unter [ActiveX-Steuerelemente: Optimierung](../../mfc/mfc-activex-controls-optimization.md).  
  
##  <a name="getcontrolsize"></a>COleControl::GetControlSize  
 Ruft die Größe des Fensters OLE-Steuerelements ab.  
  
```  
void GetControlSize(
    int* pcx,  
    int* pcy);
```  
  
### <a name="parameters"></a>Parameter  
 *PCX*  
 Gibt die Breite des Steuerelements in Pixel an.  
  
 *pcy*  
 Gibt die Höhe des Steuerelements in Pixel an.  
  
### <a name="remarks"></a>Hinweise  
 Beachten Sie, dass alle Koordinaten für das Steuerelement Windows relativ zur linken oberen Ecke des Steuerelements.  
  
##  <a name="getdc"></a>COleControl::GetDC  
 Stellt Sie bereit für ein Objekt fensterlose Gerätekontext Get einem Bildschirm (oder kompatible) aus dem zugehörigen Container an.  
  
```  
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```  
  
### <a name="parameters"></a>Parameter  
 *lprcRect*  
 Ein Zeiger auf das Rechteck fensterloses Steuerelement möchte, in Clientkoordinaten der das Steuerelement neu gezeichnet werden. **NULL** bedeutet, dass das vollständige Objekt Block.  
  
 `dwFlags`  
 Zeichnungsattribute des Gerätekontexts. Diese Wahlmöglichkeiten:  
  
- **OLEDC_NODRAW** gibt an, dass das Objekt den Gerätekontext ausführen alle zeichnen jedoch lediglich zum Abrufen von Informationen zu dem Anzeigegerät verwenden werden. Der Container sollten einfach das Fenster DC übergeben, ohne weitere Verarbeitung.  
  
- **OLEDC_PAINTBKGND** angefordert wird, dass der Container der Hintergrund gezeichnet wird, vor der Rückgabe des Domänencontrollers. Ein Objekt sollten dieses Flag verwenden, wenn sie einen Domänencontroller für einen Bereich mit einem transparenten Hintergrund Neuzeichnen angefordert wird.  
  
- **OLEDC_OFFSCREEN** informiert den Container, der möchte, dass das Objekt in eine Bitmap außerhalb des Bildschirms gerendert werden, die dann an den Bildschirm kopiert werden sollen. Ein Objekt sollten dieses Flag verwenden, wenn die Zeichenvorgangs an, sie führen einen Großteil des Flimmerns generiert. Der Container kann diese Anforderung oder nicht berücksichtigt. Jedoch wenn dieses Flag nicht festgelegt ist, der Container muss manuell wieder ein auf dem Bildschirm DC. Dadurch können Objekte, z. B. eine Auswahl mit direkten Bildschirm Operationen (über eine **XOR** Vorgang).  
  
### <a name="return-value"></a>Rückgabewert  
 Zeiger auf das Gerät Anzeigekontext für den Container `CWnd` Clientbereich Wenn erfolgreich; andernfalls der Rückgabewert ist **NULL**. Der Anzeigekontext für das Gerät kann in nachfolgenden GDI-Funktionen verwendet werden, um im Clientbereich des Fensters für den Container zu zeichnen.  
  
### <a name="remarks"></a>Hinweise  
 Die [ReleaseDC](#releasedc) Memberfunktion aufgerufen werden, um den Kontext nach dem Zeichnen freigeben. Beim Aufrufen von `GetDC`, Objekte übergeben, das Rechteck werden in in ihre eigenen Clientkoordinaten zeichnen soll. `GetDC`übersetzt diese Koordinaten des Clientbereichs Container. Das Objekt sollte nicht anfordern, eine gewünschte zeichnen Rechteck größer als einen eigenen Bereich Clientrechteck, deren Größe abgerufen werden kann, mit [GetClientRect](#getclientrect). Dadurch wird verhindert, dass Objekte versehentlich zeichnen, in denen nicht auf für Sie bestimmt sind.  
  
##  <a name="getenabled"></a>COleControl::GetEnabled  
 Implementiert die Get-Funktion an das Steuerelement Enabled-Eigenschaft.  
  
```  
BOOL GetEnabled();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Wert ungleich NULL, wenn das Steuerelement aktiviert ist; andernfalls 0.  
  
##  <a name="getextendedcontrol"></a>COleControl::GetExtendedControl  
 Erhält einen Zeiger auf ein Objekt, das Beibehalten von Container, von der das Steuerelement einen erweiterten Satz von Eigenschaften darstellt.  
  
```  
LPDISPATCH GetExtendedControl();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Ein Zeiger auf den Container des Steuerelementobjekts erweitert. Wenn kein Objekt vorhanden ist, ist der Wert **NULL**.  
  
 Dieses Objekt kann bearbeitet werden, über dessen `IDispatch` Schnittstelle. Sie können auch `QueryInterface` zum Abrufen von anderen verfügbaren Schnittstellen, die vom Objekt bereitgestellt werden. Das Objekt ist jedoch nicht erforderlich, um einen bestimmten Satz von Schnittstellen unterstützen. Beachten Sie, dass der vertrauenden Seite, auf die bestimmten Funktionen des erweiterten Steuerelementobjekt des Containers die Portabilität des Steuerelements an andere beliebige Container beschränkt.  
  
### <a name="remarks"></a>Hinweise  
 Die Funktion, die diese Funktion ruft ist verantwortlich für die Freigabe des Zeigers, wenn das Objekt abgeschlossen. Beachten Sie, dass der Container nicht erforderlich ist, um dieses Objekt zu unterstützen.  
  
##  <a name="getfocus"></a>COleControl::GetFocus  
 Bestimmt, ob die `COleControl` Objekt den Fokus besitzt.  
  
```  
CWnd* GetFocus();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Gibt zurück, wenn das Steuerelement aktiviert und das fensterlose, **dies** Wenn das Steuerelement den Tastaturfokus (wie von der Container des Steuerelements angegeben wird), derzeit besitzt oder **NULL** , wenn sie nicht den Fokus verfügt.  
  
 Andernfalls gibt die `CWnd` -Objekt, das den Fokus besitzt (identisch mit `CWnd::GetFocus`).  
  
### <a name="remarks"></a>Hinweise  
 Ein aktiviertes fensterloses Steuerelement den Fokus erhält, wenn [SetFocus](#setfocus) aufgerufen wird.  
  
##  <a name="getfont"></a>COleControl::GetFont  
 Implementiert die Get-Funktion, der die vordefinierte Schriftarteigenschaft an.  
  
```  
LPFONTDISP GetFont();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Ein Zeiger auf die Schriftart Dispatch-Schnittstelle des Steuerelements Stock Font-Eigenschaft.  
  
### <a name="remarks"></a>Hinweise  
 Beachten Sie, dass das Objekt nach Abschluss des Aufrufers freigegeben werden muss. Verwenden Sie in der Implementierung des Steuerelements, `InternalGetFont` auf das Steuerelement stock Font-Objekt. Weitere Informationen zur Verwendung von Schriftarten in das Steuerelement finden Sie im Artikel [ActiveX-Steuerelemente: Verwenden von Schriftarten in einem ActiveX-Steuerelement](../../mfc/mfc-activex-controls-using-fonts.md).  
  
##  <a name="getfonttextmetrics"></a>COleControl::GetFontTextMetrics  
 Misst die Text-Metriken für eine beliebige `CFontHolder` Objekt, dessen Besitzer des Steuerelements.  
  
```  
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,  
    CFontHolder& fontHolder);
```  
  
### <a name="parameters"></a>Parameter  
 `lptm`  
 Zeiger auf eine [TEXTMETRIC](http://msdn.microsoft.com/library/windows/desktop/dd145132) Struktur.  
  
 `fontHolder`  
 Ein Verweis auf eine [CFontHolder](../../mfc/reference/cfontholder-class.md) Objekt.  
  
### <a name="remarks"></a>Hinweise  
 Eine solche Schriftart kann ausgewählt werden, mit der [COleControl::SelectFontObject](#selectfontobject) Funktion. `GetFontTextMetrics`Initialisiert die `TEXTMETRIC` Struktur verweist `lptm` mit gültigen metrikinformationen `fontHolder`Schriftart im Erfolgsfall den oder die Struktur mit Nullen aufgefüllt werden, wenn nicht erfolgreich war. Sie sollten diese Funktion statt des verwenden [GetTextMetrics](http://msdn.microsoft.com/library/windows/desktop/dd144941) beim Zeichnen des Steuerelements, da Steuerelemente, z. B. OLE-Objekt eingebettete möglicherweise erforderlich selbst in einer Metadatei darzustellen.  
  
 Die `TEXTMETRIC` Struktur für die Standardschriftart wird aktualisiert, wenn die [SelectFontObject](#selectfontobject) Funktion aufgerufen wird. Rufen Sie `GetFontTextMetrics` nur nach der Auswahl der vordefinierten Schriftarteigenschaft, um die Informationen zu gewährleisten, es bietet, gültig ist.  
  
##  <a name="getforecolor"></a>COleControl::GetForeColor  
 Implementiert die Funktion Get der vordefinierten ForeColor-Eigenschaft.  
  
```  
OLE_COLOR GetForeColor();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Der Rückgabewert gibt an, die aktuelle Vordergrundfarbe als eine **OLE_COLOR** Wert, wenn erfolgreich. Dieser Wert übersetzt werden kann, um eine [COLORREF](http://msdn.microsoft.com/library/windows/desktop/dd183449) Wert mit einem Aufruf von `TranslateColor`.  
  
##  <a name="gethwnd"></a>COleControl::GetHwnd  
 Implementiert die Funktion Get der vordefinierten hWnd-Eigenschaft.  
  
```  
OLE_HANDLE GetHwnd();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Die OLE Fensterhandle des Steuerelements, falls vorhanden; andernfalls **NULL**.  
  
##  <a name="getmessagestring"></a>COleControl::GetMessageString  
 Wird aufgerufen, durch das Framework um eine kurze Zeichenfolge abzurufen, die den Zweck des Menüelements identifizierte beschreibt `nID`.  
  
```  
virtual void GetMessageString(
    UINT nID,  
    CString& rMessage) const;  
```  
  
### <a name="parameters"></a>Parameter  
 `nID`  
 Ein Menü-ID auf.  
  
 `rMessage`  
 Ein Verweis auf eine [CString](../../atl-mfc-shared/reference/cstringt-class.md) -Objekt über die eine Zeichenfolge zurückgegeben wird.  
  
### <a name="remarks"></a>Hinweise  
 Dies kann verwendet werden, um eine Nachricht für die Anzeige in einer Statusleiste zu erhalten, während das Menüelement hervorgehoben ist. Die standardmäßige Implementierung versucht, beim Laden einer Zeichenfolgenressource identifizierten `nID`.  
  
##  <a name="getnotsupported"></a>COleControl::GetNotSupported  
 Verhindert den Zugriff auf den Eigenschaftswert eines Steuerelements, durch den Benutzer.  
  
```  
void GetNotSupported();
```  
  
### <a name="remarks"></a>Hinweise  
 Mit dieser Funktion werden anstelle der Get-Funktion, einer beliebigen Eigenschaft, in dem das Abrufen der Eigenschaft durch Benutzer des Steuerelements nicht unterstützt. Ein Beispiel wäre eine Eigenschaft, die lesegeschützt ist.  
  
##  <a name="getreadystate"></a>COleControl::GetReadyState  
 Gibt den Bereitschaftsstatus des Steuerelements zurück.  
  
```  
long GetReadyState();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Der Bereitschaftsstatus des Steuerelements, einen der folgenden Werte:  
  
 **READYSTATE_UNINITIALIZED**  
 Initialisierung Standardstatus  
  
 **READYSTATE_LOADING**  
 Steuerelement ist seine Eigenschaften derzeit geladen werden.  
  
 **READYSTATE_LOADED**  
 Steuerelement wurde initialisiert.  
  
 **READYSTATE_INTERACTIVE**  
 Das Steuerelement genügend Daten für die interaktive werden jedoch nicht alle asynchrone Daten werden noch geladen.  
  
 `READYSTATE_COMPLETE`  
 Steuerelement verfügt über alle ihre Daten  
  
### <a name="remarks"></a>Hinweise  
 Die meisten einfachen Steuerelemente müssen nie Unterscheidung zwischen **LOADED** und `INTERACTIVE`. Allerdings Steuerelemente, die Daten Pfadeigenschaften unterstützen möglicherweise nicht bereit für die interaktive bis mindestens einige Daten asynchron empfangen werden. Ein Steuerelement sollten versuchen, interaktive so bald wie möglich sind.  
  
##  <a name="getrectincontainer"></a>COleControl::GetRectInContainer  
 Ruft die Koordinaten der das Rechteck des Steuerelements relativ zu dem Container, ausgedrückt in Geräteeinheiten ab.  
  
```  
BOOL GetRectInContainer(LPRECT lpRect);
```  
  
### <a name="parameters"></a>Parameter  
 `lpRect`  
 Ein Zeiger auf die Rechteckstruktur, die in die Koordinaten des Steuerelements kopiert werden.  
  
### <a name="return-value"></a>Rückgabewert  
 Wert ungleich NULL, wenn das Steuerelement in-Place aktiv ist; andernfalls 0.  
  
### <a name="remarks"></a>Hinweise  
 Das Rechteck ist nur gültig, wenn das Steuerelement in-Place aktiv ist.  
  
##  <a name="getstocktextmetrics"></a>COleControl::GetStockTextMetrics  
 Misst die Text-Metriken für das Steuerelement vordefinierte Schriftarteigenschaft, die mit ausgewählt werden, kann die [SelectStockFont](#selectstockfont) Funktion.  
  
```  
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```  
  
### <a name="parameters"></a>Parameter  
 `lptm`  
 Ein Zeiger auf eine [TEXTMETRIC](http://msdn.microsoft.com/library/windows/desktop/dd145132) Struktur.  
  
### <a name="remarks"></a>Hinweise  
 Die `GetStockTextMetrics` Funktion initialisiert den `TEXTMETRIC` Struktur verweist `lptm` gültige metrikinformationen im Erfolgsfall oder Füllung der Struktur mit Nullen aufgefüllt, wenn nicht erfolgreich war. Verwenden Sie diese Funktion anstelle von [GetTextMetrics](http://msdn.microsoft.com/library/windows/desktop/dd144941) beim Zeichnen des Steuerelements, da Steuerelemente, z. B. OLE-Objekt eingebettete möglicherweise erforderlich selbst in einer Metadatei darzustellen.  
  
 Die `TEXTMETRIC` Struktur für die Standardschriftart wird aktualisiert, wenn die `SelectStockFont` Funktion aufgerufen wird. Sie sollten diese Funktion aufrufen, erst nach dem Auswählen der vordefinierten Schriftart, um die Informationen zu gewährleisten, bietet ein gültig ist.  
  
##  <a name="gettext"></a>COleControl::GetText  
 Implementiert die Funktion Get von der Systemeigenschaft oder Beschriftungstitel an.  
  
```  
BSTR GetText();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Der aktuelle Wert der Text-Zeichenfolge oder eine Zeichenfolge der Länge 0 (null), wenn keine Zeichenfolge vorhanden ist.  
  
> [!NOTE]
>  Weitere Informationen zu den `BSTR` -Datentyp, finden Sie unter [Datentypen](../../mfc/reference/data-types-mfc.md) im Abschnitt Makros und Globals.  
  
### <a name="remarks"></a>Hinweise  
 Beachten Sie, die der Aufrufer diese Funktion aufrufen muss `SysFreeString` auf die Zeichenfolge zurückgegeben, um freien die Ressource. Verwenden Sie in der Implementierung des Steuerelements, `InternalGetText` Zugriff auf vordefinierte oder Beschriftungstitel-Eigenschaft des Steuerelements.  
  
##  <a name="getwindowlessdroptarget"></a>COleControl:: GetWindowlessDropTarget  
 Überschreiben Sie `GetWindowlessDropTarget` soll ein fensterloses Steuerelement an das Ziel ein OLE Drag & drop-Vorgangs.  
  
```  
virtual IDropTarget* GetWindowlessDropTarget();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Zeiger auf das Objekt `IDropTarget` Schnittstelle. Ein fensterlose-Objekt kann nicht registriert werden, da sie nicht über ein Fenster verfügt, eine `IDropTarget` Schnittstelle. Allerdings für die Teilnahme Drag & Drop ein fensterlose Objekt kann weiterhin die Schnittstelle implementieren und gibt es in `GetWindowlessDropTarget`.  
  
### <a name="remarks"></a>Hinweise  
 Normalerweise würde dies erfordert, dass das Fenster des Steuerelements als Ablageziel registriert werden. Aber da das Steuerelement kein eigenes Fenster hat, verwenden der Container ein eigenen Fenster als Drop-Ziel. Das Steuerelement einfach eine Implementierung bereitstellen muss die `IDropTarget` Schnittstelle zu der der Container Aufrufe zum entsprechenden Zeitpunkt delegieren. Zum Beispiel:  
  
 [!code-cpp[NVC_MFCAxCtl #2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]  
  
##  <a name="initializeiids"></a>COleControl::InitializeIIDs  
 Benachrichtigt die Basisklasse, von die IIDs, die das Steuerelement verwendet wird.  
  
```  
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```  
  
### <a name="parameters"></a>Parameter  
 *piidPrimary*  
 Ein Zeiger auf die Schnittstellen-ID der primären Dispatch-Schnittstelle des Steuerelements.  
  
 *piidEvents*  
 Ein Zeiger auf die Schnittstellen-ID des Steuerelements Ereignisschnittstelle.  
  
### <a name="remarks"></a>Hinweise  
 Rufen Sie diese Funktion im Konstruktor des Steuerelements, um die Basisklasse für die Schnittstellen-IDs zu informieren, das das Steuerelement verwenden.  
  
##  <a name="internalgetfont"></a>COleControl::InternalGetFont  
 Greift auf die vordefinierte Schriftarteigenschaft des Steuerelements  
  
```  
CFontHolder& InternalGetFont();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Ein Verweis auf eine [CFontHolder](../../mfc/reference/cfontholder-class.md) Objekt, das die stock Font-Objekt enthält.  
  
##  <a name="internalgettext"></a>COleControl::InternalGetText  
 Greift auf die vordefinierten oder Beschriftungstitel-Eigenschaft des Steuerelements.  
  
```  
const CString& InternalGetText();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Ein Verweis auf die Text-Zeichenfolge.  
  
##  <a name="internalsetreadystate"></a>COleControl::InternalSetReadyState  
 Legt den Bereitschaftsstatus des Steuerelements fest.  
  
```  
void InternalSetReadyState(long lNewReadyState);
```  
  
### <a name="parameters"></a>Parameter  
 *lNewReadyState*  
 Dem Bereitschaftsstatus für das Steuerelement, einen der folgenden Werte festgelegt:  
  
 **READYSTATE_UNINITIALIZED**  
 Initialisierung Standardstatus  
  
 **READYSTATE_LOADING**  
 Steuerelement ist seine Eigenschaften derzeit geladen werden.  
  
 **READYSTATE_LOADED**  
 Steuerelement wurde initialisiert.  
  
 **READYSTATE_INTERACTIVE**  
 Das Steuerelement genügend Daten für die interaktive werden jedoch nicht alle asynchrone Daten werden noch geladen.  
  
 `READYSTATE_COMPLETE`  
 Steuerelement verfügt über alle ihre Daten  
  
### <a name="remarks"></a>Hinweise  
 Die meisten einfachen Steuerelemente müssen nie Unterscheidung zwischen **LOADED** und `INTERACTIVE`. Allerdings Steuerelemente, die Daten Pfadeigenschaften unterstützen möglicherweise nicht bereit für die interaktive bis mindestens einige Daten asynchron empfangen werden. Ein Steuerelement sollten versuchen, interaktive so bald wie möglich sind.  
  
##  <a name="invalidatecontrol"></a>COleControl::InvalidateControl  
 Erzwingt, dass das Steuerelement selbst neu zeichnet.  
  
```  
void InvalidateControl(
    LPCRECT lpRect = NULL,  
    BOOL bErase = TRUE);
```  
  
### <a name="parameters"></a>Parameter  
 `lpRect`  
 Ein Zeiger auf den Bereich des Steuerelements für ungültig erklärt werden.  
  
 `bErase`  
 Gibt an, ob der Hintergrund in den Aktualisierungsbereich gelöscht werden, wenn der Aktualisierungsbereich verarbeitet wird.  
  
### <a name="remarks"></a>Hinweise  
 Wenn `lpRect` verfügt über eine **NULL** Wert, wird das gesamte Steuerelement neu gezeichnet werden. Wenn `lpRect` nicht **NULL**, dies weist darauf hin, der Teil des Steuerelements Rechteck, das als ungültig zu erklären. In Fällen, in dem das Steuerelement verfügt über kein Fenster oder ist nicht aktiviert, das Rechteck wird ignoriert und erfolgt ein Aufruf an des Client-Standorts [IAdviseSink::OnViewChange](http://msdn.microsoft.com/library/windows/desktop/ms694337) Memberfunktion. Verwenden Sie diese Funktion anstelle von `CWnd::InvalidateRect` oder `InvalidateRect`.  
  
##  <a name="invalidatergn"></a>COleControl::InvalidateRgn  
 Erklärt die Containerfenster Clientbereich im angegebenen Bereich liegt.  
  
```  
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```  
  
### <a name="parameters"></a>Parameter  
 `pRgn`  
 Ein Zeiger auf eine [CRgn](../../mfc/reference/crgn-class.md) Objekt, das den Anzeigebereich des OLE-Objekts für ungültig zu erklärende in Clientkoordinaten des enthaltenden Fensters identifiziert. Wenn dieser Parameter ist **NULL**, der Block wird das gesamte Objekt.  
  
 `bErase`  
 Gibt an, ob der Hintergrund für ungültig erklärten Bereich gelöscht werden. Wenn **"true"**, Hintergrund wird gelöscht. Wenn **"false"**, Hintergrund bleibt unverändert.  
  
### <a name="remarks"></a>Hinweise  
 Dies kann zum Neuzeichnen Fensterlose Steuerelemente im Container verwendet werden. Der für ungültig erklärten Bereich, zusammen mit allen anderen Bereichen in den Aktualisierungsbereich RuntimeCompatibility zum Zeichnen, wenn die nächste [WM_PAINT](http://msdn.microsoft.com/library/windows/desktop/dd145213) Nachricht gesendet wird.  
  
 Wenn `bErase` ist **"true"** für einen beliebigen Teil der Aktualisierungsbereich, Hintergrund in der gesamten Region, nicht nur in den angegebenen Teil wird gelöscht.  
  
##  <a name="isconvertingvbx"></a>COleControl::IsConvertingVBX  
 Ermöglicht spezielle Laden eines OLE-Steuerelements.  
  
```  
BOOL IsConvertingVBX();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Wert ungleich NULL, wenn das Steuerelement konvertiert wird; andernfalls 0.  
  
### <a name="remarks"></a>Hinweise  
 Beim Konvertieren eines Formulars, das VBX verwendet, auf einen Steuerelemente, die OLE-Steuerelemente verwendet die, möglicherweise spezielle Laden von Code für die OLE-Steuerelemente erforderlich. Z. B. Wenn Sie eine Instanz des OLE-Steuerelements laden, müssen Sie möglicherweise einen Aufruf von [PX_Font](persistence-of-ole-controls.md#px_font) in Ihrem `DoPropExchange`:  
  
 [!code-cpp[NVC_MFCAxCtl Nr. 3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]  
  
 Allerdings VBX Steuerelemente ein Font-Objekt keinen; Jede Schriftarteigenschaft wurde einzeln gespeichert. In diesem Fall würden Sie verwenden `IsConvertingVBX` , zwischen diesen beiden Fällen zu unterscheiden:  
  
 [!code-cpp[NVC_MFCAxCtl #4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]  
  
 Ein weiterer Fall wäre, wenn das Steuerelement VBX proprietäre Binärdaten gespeichert (in seiner **VBM_SAVEPROPERTY** Message-Handler), und die OLE-Steuerelements speichert die Binärdaten in ein anderes Format. Wenn Sie möchten, dass der OLE-Steuerelements sein abwärtskompatibel mit dem Steuerelement VBX konnten Sie sowohl die alten und neuen Formate mithilfe der gelesen der `IsConvertingVBX` Funktion durch unterscheiden, ob das Steuerelement VBX oder der OLE-Steuerelements geladen wurde.  
  
 In des Steuerelements `DoPropExchange` -Funktion können Sie für diese Bedingung überprüfen und bei "true", Load-Code, die speziell für diese Konvertierung (z. B. den vorherigen Beispielen) ausführen. Wenn das Steuerelement nicht konvertiert wird, können Sie die normale Auslastung Code ausführen. Diese Funktion gilt nur für Steuerelemente, die von VBX Entsprechungen konvertiert wird.  
  
##  <a name="isinvokeallowed"></a>COleControl::IsInvokeAllowed  
 Ermöglicht die Automatisierung der Methodenaufruf.  
  
```  
BOOL IsInvokeAllowed(DISPID dispid);
```  
  
### <a name="return-value"></a>Rückgabewert  
 Wert ungleich NULL, wenn das Steuerelement initialisiert wurde; andernfalls 0.  
  
### <a name="remarks"></a>Hinweise  
 Implementierung des Frameworks **IDispatch:: Invoke** Aufrufe **Sie IsInvokeAllowed** bestimmen, ob eine bestimmte Funktion (identifizierte `dispid`) aufgerufen werden kann. Das Standardverhalten für OLE-Steuerelements ist zum Zulassen von Automatisierungsmethoden aufgerufen werden, nur, wenn das Steuerelement initialisiert wurde. allerdings **Sie IsInvokeAllowed** ist eine virtuelle Funktion und kann überschrieben werden, falls erforderlich (beispielsweise, wenn das Steuerelement als Automatisierungsserver verwendet wird). Weitere Informationen finden Sie im Knowledge Base-Artikel Q166472, "So wird's gemacht: verwenden ein OLE-Steuerelements als Automatisierungsserver." Knowledge Base-Artikeln zur Verfügung stehen, in der MSDN Library Visual Studio-Dokumentation oder in [http://support.microsoft.com](http://support.microsoft.com/).  
  
##  <a name="ismodified"></a>COleControl::IsModified  
 Bestimmt, ob der Zustand des Steuerelements geändert wurde.  
  
```  
BOOL IsModified();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Wert ungleich NULL, wenn der Zustand des Steuerelements geändert wurde, seit es zuletzt gespeichert wurde; andernfalls 0.  
  
### <a name="remarks"></a>Hinweise  
 Der Zustand eines Steuerelements wird geändert, wenn der Wert eine Eigenschaft geändert wird.  
  
##  <a name="isoptimizeddraw"></a>COleControl::IsOptimizedDraw  
 Bestimmt, ob der Container für den aktuellen Zeichenvorgang optimierte Zeichnung unterstützt.  
  
```  
BOOL IsOptimizedDraw();
```  
  
### <a name="return-value"></a>Rückgabewert  
 **"True"** Wenn der Container unterstützt, andernfalls für den aktuellen Zeichenvorgang zeichnen optimierte **"false"**.  
  
### <a name="remarks"></a>Hinweise  
 Optimierte Zeichnung unterstützt, muss dann das Steuerelement keine alten Objekte auswählen (Stifte, Pinsel, Schriftarten, usw.) in den Gerätekontext abschließend Zeichnung.  
  
##  <a name="issubclassedcontrol"></a>COleControl::IsSubclassedControl  
 Wird aufgerufen, durch das Framework zu bestimmen, ob Steuerelement Unterklassen, ein Windows steuern.  
  
```  
virtual BOOL IsSubclassedControl();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Wert ungleich NULL, wenn das Steuerelement als Unterklasse ist; andernfalls 0.  
  
### <a name="remarks"></a>Hinweise  
 Sie überschreiben diese Funktion und zurückgeben müssen **"true"** Wenn Ihr OLE Unterklassen ein Windows-Steuerelements steuern.  
  
##  <a name="load"></a>COleControl::Load  
 Setzt alle vorherigen Daten asynchron geladen und initialisiert eine neue Laden des asynchronen Steuerelementeigenschaft.  
  
```  
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```  
  
### <a name="parameters"></a>Parameter  
 *strNewPath*  
 Ein Zeiger auf eine Zeichenfolge, die mit dem Pfad, der den absoluten Speicherort, der die Eigenschaft "asynchrone" verweist.  
  
 *Prop*  
 Ein [CDataPathProperty](../../mfc/reference/cdatapathproperty-class.md) Objekt, das eine asynchrone Steuerelementeigenschaft implementiert.  
  
##  <a name="lockinplaceactive"></a>COleControl::LockInPlaceActive  
 Verhindert, dass den Container deaktivieren das Steuerelement.  
  
```  
BOOL LockInPlaceActive(BOOL bLock);
```  
  
### <a name="parameters"></a>Parameter  
 `bLock`  
 **"True"** ist die direkte aktive Status des Steuerelements zu sperrende; **"False"** wird jedoch nicht gesperrt werden.  
  
### <a name="return-value"></a>Rückgabewert  
 Wert ungleich NULL, wenn die Sperre erfolgreich war; andernfalls 0.  
  
### <a name="remarks"></a>Hinweise  
 Beachten Sie, dass alle Sperren des Steuerelements mit einer Entsperren des Steuerelements abschließend gekoppelt muss. Sie sollten das Steuerelement nur für kurze Zeiträume wie z. B. sperren, während das Auslösen eines Ereignisses.  
  
##  <a name="onambientpropertychange"></a>COleControl::OnAmbientPropertyChange  
 Vom Framework aufgerufen, wenn eine Ambiente-Eigenschaft des Containers Wert geändert wurde.  
  
```  
virtual void OnAmbientPropertyChange(DISPID dispid);
```  
  
### <a name="parameters"></a>Parameter  
 *dispID*  
 Die Dispatch-ID der ambient-Eigenschaft, die geändert, oder **u. DISPID_UNKNOWN lauten** Wenn mehrere Eigenschaften geändert haben.  
  
##  <a name="onappearancechanged"></a>COleControl::OnAppearanceChanged  
 Vom Framework aufgerufen, wenn die vordefinierte Darstellung-Eigenschaftswert geändert hat.  
  
```  
virtual void OnAppearanceChanged ();
```  
  
### <a name="remarks"></a>Hinweise  
 Überschreiben Sie diese Funktion, wenn die Benachrichtigung, nachdem diese Eigenschaft geändert werden soll. Die Standardimplementierung ruft `InvalidateControl`.  
  
##  <a name="onbackcolorchanged"></a>COleControl::OnBackColorChanged  
 Vom Framework aufgerufen, wenn der Wert der Systemeigenschaft BackColor-Eigenschaft geändert wurde.  
  
```  
virtual void OnBackColorChanged();
```  
  
### <a name="remarks"></a>Hinweise  
 Überschreiben Sie diese Funktion, wenn die Benachrichtigung, nachdem diese Eigenschaft geändert werden soll. Die Standardimplementierung ruft `InvalidateControl`.  
  
##  <a name="onborderstylechanged"></a>COleControl::OnBorderStyleChanged  
 Vom Framework aufgerufen, wenn der Wert der Systemeigenschaft BorderStyle-Eigenschaft geändert wurde.  
  
```  
virtual void OnBorderStyleChanged();
```  
  
### <a name="remarks"></a>Hinweise  
 Die Standardimplementierung ruft `InvalidateControl`.  
  
 Überschreiben Sie diese Funktion, wenn die Benachrichtigung, nachdem diese Eigenschaft geändert werden soll.  
  
##  <a name="onclick"></a>COleControl::OnClick  
 Vom Framework aufgerufen, wenn eine Maustaste geklickt wurde, oder die vordefinierte DoClick-Methode wurde aufgerufen.  
  
```  
virtual void OnClick(USHORT iButton);
```  
  
### <a name="parameters"></a>Parameter  
 *iButton*  
 Der Index einer Maustaste. Dabei kann es sich um einen der folgenden Werte aufweisen:  
  
- **LEFT_BUTTON** die linken Maustaste geklickt wurde.  
  
- **MIDDLE_BUTTON** die mittleren Maustaste geklickt wurde.  
  
- **RIGHT_BUTTON** die rechten Maustaste geklickt wurde.  
  
### <a name="remarks"></a>Hinweise  
 Die Standardimplementierung ruft `COleControl::FireClick`.  
  
 Überschreiben Sie diese Memberfunktion zum Ändern oder erweitern die Standardbehandlung.  
  
##  <a name="onclose"></a>COleControl::OnClose  
 Vom Framework aufgerufen, wenn der Container des Steuerelements aufgerufen hat **IOleControl:: Close** Funktion.  
  
```  
virtual void OnClose(DWORD dwSaveOption);
```  
  
### <a name="parameters"></a>Parameter  
 `dwSaveOption`  
 Flag, die angibt, ob das Objekt vor dem Laden gespeichert werden soll. Gültige Werte sind:  
  
- `OLECLOSE_SAVEIFDIRTY`  
  
- `OLECLOSE_NOSAVE`  
  
- `OLECLOSE_PROMPTSAVE`  
  
### <a name="remarks"></a>Hinweise  
 Standardmäßig `OnClose` das Steuerelementobjekt speichert, wenn er geändert wurde und `dwSaveOption` handelt es sich um `OLECLOSE_SAVEIFDIRTY` oder `OLECLOSE_PROMPTSAVE`.  
  
##  <a name="ondoverb"></a>COleControl::OnDoVerb  
 Vom Framework aufgerufen, wenn der Container aufruft, die **IOleObject** Memberfunktion.  
  
```  
virtual BOOL OnDoVerb(
    LONG iVerb,  
    LPMSG lpMsg,  
    HWND hWndParent,  
    LPCRECT lpRect);
```  
  
### <a name="parameters"></a>Parameter  
 `iVerb`  
 Der Index von dem kontrollverb, aufgerufen werden soll.  
  
 `lpMsg`  
 Ein Zeiger auf die Windows-Meldung, die das Verb aufzurufende verursacht hat.  
  
 `hWndParent`  
 Das Handle für das übergeordnete Fenster des Steuerelements. Wenn die Ausführung des Verbs an ein Fenster (oder Windows), erstellt `hWndParent` als das übergeordnete Element verwendet werden soll.  
  
 `lpRect`  
 Ein Zeiger auf einen RECT-Struktur, in der die Koordinaten des Steuerelements relativ zu dem Container kopiert werden.  
  
### <a name="return-value"></a>Rückgabewert  
 Wert ungleich NULL, wenn der Aufruf erfolgreich war; andernfalls 0.  
  
### <a name="remarks"></a>Hinweise  
 Die Standardimplementierung verwendet die `ON_OLEVERB` und `ON_STDOLEVERB` Nachricht Zuordnungseinträge, um zu bestimmen, die ordnungsgemäße Funktion aufrufen.  
  
 Überschreiben Sie diese Funktion, um die Standardbehandlung von Verb zu ändern.  
  
##  <a name="ondraw"></a>COleControl:: OnDraw aufgerufen  
 Wird aufgerufen, durch das Framework der OLE-Steuerelements im angegebenen umschließenden Rechteck mit den angegebenen Gerätekontext gezeichnet werden soll.  
  
```  
virtual void OnDraw(
    CDC* pDC,  
    const CRect& rcBounds,  
    const CRect& rcInvalid);
```  
  
### <a name="parameters"></a>Parameter  
 `pDC`  
 Der Gerätekontext, in dem das Zeichnen auftritt.  
  
 `rcBounds`  
 Der rechteckige Bereich des Steuerelements, einschließlich der Rahmen.  
  
 `rcInvalid`  
 Der rechteckige Bereich des Steuerelements, das ungültig ist.  
  
### <a name="remarks"></a>Hinweise  
 `OnDraw`wird in der Regel aufgerufen, für die Bildschirmanzeige, übergeben einen Bildschirm Gerätekontext als `pDC`. Die `rcBounds` Parameter identifiziert das Rechteck in der Ziel-Gerätekontext (in Bezug auf seine aktuellen Zuordnungsmodus). Die `rcInvalid` Parameter ist das tatsächliche Rechteck, das ungültig ist. In einigen Fällen wird dies einen kleineren Bereich als `rcBounds`.  
  
##  <a name="ondrawmetafile"></a>OnDrawMetafile  
 Wird aufgerufen, durch das Framework der OLE-Steuerelements im angegebenen umschließenden Rechteck mit den angegebenen Metadatei-Gerätekontext gezeichnet werden soll.  
  
```  
virtual void OnDrawMetafile(
    CDC* pDC,  
    const CRect& rcBounds);
```  
  
### <a name="parameters"></a>Parameter  
 `pDC`  
 Der Gerätekontext, in dem das Zeichnen auftritt.  
  
 `rcBounds`  
 Der rechteckige Bereich des Steuerelements, einschließlich der Rahmen.  
  
### <a name="remarks"></a>Hinweise  
 Die Standardimplementierung Ruft die [OnDraw](#ondraw) Funktion.  
  
##  <a name="onedit"></a>COleControl::OnEdit  
 Bewirkt, dass das Steuerelement UI aktiviert werden.  
  
```  
virtual BOOL OnEdit(
    LPMSG lpMsg,  
    HWND hWndParent,  
    LPCRECT lpRect);
```  
  
### <a name="parameters"></a>Parameter  
 `lpMsg`  
 Ein Zeiger auf die Windows-Meldung, die das Verb aufgerufen hat.  
  
 `hWndParent`  
 Ein Handle für das übergeordnete Fenster des Steuerelements.  
  
 `lpRect`  
 Ein Zeiger auf das Rechteck, das vom Steuerelement im Container.  
  
### <a name="return-value"></a>Rückgabewert  
 Wert ungleich NULL, wenn der Aufruf erfolgreich ist; andernfalls 0.  
  
### <a name="remarks"></a>Hinweise  
 Dies hat dieselbe Wirkung wie das Aufrufen des Steuerelements `OLEIVERB_UIACTIVATE` Verb.  
  
 Diese Funktion wird in der Regel verwendet, als die Handlerfunktion für eine `ON_OLEVERB` Zuordnungseintrag Nachricht. Dadurch wird ein Verb "Bearbeiten" für das Steuerelement "Object" im Menü verfügbar. Zum Beispiel:  
  
 [!code-cpp[NVC_MFCAxCtl Nr. 5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]  
  
##  <a name="onenabledchanged"></a>COleControl::OnEnabledChanged  
 Vom Framework aufgerufen, wenn der Bestand aktiviert-Eigenschaftswert geändert wurde.  
  
```  
virtual void OnEnabledChanged();
```  
  
### <a name="remarks"></a>Hinweise  
 Überschreiben Sie diese Funktion, wenn die Benachrichtigung, nachdem diese Eigenschaft geändert werden soll. Die Standardimplementierung ruft [InvalidateControl](#invalidatecontrol).  
  
##  <a name="onenumverbs"></a>COleControl::OnEnumVerbs  
 Vom Framework aufgerufen, wenn der Container aufruft, die **IOleObject:: EnumVerbs** Memberfunktion.  
  
```  
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```  
  
### <a name="parameters"></a>Parameter  
 `ppenumOleVerb`  
 Ein Zeiger auf die **IEnumOLEVERB** -Objekt, das Steuerelement Verben aufzählt.  
  
### <a name="return-value"></a>Rückgabewert  
 Wert ungleich NULL, wenn die Verben verfügbar sind; andernfalls 0.  
  
### <a name="remarks"></a>Hinweise  
 Listet die standardmäßige Implementierung der `ON_OLEVERB` Einträge in der meldungszuordnung.  
  
 Überschreiben Sie diese Funktion, um die Standardmethode der Aufzählen von Verben zu ändern.  
  
##  <a name="oneventadvise"></a>COleControl::OnEventAdvise  
 Vom Framework aufgerufen, wenn ein Ereignishandler mit verbunden oder getrennt von einem OLE-Steuerelement aus.  
  
```  
virtual void OnEventAdvise(BOOL bAdvise);
```  
  
### <a name="parameters"></a>Parameter  
 `bAdvise`  
 **"True"** gibt an, dass ein Ereignishandler für das Steuerelement verbunden wurde. **"False"** gibt an, dass das Steuerelement ein Ereignishandler getrennt wurde.  
  
##  <a name="onfontchanged"></a>COleControl::OnFontChanged  
 Vom Framework aufgerufen, wenn die vordefinierte Schriftart-Eigenschaftswert geändert wurde.  
  
```  
virtual void OnFontChanged();
```  
  
### <a name="remarks"></a>Hinweise  
 Die Standardimplementierung ruft `COleControl::InvalidateControl`. Wenn das Steuerelement ein Steuerelement von Windows Unterklassen ist, sendet die standardmäßige Implementierung auch eine **WM_SETFONT** Nachricht an das Fenster des Steuerelements.  
  
 Überschreiben Sie diese Funktion, wenn die Benachrichtigung, nachdem diese Eigenschaft geändert werden soll.  
  
### <a name="example"></a>Beispiel  
 [!code-cpp[NVC_MFCAxCtl 6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]  
  
##  <a name="onforecolorchanged"></a>COleControl::OnForeColorChanged  
 Vom Framework aufgerufen, wenn der Wert der Systemeigenschaft ForeColor-Eigenschaft geändert wurde.  
  
```  
virtual void OnForeColorChanged();
```  
  
### <a name="remarks"></a>Hinweise  
 Die Standardimplementierung ruft `InvalidateControl`.  
  
 Überschreiben Sie diese Funktion, wenn die Benachrichtigung, nachdem diese Eigenschaft geändert werden soll.  
  
##  <a name="onfreezeevents"></a>COleControl::OnFreezeEvents  
 Vom Framework aufgerufen wird, nach dem Aufrufen der Container **IOleControl:: FreezeEvents**.  
  
```  
virtual void OnFreezeEvents(BOOL bFreeze);
```  
  
### <a name="parameters"></a>Parameter  
 `bFreeze`  
 **"True"** Wenn des Steuerelements Ereignisbehandlung ist fixiert ist andernfalls **"false"**.  
  
### <a name="remarks"></a>Hinweise  
 Bei der Standardimplementierung wird keine Aktion ausgeführt.  
  
 Überschreiben Sie diese Funktion, wenn Sie zusätzliches Verhalten soll, wenn Ereignisbehandlung aufgetaut oder fixiert ist.  
  
##  <a name="ongetcolorset"></a>COleControl::OnGetColorSet  
 Vom Framework aufgerufen, wenn der Container aufruft, die **IViewObject::GetColorSet** Memberfunktion.  
  
```  
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,  
    HDC hicTargetDev,  
    LPLOGPALETTE* ppColorSet);
```  
  
### <a name="parameters"></a>Parameter  
 `ptd`  
 Verweist auf das Zielgerät für das Bild gerendert werden soll. Wenn dieser Wert ist **NULL**, das Bild für ein Zielgerät Standardwert wird in der Regel ein Anzeigegerät gerendert werden soll.  
  
 `hicTargetDev`  
 Gibt den Informationskontext auf dem Zielgerät erkennbar `ptd`. Dieser Parameter kann einen Gerätekontext, jedoch ist nicht unbedingt. If `ptd` is **NULL**, `hicTargetDev` should also be **NULL**.  
  
 *ppColorSet*  
 Ein Zeiger auf den Speicherort, in dem der Satz von Farben, die verwendet werden würde kopiert werden soll. Wenn die Funktion nicht die Farbpalette zurückgibt **NULL** zurückgegeben wird.  
  
### <a name="return-value"></a>Rückgabewert  
 Wert ungleich NULL, wenn Sie eine gültige Farbe zurückgegeben wird; andernfalls 0.  
  
### <a name="remarks"></a>Hinweise  
 Der Container Aufrufe dieser Funktion können Sie die Farben, die zum Zeichnen des OLE-Steuerelements erforderlich sind. Container können Farbpaletten, die abgerufen, die in Verbindung mit den Hintergrundfarben, die er die allgemeine Farben-Palette festgelegt muss, wurde. Gibt die standardmäßige Implementierung **"false"**.  
  
 Überschreiben Sie diese Funktion dazu jegliche spezielle Verarbeitung dieser Anforderung.  
  
##  <a name="ongetcontrolinfo"></a>COleControl::OnGetControlInfo  
 Vom Framework aufgerufen, wenn der Container des Steuerelements Informationen über das Steuerelement angefordert hat.  
  
```  
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```  
  
### <a name="parameters"></a>Parameter  
 `pControlInfo`  
 Zeiger auf eine [CONTROLINFO](http://msdn.microsoft.com/library/windows/desktop/ms680734) Struktur ausgefüllt werden.  
  
### <a name="remarks"></a>Hinweise  
 Diese Informationen wird in erster Linie eine Beschreibung des Steuerelements mnemonischen Tasten besteht. Die standardmäßige Implementierung füllt `pControlInfo` mit Standardinformationen.  
  
 Überschreiben Sie diese Funktion, wenn das Steuerelement mnemonische Tasten verarbeiten muss.  
  
##  <a name="ongetdisplaystring"></a>COleControl::OnGetDisplayString  
 Wird aufgerufen, durch das Framework um eine Zeichenfolge abzurufen, die den aktuellen Wert der Eigenschaft identifizierten darstellt `dispid`.  
  
```  
virtual BOOL OnGetDisplayString(
    DISPID dispid,  
    CString& strValue);
```  
  
### <a name="parameters"></a>Parameter  
 `dispid`  
 Die Verteiler-ID einer Eigenschaft des Steuerelements.  
  
 `strValue`  
 Ein Verweis auf eine [CString](../../atl-mfc-shared/reference/cstringt-class.md) -Objekt über die eine Zeichenfolge zurückgegeben wird.  
  
### <a name="return-value"></a>Rückgabewert  
 Ungleich NULL, wenn eine Zeichenfolge zurückgegeben wurden *StrValue;* andernfalls 0.  
  
### <a name="remarks"></a>Hinweise  
 Überschreiben Sie diese Funktion, wenn das Steuerelement verfügt über eine Eigenschaft, deren Wert direkt in eine Zeichenfolge konvertiert werden kann, und den Wert der Eigenschaft, die in einem Container bereitgestellte Eigenschaftenbrowser angezeigt werden soll.  
  
##  <a name="ongetinplacemenu"></a>COleControl::OnGetInPlaceMenu  
 Vom Framework aufgerufen, wenn das Steuerelement Benutzeroberfläche aktiviert, erhalten Sie im Menü des Containers vorhandenen Menüs zusammengeführt werden sollen.  
  
```  
virtual HMENU OnGetInPlaceMenu();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Das Handle des Steuerelements Menü oder **NULL** Wenn das Steuerelement keine verfügt. Gibt die standardmäßige Implementierung **NULL**.  
  
### <a name="remarks"></a>Hinweise  
 Weitere Informationen für das Zusammenführen von OLE-Ressourcen finden Sie im Artikel [Menüs und Ressourcen (OLE)](../../mfc/menus-and-resources-ole.md).  
  
##  <a name="ongetnaturalextent"></a>COleControl::OnGetNaturalExtent  
 Vom Framework als Antwort auf eines Containers aufgerufen **IViewObjectEx::GetNaturalExtent** Anforderung.  
  
```  
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```  
  
### <a name="parameters"></a>Parameter  
 `dwAspect`  
 Gibt an, wie das Objekt dargestellt werden soll. Darstellungen enthalten Inhalt, ein Symbol, eine Miniaturansicht oder einem gedruckten Dokument. Gültige Werte stammen aus der Enumeration [DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318) oder **DVASPECT2**.  
  
 *lindex*  
 Der Teil des Objekts, das von Interesse sind. Derzeit wird nur-1 ist ungültig.  
  
 `ptd`  
 Verweist auf die [DVTARGETDEVICE](http://msdn.microsoft.com/library/windows/desktop/ms686613) Struktur definieren das Zielgerät für das die Größe des Objekts zurückgegeben werden soll.  
  
 `hicTargetDev`  
 Gibt an, der Informationskontext für das Zielgerät, angegeben durch die `ptd` Parameter, von dem das Objekt Gerätemetrik abrufen kann, und testen die Funktionen des Geräts. Wenn `ptd` ist **NULL**, das Objekt sollte den Wert im ignorieren der `hicTargetDev` Parameter.  
  
 *pExtentInfo*  
 Verweist auf die **DVEXTENTINFO** -Struktur, Sizing Daten angibt. Die **DVEXTENTINFO** Struktur ist:  
  
 `typedef struct  tagExtentInfo`  
  
 `{`  
  
 `UINT cb;`  
  
 `DWORD dwExtentMode;`  
  
 `SIZEL sizelProposed;`  
  
 `}   DVEXTENTINFO;`  
  
 Die Strukturmember `dwExtentMode` kann einen von zwei Werten annehmen:  
  
- **DVEXTENT_CONTENT** Abfragen, wie groß das Steuerelement werden soll, Inhalt (Snap Größe) genau an  
  
- **DVEXTENT_INTEGRAL** beim Ändern der Größe, vorgeschlagene Größe übergeben, um zu steuern  
  
 `psizel`  
 Verweist auf die Größe der Daten, die vom Steuerelement zurückgegeben. Die Größenänderungsdaten der zurückgegebenen werden auf-1 für eine Dimension festgelegt, die nicht angepasst wurde.  
  
### <a name="return-value"></a>Rückgabewert  
 Wert ungleich NULL, wenn er erfolgreich zurückgibt oder die Größe passt; andernfalls 0.  
  
### <a name="remarks"></a>Hinweise  
 Überschreiben Sie diese Funktion, um die Größe des Objekts zurückzugeben, die die vorgeschlagene Größe und Umfang Modus in am ähnlichsten der **DVEXTENTINFO** Struktur. Gibt die standardmäßige Implementierung **"false"** und macht keine anpassen, um die Größe.  
  
##  <a name="ongetpredefinedstrings"></a>COleControl::OnGetPredefinedStrings  
 Vom Framework aufgerufen wird, erhalten einen Satz von vordefinierten Zeichenfolgen, die die möglichen Werte für eine Eigenschaft darstellt.  
  
```  
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,  
    CStringArray* pStringArray,  
    CDWordArray* pCookieArray);
```  
  
### <a name="parameters"></a>Parameter  
 `dispid`  
 Die Verteiler-ID einer Eigenschaft des Steuerelements.  
  
 `pStringArray`  
 Ein Zeichenfolgenarray mit ausgefüllt werden Werte zurückgegeben.  
  
 `pCookieArray`  
 Ein `DWORD` Array mit Rückgabewerte gefüllt werden soll.  
  
### <a name="return-value"></a>Rückgabewert  
 Ungleich NULL, wenn Elemente hinzugefügt wurden `pStringArray` und `pCookieArray`.  
  
### <a name="remarks"></a>Hinweise  
 Überschreiben Sie diese Funktion, wenn das Steuerelement über eine Eigenschaft mit einem Satz möglicher Werte verfügt, die durch Zeichenfolgen dargestellt werden können. Für jedes Element hinzugefügt `pStringArray`, sollten Sie ein entsprechendes "Cookie"-Element, um hinzufügen *pCookieArray.* Diese Werte "Cookie" möglicherweise später übergeben werden, durch das Framework der `COleControl::OnGetPredefinedValue` Funktion.  
  
##  <a name="ongetpredefinedvalue"></a>COleControl::OnGetPredefinedValue  
 Wird aufgerufen, durch das Framework zum Abrufen des Werts für eine der vordefinierten Zeichenfolgen, die zuvor von einer Überschreibung von zurückgegeben `COleControl::OnGetPredefinedStrings`.  
  
```  
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,  
    DWORD dwCookie,  
    VARIANT* lpvarOut);
```  
  
### <a name="parameters"></a>Parameter  
 `dispid`  
 Die Verteiler-ID einer Eigenschaft des Steuerelements.  
  
 `dwCookie`  
 Ein zuvor eine Überschreibung der zurückgegebene Cookiewert `COleControl::OnGetPredefinedStrings`.  
  
 `lpvarOut`  
 Zeiger auf eine **VARIANT** Struktur über dem ein Eigenschaftswert zurückgegeben wird.  
  
### <a name="return-value"></a>Rückgabewert  
 Ungleich NULL, wenn ein Wert zurückgegeben wurden `lpvarOut`, andernfalls 0.  
  
##  <a name="ongetviewextent"></a>COleControl::OnGetViewExtent  
 Vom Framework als Antwort auf eines Containers aufgerufen [IViewObject2::GetExtent](http://msdn.microsoft.com/library/windows/desktop/ms684032) Anforderung.  
  
```  
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```  
  
### <a name="parameters"></a>Parameter  
 *dwDrawAspect*  
 `DWORD`Beschreiben, welches Formular bzw. Aspekt, ist ein Objekt angezeigt werden. Gültige Werte stammen aus der Enumeration [DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318) oder **DVASPECT2**.  
  
 *lindex*  
 Der Teil des Objekts, das von Interesse sind. Derzeit wird nur-1 ist ungültig.  
  
 `ptd`  
 Verweist auf die [DVTARGETDEVICE](http://msdn.microsoft.com/library/windows/desktop/ms686613) Struktur definieren das Zielgerät für das die Größe des Objekts zurückgegeben werden soll.  
  
 *lpsizel*  
 Verweist auf den Speicherort, in dem die Größe des Objekts zurückgegeben wird.  
  
### <a name="return-value"></a>Rückgabewert  
 Wert ungleich NULL, wenn Umfang Informationen, erfolgreich zurückgegeben werden; andernfalls 0.  
  
### <a name="remarks"></a>Hinweise  
 Überschreiben Sie diese Funktion, wenn das Steuerelement zwei Durchläufen Zeichnung verwendet und seine Bestandteile nicht transparent und transparent unterschiedliche Dimensionen weisen.  
  
##  <a name="ongetviewrect"></a>COleControl::OnGetViewRect  
 Vom Framework als Antwort auf eines Containers aufgerufen **IViewObjectEx::GetRect** Anforderung.  
  
```  
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```  
  
### <a name="parameters"></a>Parameter  
 `dwAspect`  
 `DWORD`Beschreiben, welches Formular bzw. Aspekt, ist ein Objekt angezeigt werden. Gültige Werte stammen aus der Enumeration [DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318) oder **DVASPECT2**:  
  
- `DVASPECT_CONTENT`Umschließende Rechteck des gesamten Objekts. Linken oberen Ecke auf des Objekts Ursprung und Größe Recht zulässigen Umfang zurückgegebenes gleich **GetViewExtent***.*  
  
- **DVASPECT_OPAQUE** Objekte mit einem nicht transparenten rechteckigen Bereich zurück, das Rechteck. Teilweise einen Fehler erzeugen.  
  
- **DVASPECT_TRANSPARENT** Rechteck alle transparenten oder unregelmäßige Teile abdecken.  
  
 `pRect`  
 Verweist auf die [RECTL](http://msdn.microsoft.com/library/windows/desktop/dd162907) -Struktur und gibt das Rechteck, in dem das Objekt gezeichnet werden soll. Dieser Parameter legt die Positionierung und Dehnen des Objekts.  
  
### <a name="return-value"></a>Rückgabewert  
 Wert ungleich NULL, wenn das Rechteck Größe auf das Objekt erfolgreich zurückgegeben wird; andernfalls 0.  
  
### <a name="remarks"></a>Hinweise  
 Die Größe des Objekts wird konvertiert, indem `OnGetViewRect` in ein Rechteck, beginnend an einer bestimmten Position (die Standardeinstellung ist der oberen linken Ecke der Anzeige). Überschreiben Sie diese Funktion, wenn das Steuerelement zwei Durchläufen Zeichnung verwendet und seine Bestandteile nicht transparent und transparent unterschiedliche Dimensionen weisen.  
  
##  <a name="ongetviewstatus"></a>COleControl::OnGetViewStatus  
 Vom Framework als Antwort auf eines Containers aufgerufen **IViewObjectEx::GetViewStatus** Anforderung.  
  
```  
virtual DWORD OnGetViewStatus();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Einer der Werte von der **VIEWSTATUS** Enumeration, wenn erfolgreich, andernfalls 0. Mögliche Werte sind eine beliebige Kombination der folgenden:  
  
 **VIEWSTATUS_OPAQUE**  
 Objekt ist nicht vollständig transparent. Wenn dieses Bit nicht festgelegt ist, enthält das Objekt transparenten Teile. Dieses Bit gilt nur für die Content-bezogenen Aspekte und nicht für `DVASPECT_ICON` oder `DVASPECT_DOCPRINT`.  
  
 **VIEWSTATUS_SOLIDBKGND**  
 Objekt verfügt über fundierten (besteht eine Volltonfarbe keinem Pinselmuster). Dieses Bit ist sinnvoll nur, wenn **VIEWSTATUS_OPAQUE** festgelegt und gilt nur für die Content-bezogenen Aspekte und nicht für `DVASPECT_ICON` oder `DVASPECT_DOCPRINT`.  
  
 **VIEWSTATUS_DVASPECTOPAQUE**  
 -Objekt unterstützt **DVASPECT_OPAQUE**. Alle **IViewObjectEx** Methoden, die einen Zeichnung Aspekt akzeptieren, wie ein Parameter mit diesem Aspekt aufgerufen werden kann.  
  
 **VIEWSTATUS_DVASPECTTRANSPARENT**  
 -Objekt unterstützt **DVASPECT_TRANSPARENT**. Alle **IViewObjectEx** Methoden, die einen Zeichnung Aspekt akzeptieren, wie ein Parameter mit diesem Aspekt aufgerufen werden kann.  
  
### <a name="remarks"></a>Hinweise  
 Überschreiben Sie diese Funktion, wenn das Steuerelement mit zwei Durchläufen Zeichnung verwendet. Gibt die standardmäßige Implementierung **VIEWSTATUS_OPAQUE**.  
  
##  <a name="onhidetoolbars"></a>COleControl::OnHideToolBars  
 Wird vom Framework aufgerufen, wenn das Steuerelement der Benutzeroberfläche deaktiviert wird.  
  
```  
virtual void OnHideToolBars();
```  
  
### <a name="remarks"></a>Hinweise  
 Verbergen der Implementierung alle Symbolleisten angezeigt werden, indem `OnShowToolbars`.  
  
##  <a name="oninactivemousemove"></a>COleControl::OnInactiveMouseMove  
 Wird aufgerufen, durch den Container für die inaktiven Objekt unter dem Mauszeiger auf den Empfang von einem `WM_MOUSEMOVE` Nachricht.  
  
```  
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```  
  
### <a name="parameters"></a>Parameter  
 `lprcBounds`  
 Das Objekt, das umgebende Rechteck, in Clientkoordinaten des enthaltenden Fensters. Weist das Objekt seine genaue Position und Größe auf dem Bildschirm beim der `WM_MOUSEMOVE` Nachricht wurde empfangen.  
  
 *x*  
 Die X-Koordinate der die Position des Mauszeigers in Clientkoordinaten des enthaltenden Fensters.  
  
 *y*  
 Die y-Koordinate der die Position des Mauszeigers in Clientkoordinaten des enthaltenden Fensters.  
  
 `dwKeyState`  
 Identifiziert den aktuellen Status der Tastatur Zusatztasten der Tastatur. Gültige Werte kann eine Kombination der Flags **MK_CONTROL**, **MK_SHIFT**, **MK_ALT**, **MK_BUTTON**, **MK_LBUTTON**, **MK_MBUTTON**, und **MK_RBUTTON**.  
  
### <a name="remarks"></a>Hinweise  
 Beachten Sie, dass der Clientkoordinaten des Fensters (in Pixel) verwendet werden, um die Position des Mauszeigers zu übergeben. Dadurch wird ermöglicht auch das umschließende Rechteck des Objekts in der gleichen Koordinatensystem übergeben.  
  
##  <a name="oninactivesetcursor"></a>COleControl::OnInactiveSetCursor  
 Wird aufgerufen, durch den Container für die inaktiven Objekt unter dem Mauszeiger auf den Empfang von einem `WM_SETCURSOR` Nachricht.  
  
```  
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```  
  
### <a name="parameters"></a>Parameter  
 `lprcBounds`  
 Das Objekt, das umgebende Rechteck, in Clientkoordinaten des enthaltenden Fensters. Weist das Objekt seine genaue Position und Größe auf dem Bildschirm beim der `WM_SETCURSOR` Nachricht wurde empfangen.  
  
 *x*  
 Die X-Koordinate der die Position des Mauszeigers in Clientkoordinaten des enthaltenden Fensters.  
  
 *y*  
 Die y-Koordinate der die Position des Mauszeigers in Clientkoordinaten des enthaltenden Fensters.  
  
 *dwMouseMsg*  
 Der Bezeichner der Nachricht für die Maus eine `WM_SETCURSOR` aufgetreten ist.  
  
 *bSetAlways*  
 Gibt an, und zwar unabhängig davon, ob das Objekt des Cursors festgelegt werden muss. Wenn **"true"**, das Objekt muss den Cursor; festgelegt, wenn **"false"**, der Cursor ist nicht verpflichtet, den Cursor zu setzen und sollte zurückgeben **"S_FALSE"** in diesem Fall.  
  
### <a name="return-value"></a>Rückgabewert  
 Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).  
  
### <a name="remarks"></a>Hinweise  
 Beachten Sie, dass der Clientkoordinaten des Fensters (in Pixel) verwendet werden, um die Position des Mauszeigers zu übergeben. Dadurch wird ermöglicht auch das umschließende Rechteck des Objekts in der gleichen Koordinatensystem übergeben.  
  
##  <a name="onkeydownevent"></a>COleControl::OnKeyDownEvent  
 Vom Framework aufgerufen, nachdem ein vordefiniertes KeyDown-Ereignis verarbeitet wurde.  
  
```  
virtual void OnKeyDownEvent(
    USHORT nChar,  
    USHORT nShiftState);
```  
  
### <a name="parameters"></a>Parameter  
 `nChar`  
 Der virtueller Tastencode-Wert, der die gedrückte Taste. Eine Liste der standardmäßigen virtuellen Tastencodes finden Sie unter Winuser.h  
  
 `nShiftState`  
 Enthält eine Kombination der folgenden Flags:  
  
- **SHIFT_MASK** die UMSCHALTTASTE gedrückt wurde, während der Aktion.  
  
- **CTRL_MASK** die STRG-Taste gedrückt wurde, während der Aktion.  
  
- **ALT_MASK** die ALT-Taste gedrückt wurde, während der Aktion.  
  
### <a name="remarks"></a>Hinweise  
 Überschreiben Sie diese Funktion, wenn das Steuerelement benötigt Zugriff auf wichtige Informationen, nachdem das Ereignis ausgelöst wurde.  
  
##  <a name="onkeypressevent"></a>COleControl::OnKeyPressEvent  
 Vom Framework aufgerufen, nachdem die Stock, KeyPress-Ereignis ausgelöst wurde.  
  
```  
virtual void OnKeyPressEvent(USHORT nChar);
```  
  
### <a name="parameters"></a>Parameter  
 `nChar`  
 Enthält den virtueller Tastencode-Wert, der die gedrückte Taste. Eine Liste der standardmäßigen virtuellen Tastencodes finden Sie unter Winuser.h  
  
### <a name="remarks"></a>Hinweise  
 Beachten Sie, dass die `nChar` Wert möglicherweise vom Container geändert wurde.  
  
 Überschreiben Sie diese Funktion, wenn Sie Benachrichtigungen möchten, nachdem dieses Ereignis tritt auf.  
  
##  <a name="onkeyupevent"></a>COleControl::OnKeyUpEvent  
 Vom Framework aufgerufen, nachdem ein vordefiniertes KeyDown-Ereignis verarbeitet wurde.  
  
```  
virtual void OnKeyUpEvent(
    USHORT nChar,  
    USHORT nShiftState);
```  
  
### <a name="parameters"></a>Parameter  
 `nChar`  
 Der virtueller Tastencode-Wert, der die gedrückte Taste. Eine Liste der standardmäßigen virtuellen Tastencodes finden Sie unter Winuser.h  
  
 `nShiftState`  
 Enthält eine Kombination der folgenden Flags:  
  
- **SHIFT_MASK** die UMSCHALTTASTE gedrückt wurde, während der Aktion.  
  
- **CTRL_MASK** die STRG-Taste gedrückt wurde, während der Aktion.  
  
- **ALT_MASK** die ALT-Taste gedrückt wurde, während der Aktion.  
  
### <a name="remarks"></a>Hinweise  
 Überschreiben Sie diese Funktion, wenn das Steuerelement benötigt Zugriff auf wichtige Informationen, nachdem das Ereignis ausgelöst wurde.  
  
##  <a name="onmappropertytopage"></a>COleControl::OnMapPropertyToPage  
 Wird aufgerufen, durch das Framework die Klassen-ID einer Eigenschaftenseite abrufen, die der angegebenen Eigenschaft bearbeiten implementiert.  
  
```  
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,  
    LPCLSID lpclsid,  
    BOOL* pbPageOptional);
```  
  
### <a name="parameters"></a>Parameter  
 `dispid`  
 Die Verteiler-ID einer Eigenschaft des Steuerelements.  
  
 `lpclsid`  
 Zeiger auf eine **CLSID** Struktur über die Klassen-ID zurückgegeben wird.  
  
 *pbPageOptional*  
 Gibt einen Indikator gibt an, ob für die Verwendung der angegebenen Eigenschaftenseite optional ist.  
  
### <a name="return-value"></a>Rückgabewert  
 Ungleich NULL, wenn eine Klassenid zurückgegeben wurden `lpclsid`, andernfalls 0.  
  
### <a name="remarks"></a>Hinweise  
 Überschreiben Sie diese Funktion um eine Möglichkeit zum Aufrufen von Eigenschaftenseiten von Eigenschaftenbrowser des Containers des Steuerelements bereitzustellen.  
  
##  <a name="onmnemonic"></a>COleControl::OnMnemonic  
 Vom Framework aufgerufen, wenn der Container erkannt wird, dass eine mnemonische Taste des OLE-Steuerelements gedrückt wurde.  
  
```  
virtual void OnMnemonic(LPMSG pMsg);
```  
  
### <a name="parameters"></a>Parameter  
 `pMsg`  
 Ein Zeiger auf die durch Drücken einer mnemonischen Taste generierte Windows-Meldung.  
  
##  <a name="onproperties"></a>COleControl::OnProperties  
 Vom Framework aufgerufen, wenn das Steuerelement Eigenschaftenverb vom Container aufgerufen wurde.  
  
```  
virtual BOOL OnProperties(
    LPMSG lpMsg,  
    HWND hWndParent,  
    LPCRECT lpRect);
```  
  
### <a name="parameters"></a>Parameter  
 `lpMsg`  
 Ein Zeiger auf die Windows-Meldung, die das Verb aufgerufen hat.  
  
 `hWndParent`  
 Ein Handle für das übergeordnete Fenster des Steuerelements.  
  
 `lpRect`  
 Ein Zeiger auf das Rechteck, das vom Steuerelement im Container.  
  
### <a name="return-value"></a>Rückgabewert  
 Wert ungleich NULL, wenn der Aufruf erfolgreich ist; andernfalls 0.  
  
### <a name="remarks"></a>Hinweise  
 Die standardmäßige Implementierung zeigt ein modales Dialogfeld an.  
  
 Diese Funktion können auch dazu führen, dass die Anzeige der Eigenschaftenseiten des Steuerelements. Rufen Sie die `OnProperties` -Funktion, übergeben das Handle des Steuerelements Elternteil der `hWndParent` Parameter. In diesem Fall werden die Werte der `lpMsg` und `lpRect` Parameter werden ignoriert.  
  
##  <a name="onqueryhitpoint"></a>COleControl::OnQueryHitPoint  
 Vom Framework als Antwort auf eines Containers aufgerufen **IViewObjectEx::QueryHitPoint** Anforderung.  
  
```  
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```  
  
### <a name="parameters"></a>Parameter  
 `dwAspect`  
 Gibt an, wie das Objekt dargestellt wird. Gültige Werte stammen aus der Enumeration [DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318) oder **DVASPECT2**.  
  
 `pRectBounds`  
 Zeiger auf eine `RECT` Struktur, die das umschließende Rechteck des Clientbereichs OLE-Steuerelement angibt.  
  
 `ptlLoc`  
 Zeiger auf die **zeigen** Struktur, die einen Treffer zu überprüfenden Punktes angibt. Der Punkt wird im OLE-Clientkoordinaten Bereich angegeben.  
  
 `lCloseHint`  
 Der Abstand, der definiert, "Schließen" auf den Punkt als Treffer überprüft.  
  
 `pHitResult`  
 Ein Zeiger auf das Ergebnis der Abfrage klicken. Einer der folgenden Werte:  
  
- **HITRESULT_OUTSIDE** `ptlLoc` außerhalb der OLE-Objekt und nicht geschlossen ist.  
  
- **HITRESULT_TRANSPARENT** *PtlLoc* innerhalb der Grenzen des OLE-Objekts, aber nicht in der Nähe der Image ist. Z. B. ein Punkt in der Mitte eines transparenten Kreises möglicherweise **HITRESULT_TRANSPARENT**.  
  
- **HITRESULT_CLOSE** `ptlLoc` befindet sich innerhalb oder außerhalb der OLE-Objekts, aber schließen Sie genug, um das Objekt, das in berücksichtigt werden. Klein, schlanke oder ausführliche Objekte möglicherweise diesen Wert verwenden. Auch wenn ein Punkt, aus dem umgebenden befindet Rechteck für ein Objekt, das es möglicherweise immer noch schließen werden (Dies ist für kleine Objekte Erreichens erforderlich).  
  
- **HITRESULT_HIT** `ptlLoc` innerhalb des Bilds des Objekts ist.  
  
### <a name="return-value"></a>Rückgabewert  
 Der Wert ist ungleich NULL einen Treffertest Ergebnis erfolgreich zurückgegeben; andernfalls 0. Treffer ist eine Überlappung mit den Anzeigebereich des OLE-Steuerelements.  
  
### <a name="remarks"></a>Hinweise  
 Fragt ab, ob Anzeigerechteck für ein Objekt den angegebenen Punkt überschneidet (den Punkt erreicht). `QueryHitPoint`kann überschrieben werden, um Treffer für viereckig Objekte zu testen.  
  
##  <a name="onqueryhitrect"></a>COleControl::OnQueryHitRect  
 Vom Framework als Antwort auf eines Containers aufgerufen **IViewObjectEx::QueryHitRect** Anforderung.  
  
```  
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,  
    LPCRECT pRectBounds,  
    LPCRECT prcLoc,  
    LONG lCloseHint,  
    DWORD* pHitResult);
```  
  
### <a name="parameters"></a>Parameter  
 `dwAspect`  
 Gibt an, wie das Objekt dargestellt werden soll. Gültige Werte stammen aus der Enumeration [DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318) oder **DVASPECT2**.  
  
 `pRectBounds`  
 Zeiger auf eine `RECT` Struktur, die das umschließende Rechteck des Clientbereichs OLE-Steuerelement angibt.  
  
 *prcLoc*  
 Zeiger auf die `RECT` Struktur, die das Rechteck für ein erreicht (Überschneidung mit dem Objekt Rechteck), relativ zur oberen linken Ecke des Objekts überprüft werden angibt.  
  
 `lCloseHint`  
 Nicht verwendet.  
  
 `pHitResult`  
 Ein Zeiger auf das Ergebnis der Abfrage klicken. Einer der folgenden Werte:  
  
- **HITRESULT_OUTSIDE** kein Punkt in dem Rechteck von OLE-Objekts erreicht wird.  
  
- **HITRESULT_HIT** mindestens ein Punkt in dem Rechteck wäre als Treffer für das Objekt.  
  
### <a name="return-value"></a>Rückgabewert  
 Der Wert ist ungleich NULL einen Treffertest Ergebnis erfolgreich zurückgegeben; andernfalls 0.  
  
### <a name="remarks"></a>Hinweise  
 Fragt ab, ob ein Objekt Anzeigerechteck überschneidet sich mit einem beliebigen Punkt in einem angegebenen Rechteck (trifft das Rechteck). `QueryHitRect`kann überschrieben werden, um Treffer für viereckig Objekte zu testen.  
  
##  <a name="onrenderdata"></a>COleControl::OnRenderData  
 Wird aufgerufen, durch das Framework zum Abrufen von Daten im angegebenen Format.  
  
```  
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,  
    LPSTGMEDIUM lpStgMedium);
```  
  
### <a name="parameters"></a>Parameter  
 `lpFormatEtc`  
 Verweist auf die [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) Struktur, die das Format, in dem Informationen angefordert, angibt.  
  
 `lpStgMedium`  
 Verweist auf eine [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812) Struktur, in dem die Daten zurückgegeben werden.  
  
### <a name="return-value"></a>Rückgabewert  
 Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).  
  
### <a name="remarks"></a>Hinweise  
 Das angegebene Format ist eines der zuvor in das Steuerelement mit platziert die [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) oder [DelayRenderFileData](../../mfc/reference/coledatasource-class.md#delayrenderfiledata) Memberfunktionen für verzögertes rendering. Ruft die standardmäßige Implementierung dieser Funktion `OnRenderFileData` oder `OnRenderGlobalData`bzw. das angegebene Speichermedium ist eine Datei oder einen Speicher. Wenn das angeforderte Format ist `CF_METAFILEPICT` oder die dauerhafte Eigenschaftensatz-Format ist, wird die standardmäßige Implementierung rendert die entsprechenden Daten und ungleich NULL zurückgegeben. Andernfalls wird 0 zurückgegeben, und wird keine Aktion ausgeführt wird.  
  
 Wenn *LpStgMedium-> Tymed* ist **TYMED_NULL**, **STGMEDIUM** reserviert und entsprechend den Angaben von gefüllt werden soll *LpFormatEtc-> Tymed*. Wenn dies nicht der **TYMED_NULL**, **STGMEDIUM** direkt mit den Daten ausgefüllt werden soll.  
  
 Überschreiben Sie diese Funktion, um Ihre Daten in das angeforderte Format und das Medium angeben. Abhängig von Ihrer Daten können Sie eine der anderen Versionen dieser Funktion stattdessen überschreiben möchten. Wenn Ihre Daten klein und fester Größe ist, überschreiben `OnRenderGlobalData`. Wenn Ihre Daten in einer Datei ist oder variabler Größe ist, überschreiben `OnRenderFileData`.  
  
 Weitere Informationen finden Sie unter der **FORMATETC** und **STGMEDIUM** Strukturen in den [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  
  
##  <a name="onrenderfiledata"></a>COleControl::OnRenderFileData  
 Wird aufgerufen, durch das Framework zum Abrufen von Daten im angegebenen Format, wenn das Speichermedium eine Datei ist.  
  
```  
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,  
    CFile* pFile);
```  
  
### <a name="parameters"></a>Parameter  
 `lpFormatEtc`  
 Verweist auf die [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) Struktur, die das Format, in dem Informationen angefordert, angibt.  
  
 `pFile`  
 Verweist auf eine [CFile](../../mfc/reference/cfile-class.md) Objekt, in dem die Daten gerendert werden.  
  
### <a name="return-value"></a>Rückgabewert  
 Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).  
  
### <a name="remarks"></a>Hinweise  
 Das angegebene Format ist eines der zuvor in das Steuerelement mit platziert die [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) Memberfunktion für das verzögerte Rendering. Die standardmäßige Implementierung dieser Funktion gibt einfach auftragsantwortnachrichten zurück **"false"**.  
  
 Überschreiben Sie diese Funktion, um Ihre Daten in das angeforderte Format und das Medium angeben. Je nach Ihrer Daten empfiehlt es sich um eine der anderen Versionen dieser Funktion stattdessen zu überschreiben. Wenn Sie mehrere Speichermedien behandeln möchten, überschreiben `OnRenderData`. Wenn Ihre Daten in einer Datei ist oder variabler Größe ist, überschreiben `OnRenderFileData`.  
  
 Weitere Informationen finden Sie unter der **FORMATETC** Struktur der [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  
  
##  <a name="onrenderglobaldata"></a>COleControl::OnRenderGlobalData  
 Wird aufgerufen, durch das Framework zum Abrufen von Daten im angegebenen Format, wenn das angegebene Speichermedium globaler Speicher ist.  
  
```  
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,  
    HGLOBAL* phGlobal);
```  
  
### <a name="parameters"></a>Parameter  
 `lpFormatEtc`  
 Verweist auf die [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) Struktur, die das Format, in dem Informationen angefordert, angibt.  
  
 `phGlobal`  
 Verweist auf ein Handle für den globalen Arbeitsspeicher, in dem die Daten zurückgegeben werden. Dieser Parameter kann sein, wenn kein Arbeitsspeicher belegt wurde, **NULL**.  
  
### <a name="return-value"></a>Rückgabewert  
 Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).  
  
### <a name="remarks"></a>Hinweise  
 Das angegebene Format ist eines der zuvor in das Steuerelement mit platziert die [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) Memberfunktion für das verzögerte Rendering. Die standardmäßige Implementierung dieser Funktion gibt einfach auftragsantwortnachrichten zurück **"false"**.  
  
 Wenn `phGlobal` ist **NULL**, klicken Sie dann ein neues `HGLOBAL` reserviert und in zurückgegeben werden soll `phGlobal`. Andernfalls die `HGLOBAL` gemäß `phGlobal` mit Daten gefüllt werden soll. Die Menge der Daten platziert werden, der `HGLOBAL` darf sich nicht auf die aktuelle Größe des Speicherblocks. Darüber hinaus kann nicht der Block zu einem größeren zugewiesen werden.  
  
 Überschreiben Sie diese Funktion, um Ihre Daten in das angeforderte Format und das Medium angeben. Abhängig von Ihrer Daten können Sie eine der anderen Versionen dieser Funktion stattdessen überschreiben möchten. Wenn Sie mehrere Speichermedien behandeln möchten, überschreiben `OnRenderData`. Wenn Ihre Daten in einer Datei ist oder variabler Größe ist, überschreiben `OnRenderFileData`.  
  
 Weitere Informationen finden Sie unter der **FORMATETC** Struktur der [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  
  
##  <a name="onresetstate"></a>COleControl:: OnResetState ein  
 Vom Framework aufgerufen, wenn die Eigenschaften des Steuerelements auf ihre Standardwerte festgelegt werden soll.  
  
```  
virtual void OnResetState();
```  
  
### <a name="remarks"></a>Hinweise  
 Die Standardimplementierung ruft [DoPropExchange](#dopropexchange), und übergeben Sie ein `CPropExchange` -Objekt, das bewirkt, dass Eigenschaften auf ihre Standardwerte festgelegt werden.  
  
 Die Steuerelement-Writer kann Initialisierungscode für das OLE-Steuerelement einfügen, in diesem überschrieben. Diese Funktion wird aufgerufen, wenn [IPersistStream:: Load](http://msdn.microsoft.com/library/windows/desktop/ms680568) oder [IPersistStorage](http://msdn.microsoft.com/library/windows/desktop/ms680557) ein Fehler auftritt, oder [IPersistStreamInit](http://msdn.microsoft.com/library/windows/desktop/ms690234) oder [IPersistStorage::InitNew](http://msdn.microsoft.com/library/windows/desktop/ms687194) aufgerufen wird, ohne den ersten Aufruf eines **IPersistStream:: Load** oder **IPersistStorage**.  
  
##  <a name="onsetclientsite"></a>COleControl:: OnSetClientSite  
 Vom Framework aufgerufen, wenn der Container des Steuerelements aufgerufen hat **IOleControl::SetClientSite** Funktion.  
  
```  
virtual void OnSetClientSite();
```  
  
### <a name="remarks"></a>Hinweise  
 Standardmäßig `OnSetClientSite` überprüft, ob die Pfadeigenschaften Daten geladen werden, und wenn dies der Fall, ruft `DoDataPathPropExchange`.  
  
 Überschreiben Sie diese Funktion dazu jegliche spezielle Verarbeitung dieser Benachrichtigung ein. Insbesondere sollten Außerkraftsetzungen dieser Funktion der Basisklasse aufgerufen.  
  
##  <a name="onsetdata"></a>COleControl::OnSetData  
 Wird aufgerufen, durch das Framework das Steuerelement Daten mit den angegebenen Daten ersetzt.  
  
```  
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```  
  
### <a name="parameters"></a>Parameter  
 `lpFormatEtc`  
 Zeiger auf eine [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) Struktur, die das Format der Daten angibt.  
  
 `lpStgMedium`  
 Zeiger auf eine [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812) Struktur, in dem sich die Daten befinden.  
  
 `bRelease`  
 **"True"** Falls das Speichermedium; das Steuerelement freigegeben werden soll **"False"** Falls das Steuerelement das Speichermedium nicht freigegeben werden soll.  
  
### <a name="return-value"></a>Rückgabewert  
 Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).  
  
### <a name="remarks"></a>Hinweise  
 Die Daten in der permanenten Eigenschaft Format festgelegt ist, wird die standardmäßige Implementierung der Zustand des Steuerelements entsprechend geändert. Andernfalls wird die standardmäßige Implementierung keine Aktion ausgeführt. Wenn `bRelease` ist **"true"**, klicken Sie dann einen Aufruf von **ReleaseStgMedium** erfolgt; andernfalls nicht.  
  
 Überschreiben Sie diese Funktion, um die Daten des Steuerelements durch die angegebenen Daten zu ersetzen.  
  
 Weitere Informationen finden Sie unter der **FORMATETC** und **STGMEDIUM** Strukturen in den [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  
  
##  <a name="onsetextent"></a>COleControl::OnSetExtent  
 Vom Framework aufgerufen, wenn das Steuerelement-Block werden, infolge eines Aufrufs für geändert muss [IOleObject::SetExtent](http://msdn.microsoft.com/library/windows/desktop/ms694330).  
  
```  
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```  
  
### <a name="parameters"></a>Parameter  
 `lpSizeL`  
 Ein Zeiger auf die **SIZEL** -Struktur, die lange ganzen Zahlen verwendet, um die Breite und Höhe des Steuerelements, ausgedrückt in darzustellen **HIMETRIC** Einheiten.  
  
### <a name="return-value"></a>Rückgabewert  
 Wert ungleich NULL, wenn die Änderung der Textgröße akzeptiert wurde; andernfalls 0.  
  
### <a name="remarks"></a>Hinweise  
 Die standardmäßige Implementierung behandelt das Ändern der Größe des Wertebereichs für das Steuerelement. Wenn das Steuerelement in-Place aktiv, einen Aufruf an des Containers **OnPosRectChanged** dann erfolgt.  
  
 Überschreiben Sie diese Funktion zum Ändern der Standardeinstellung ändern der Größe des Steuerelements.  
  
##  <a name="onsetobjectrects"></a>COleControl::OnSetObjectRects  
 Wird aufgerufen, durch das Framework implementiert einen Aufruf von [IOleInPlaceObject::SetObjectRects](http://msdn.microsoft.com/library/windows/desktop/ms683767).  
  
```  
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,  
    LPCRECT lpRectClip);
```  
  
### <a name="parameters"></a>Parameter  
 *lpRectPos*  
 Ein Zeiger auf einen RECT-Struktur, der angibt, die neue Position und Größe relativ zu dem Container des Steuerelements.  
  
 `lpRectClip`  
 Ein Zeiger auf eine `RECT` Struktur, der angibt, eines rechteckigen Bereichs, der für die das Steuerelement abgeschnitten wird.  
  
### <a name="return-value"></a>Rückgabewert  
 Wert ungleich NULL, wenn die Neupositionieren akzeptiert wurde; andernfalls 0.  
  
### <a name="remarks"></a>Hinweise  
 Die standardmäßige Implementierung automatisch behandelt, die neu zu positionieren, und Ändern der Größe des Steuerelementfensters und gibt **"true"**.  
  
 Überschreiben Sie diese Funktion, um das Standardverhalten dieser Funktion ändern.  
  
##  <a name="onshowtoolbars"></a>COleControl::OnShowToolBars  
 Vom Framework aufgerufen, wenn das Steuerelement Benutzeroberfläche aktiviert wurde.  
  
```  
virtual void OnShowToolBars();
```  
  
### <a name="remarks"></a>Hinweise  
 Bei der Standardimplementierung wird keine Aktion ausgeführt.  
  
##  <a name="ontextchanged"></a>COleControl::OnTextChanged  
 Vom Framework aufgerufen, wenn die vordefinierte Wert der Beschriftung oder Text-Eigenschaft geändert wurde.  
  
```  
virtual void OnTextChanged();
```  
  
### <a name="remarks"></a>Hinweise  
 Die Standardimplementierung ruft `InvalidateControl`.  
  
 Überschreiben Sie diese Funktion, wenn die Benachrichtigung, nachdem diese Eigenschaft geändert werden soll.  
  
##  <a name="onwindowlessmessage"></a>COleControl::OnWindowlessMessage  
 Vom Framework als Antwort auf eines Containers aufgerufen **IOleInPlaceObjectWindowless::OnWindowMessage** Anforderung.  
  
```  
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```  
  
### <a name="parameters"></a>Parameter  
 `msg`  
 Nachrichten-ID von Windows zu übergeben.  
  
 `wParam`  
 Von Windows zu übergeben. Gibt zusätzliche Nachricht-spezifische Informationen. Der Inhalt dieses Parameters hängt von den Wert, der die `msg` Parameter.  
  
 `lParam`  
 Von Windows zu übergeben. Gibt zusätzliche Nachricht-spezifische Informationen. Der Inhalt dieses Parameters hängt von den Wert, der die `msg` Parameter.  
  
 *plResult*  
 Windows-Ergebniscode. Gibt das Ergebnis der Verarbeitung der Nachricht und hängt von der gesendeten Nachricht.  
  
### <a name="return-value"></a>Rückgabewert  
 Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).  
  
### <a name="remarks"></a>Hinweise  
 Verarbeitet Windows-Meldungen für fensterlose Steuerelemente. `COleControl`der `OnWindowlessMessage` fenstermeldungen als Maus und Tastatur Nachrichten verwendet werden soll. `COleControl`bietet [SetCapture](#setcapture) und [SetFocus](#setfocus) speziell für Mausfokus Capture und die Tastatur für fensterlose OLE-Objekte zu erhalten.  
  
 Da fensterlose Objekte nicht über ein Fenster verfügen, benötigen sie einen Mechanismus dar, die Container-Dispatchmeldungen werden können. Fensterlose OLE-Objekt ruft Nachrichten aus dem zugehörigen Container über die `OnWindowMessage` Methode für die `IOleInPlaceObjectWindowless` Schnittstelle (eine Erweiterung der [IOleInPlaceObject](http://msdn.microsoft.com/library/windows/desktop/ms692646) fensterlose Supportzwecken). `OnWindowMessage`übernimmt eine `HWND` Parameter.  
  
##  <a name="parenttoclient"></a>COleControl::ParentToClient  
 Übersetzt die Koordinaten der `pPoint` in Clientkoordinaten.  
  
```  
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;  
```  
  
### <a name="parameters"></a>Parameter  
 `lprcBounds`  
 Zeiger zu den Grenzen des OLE-Steuerelements innerhalb des Containers. Den Bereich des gesamten Steuerelements einschließlich Rahmen und Bildlaufleisten, aber nicht den Clientbereich.  
  
 `pPoint`  
 Zeiger auf das übergeordnete Element (Container) zeigen Sie auf die Koordinaten des Clientbereichs des Steuerelements übersetzt werden.  
  
 `bHitTest`  
 Gibt an, ob Treffertests ist auf dem Zeitpunkt ausgeführt werden.  
  
### <a name="return-value"></a>Rückgabewert  
 Wenn `bHitTest` ist **"false"**, gibt **HTNOWHERE**. Wenn `bHitTest` ist **"true"**, gibt der Speicherort, in dem das übergeordnete Element (Container) zeigen Sie, im Clientbereich des OLE-Steuerelements abgerufen und ist eines der folgenden Maus Treffertest-Werte:  
  
- **HTBORDER** im Rahmen eines Fensters, das nicht mit einen Rahmen verfügt.  
  
- **HTBOTTOM** In den horizontalen unteren Rand des Fensters.  
  
- **HTBOTTOMLEFT** In der unteren linken Ecke des Fensterrahmens.  
  
- **HTBOTTOMRIGHT** In der unteren rechten Ecke des Fensterrahmens.  
  
- **HTCAPTION** In einem Bereich von-Titelleiste.  
  
- **HTCLIENT** In einen Clientbereich.  
  
- **HTERROR** auf dem Bildschirmhintergrund oder auf eine Trennlinie zwischen den Fenstern (identisch mit **HTNOWHERE** mit dem Unterschied, dass die **DefWndProc** Windows-Funktion erzeugt einen Signalton zur Fehleranzeige).  
  
- **HTGROWBOX** In einem Größeneinstellungsfeld.  
  
- **HTHSCROLL** In der horizontalen Bildlaufleiste.  
  
- **HTLEFT** am linken Rand des Fensters.  
  
- **HTMAXBUTTON** In ein Maximieren-Schaltfläche.  
  
- **HTMENU** In einem Menübereich.  
  
- **HTMINBUTTON** In ein Minimieren-Schaltfläche.  
  
- **HTNOWHERE** auf dem Bildschirmhintergrund oder auf eine Trennlinie zwischen den Fenstern.  
  
- **HTREDUCE** In ein Minimieren-Schaltfläche.  
  
- **HTRIGHT** In den rechten Rand des Fensters.  
  
- **HTSIZE** In einem Größeneinstellungsfeld (identisch mit **HTGROWBOX**).  
  
- **HTSYSMENU** In einem Steuerelementmenü oder eine Schaltfläche "Schließen" in ein untergeordnetes Fenster.  
  
- **HTTOP** im oberen horizontalen Rands des Fensters.  
  
- **HTTOPLEFT** In der oberen linken Ecke des Fensterrahmens.  
  
- **HTTOPRIGHT** In der oberen rechten Ecke des Fensterrahmens.  
  
- **HTTRANSPARENT** In einem Fenster, die derzeit von einem anderen Fenster abgedeckt.  
  
- **HTVSCROLL** In der vertikalen Bildlaufleiste.  
  
- **HTZOOM** In ein Maximieren-Schaltfläche.  
  
### <a name="remarks"></a>Hinweise  
 Bei der Eingabe `pPoint` ist relativ zum Ursprung des übergeordneten Elements (obere linke Ecke des Containers). Bei der Ausgabe `pPoint` ist relativ zum Ursprung des Clientbereichs des OLE-Steuerelements (oberen linken Ecke des Clientbereichs des Steuerelements).  
  
##  <a name="postmodaldialog"></a>COleControl::PostModalDialog  
 Benachrichtigt dem Container ein modales Dialogfeld geschlossen wurde.  
  
```  
void PostModalDialog(HWND hWndParent = NULL);
```  
  
### <a name="parameters"></a>Parameter  
 `hWndParent`  
 Handle für das übergeordnete Fenster eines das modale Dialogfeld.  
  
### <a name="remarks"></a>Hinweise  
 Mit dieser Funktion wird nach jeder modales Dialogfeld angezeigt. Sie müssen diese Funktion aufrufen, so, dass der Container alle Fenster auf oberster Ebene deaktiviert aktivieren kann `PreModalDialog`. Diese Funktion sollte mit einem Aufruf von gekoppelt werden `PreModalDialog`.  
  
##  <a name="premodaldialog"></a>COleControl::PreModalDialog  
 Benachrichtigt den Container, die ein modales Dialogfeld angezeigt werden.  
  
```  
void PreModalDialog(HWND hWndParent = NULL);
```  
  
### <a name="parameters"></a>Parameter  
 `hWndParent`  
 Handle für das übergeordnete Fenster eines das modale Dialogfeld.  
  
### <a name="remarks"></a>Hinweise  
 Mit dieser Funktion wird vor jeder modales Dialogfeld angezeigt. Sie müssen diese Funktion aufrufen, damit, dass der Container aller seiner Fenster auf oberster Ebene deaktivieren kann. Nachdem das modale Dialogfeld angezeigt wurde, klicken Sie dann aufrufen `PostModalDialog`.  
  
##  <a name="recreatecontrolwindow"></a>COleControl::RecreateControlWindow  
 Zerstört und neu erstellt das Fenster des Steuerelements.  
  
```  
void RecreateControlWindow();
```  
  
### <a name="remarks"></a>Hinweise  
 Dies ist möglicherweise erforderlich, wenn Sie das Fenster Stilbits ändern müssen.  
  
##  <a name="refresh"></a>COleControl::Refresh  
 Erzwingt das Neuzeichnen des OLE-Steuerelements.  
  
```  
void Refresh();
```  
  
### <a name="remarks"></a>Hinweise  
 Diese Funktion wird unterstützt, indem Sie die `COleControl` -Basisklasse als eine vordefinierte Methode namens aktualisieren. Dadurch können Benutzer Ihre OLE-Steuerelements zu einem bestimmten Zeitpunkt das Steuerelement neu gezeichnet. Weitere Informationen zu dieser Methode finden Sie im Artikel [ActiveX-Steuerelemente: Methoden](../../mfc/mfc-activex-controls-methods.md).  
  
##  <a name="releasecapture"></a>COleControl::ReleaseCapture  
 Versionen Mauseingaben aufzufangen.  
  
```  
BOOL ReleaseCapture();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).  
  
### <a name="remarks"></a>Hinweise  
 Wenn das Steuerelement gerade das Erfassen von Mauseingaben verfügt, wird die Erfassung freigegeben. Andernfalls hat diese Funktion keine Auswirkungen.  
  
##  <a name="releasedc"></a>COleControl::ReleaseDC  
 Gibt den Anzeigegerätekontext eines Containers ein fensterloses Steuerelement, das den Gerätekontext für die Verwendung durch andere Anwendungen freigegeben frei.  
  
```  
int ReleaseDC(CDC* pDC);
```  
  
### <a name="parameters"></a>Parameter  
 `pDC`  
 Identifiziert den Gerätekontext Container freigegeben werden.  
  
### <a name="return-value"></a>Rückgabewert  
 Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).  
  
### <a name="remarks"></a>Hinweise  
 Rufen Sie die Anwendung muss `ReleaseDC` für jeden Aufruf von [GetDC](#getdc).  
  
##  <a name="reparentcontrolwindow"></a>COleControl::ReparentControlWindow  
 Legt das übergeordnete Element des Steuerelements fest.  
  
```  
virtual void ReparentControlWindow(
    HWND hWndOuter,  
    HWND hWndParent);
```  
  
### <a name="parameters"></a>Parameter  
 *hWndOuter*  
 Das Handle des Steuerelementfensters.  
  
 `hWndParent`  
 Das Handle des neuen übergeordneten Fensters.  
  
### <a name="remarks"></a>Hinweise  
 Rufen Sie diese Funktion, um das übergeordnete Element des Steuerelementfensters zurückzusetzen.  
  
##  <a name="resetstockprops"></a>COleControl::ResetStockProps  
 Initialisiert den Status der `COleControl` vordefinierte Eigenschaften mit ihren Standardwerten.  
  
```  
void ResetStockProps();
```  
  
### <a name="remarks"></a>Hinweise  
 Die Eigenschaften sind: Darstellung, BackColor BorderStyle, Beschriftung, aktiviert, Schriftart, ForeColor, hWnd und Text. Eine Beschreibung der Basiseigenschaften, finden Sie unter [ActiveX-Steuerelemente: Hinzufügen von Basiseigenschaften](../../mfc/mfc-activex-controls-adding-stock-properties.md).  
  
 Sie können ein Steuerelement binäre Initialisierung Leistung verbessern, indem `ResetStockProps` und `ResetVersion` überschreiben `COleControl::OnResetState`. Siehe das unten aufgeführte Beispiel. Weitere Informationen zum Optimieren der Initialisierung finden Sie unter [ActiveX-Steuerelemente: Optimierung](../../mfc/mfc-activex-controls-optimization.md).  
  
### <a name="example"></a>Beispiel  
 [!code-cpp[NVC_MFCAxCtl #7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]  
  
##  <a name="resetversion"></a>COleControl::ResetVersion  
 Initialisiert die Versionsnummer auf angegebenen Wert.  
  
```  
void ResetVersion(DWORD dwVersionDefault);
```  
  
### <a name="parameters"></a>Parameter  
 `dwVersionDefault`  
 Die Versionsnummer, die dem Steuerelement zugewiesen werden soll.  
  
### <a name="remarks"></a>Hinweise  
 Sie können ein Steuerelement binäre Initialisierung Leistung verbessern, indem `ResetVersion` und `ResetStockProps` überschreiben `COleControl::OnResetState`. Siehe das Beispiel [ResetStockProps](#resetstockprops). Weitere Informationen zum Optimieren der Initialisierung finden Sie unter [ActiveX-Steuerelemente: Optimierung](../../mfc/mfc-activex-controls-optimization.md).  
  
##  <a name="scrollwindow"></a>COleControl::ScrollWindow  
 Ermöglicht eine fensterlose OLE-Objekts, um einen Bereich innerhalb der direkten aktives Image auf dem Bildschirm einen Bildlauf durchzuführen.  
  
```  
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```  
  
### <a name="parameters"></a>Parameter  
 `xAmount`  
 Gibt die Menge in der Einheit Gerät, horizontalen Bildlauf an. Dieser Parameter muss einen negativen Wert auf der linken Seite einen Bildlauf durchführen.  
  
 `yAmount`  
 Gibt die Menge in der Einheit Gerät, einen vertikalen Bildlauf ausführen. Dieser Parameter muss ein negativer Wert einen Bildlauf nach oben durchführen.  
  
 `lpRect`  
 Verweist auf eine [CRect](../../atl-mfc-shared/reference/crect-class.md) Objekt oder RECT-Struktur, die Teil des Clientbereichs OLE-Objekts, um einen Bildlauf durchzuführen, in Clientkoordinaten des enthaltenden Fensters angibt. Wenn `lpRect` ist **NULL**, Clientbereich des gesamten OLE-Objekts wird ein Bildlauf durchgeführt.  
  
 `lpClipRect`  
 Verweist auf eine `CRect` Objekt oder `RECT` Struktur, die das Rechteck auf Zuschneiden angibt. Nur ein Pixel in das Rechteck werden durchgeführt. Bits außerhalb des Rechtecks sind nicht betroffen, selbst wenn werden die `lpRect` Rechteck. Wenn `lpClipRect` ist **NULL**, ohne Clipping für das Bildlaufrechteck ausgeführt wird.  
  
##  <a name="selectfontobject"></a>COleControl::SelectFontObject  
 Wählt eine Schriftart in einem Gerätekontext.  
  
```  
CFont* SelectFontObject(
    CDC* pDC,  
    CFontHolder& fontHolder);
```  
  
### <a name="parameters"></a>Parameter  
 `pDC`  
 Ein Zeiger auf ein Gerät Context-Objekt.  
  
 `fontHolder`  
 Ein Verweis auf die [CFontHolder](../../mfc/reference/cfontholder-class.md) Objekt, das die Schriftart auszuwählenden darstellt.  
  
### <a name="return-value"></a>Rückgabewert  
 Ein Zeiger auf die zuvor ausgewählten Schriftart. Nachdem alle Zeichenoperationen, mit denen der Aufrufer abgeschlossen *FontHolder,* sollten sie die zuvor ausgewählte Schriftart erneut aktivieren, als Parameter an Sie übergeben [CDC:: SelectObject](../../mfc/reference/cdc-class.md#selectobject).  
  
##  <a name="selectstockfont"></a>COleControl:: SelectStockFont  
 Wählt die vordefinierte Schriftarteigenschaft einen Gerätekontext.  
  
```  
CFont* SelectStockFont(CDC* pDC);
```  
  
### <a name="parameters"></a>Parameter  
 `pDC`  
 Der Gerätekontext, in dem die Schriftart ausgewählt wird.  
  
### <a name="return-value"></a>Rückgabewert  
 Ein Zeiger auf die zuvor ausgewählten `CFont` Objekt. Verwenden Sie [CDC:: SelectObject](../../mfc/reference/cdc-class.md#selectobject) diese Schriftart zurück im Gerätekontext auswählen, wenn Sie fertig sind.  
  
##  <a name="serializeextent"></a>COleControl::SerializeExtent  
 Serialisiert bzw. initialisiert den Zustand, der dem Steuerelement zugewiesene Speicherplatz.  
  
```  
void SerializeExtent(CArchive& ar);
```  
  
### <a name="parameters"></a>Parameter  
 `ar`  
 Ein `CArchive` zu an / von zu serialisierende Objekt.  
  
### <a name="remarks"></a>Hinweise  
 Sie können ein Steuerelement binäre Dauerhaftigkeit Leistung verbessern, indem `SerializeExtent`, `SerializeStockProps`, und `SerializeVersion` überschreiben **COleControl::Serialize**. Siehe das unten aufgeführte Beispiel. Weitere Informationen zum Optimieren der Initialisierung finden Sie unter [ActiveX-Steuerelemente: Optimierung](../../mfc/mfc-activex-controls-optimization.md).  
  
### <a name="example"></a>Beispiel  
 [!code-cpp[NVC_MFCAxCtl #8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]  
  
##  <a name="serializestockprops"></a>COleControl::SerializeStockProps  
 Serialisiert oder den Status des initialisiert die `COleControl` Basiseigenschaften: Darstellung, BackColor BorderStyle, Beschriftung, aktiviert, Schriftart, Vordergrundfarbe und Text.  
  
```  
void SerializeStockProps(CArchive& ar);
```  
  
### <a name="parameters"></a>Parameter  
 `ar`  
 Ein `CArchive` zu an / von zu serialisierende Objekt.  
  
### <a name="remarks"></a>Hinweise  
 Eine Beschreibung der Basiseigenschaften, finden Sie unter [ActiveX-Steuerelemente: Hinzufügen von Basiseigenschaften](../../mfc/mfc-activex-controls-adding-stock-properties.md).  
  
 Sie können ein Steuerelement binäre Dauerhaftigkeit Leistung verbessern, indem `SerializeStockProps`, `SerializeExtent`, und `SerializeVersion` überschreiben **COleControl::Serialize**. Ein Beispiel finden Sie den Code am [SerializeExtent](#serializeextent). Weitere Informationen zum Optimieren der Initialisierung finden Sie unter [ActiveX-Steuerelemente: Optimierung](../../mfc/mfc-activex-controls-optimization.md).  
  
##  <a name="serializeversion"></a>COleControl::SerializeVersion  
 Serialisiert oder den Status der Versionsinformationen eines Steuerelements initialisiert.  
  
```  
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```  
  
### <a name="parameters"></a>Parameter  
 `ar`  
 Ein `CArchive` zu an / von zu serialisierende Objekt.  
  
 `dwVersionDefault`  
 Die aktuelle Versionsnummer des Steuerelements.  
  
 `bConvert`  
 Gibt an, ob es sich bei permanente Daten in das aktuelle Format konvertiert werden sollen, wenn es gespeichert ist, oder das gleiche Format beibehalten, dass er hatte, als es geladen wurde.  
  
### <a name="return-value"></a>Rückgabewert  
 Die Versionsnummer des Steuerelements. Wenn das angegebene Archiv geladen wird, `SerializeVersion` gibt die Version aus diesem Archiv geladen. Andernfalls wird die derzeit geladene Version zurückgegeben.  
  
### <a name="remarks"></a>Hinweise  
 Sie können ein Steuerelement binäre Dauerhaftigkeit Leistung verbessern, indem `SerializeVersion`, `SerializeExtent`, und `SerializeStockProps` überschreiben **COleControl::Serialize**. Ein Beispiel finden Sie den Code am [SerializeExtent](#serializeextent). Weitere Informationen zum Optimieren der Initialisierung finden Sie unter [ActiveX-Steuerelemente: Optimierung](../../mfc/mfc-activex-controls-optimization.md).  
  
##  <a name="setappearance"></a>COleControl::SetAppearance  
 Legt den vordefinierten Darstellung-Eigenschaftswert des Steuerelements fest.  
  
```  
void SetAppearance (short sAppearance);
```  
  
### <a name="parameters"></a>Parameter  
 *sAppearance*  
 Ein **kurze** ( `VT_I2`) Wert für die Darstellung des Steuerelements verwendet werden soll. Ein Wert von 0 (null) legt die Darstellung des Steuerelements, Flatfiles und der Wert 1 die Darstellung des Steuerelements 3D.  
  
### <a name="remarks"></a>Hinweise  
 Weitere Informationen über Basiseigenschaften finden Sie unter [ActiveX-Steuerelemente: Eigenschaften](../../mfc/mfc-activex-controls-properties.md).  
  
##  <a name="setbackcolor"></a>COleControl::SetBackColor  
 Legt den vordefinierten BackColor-Eigenschaftswert des Steuerelements fest.  
  
```  
void SetBackColor(OLE_COLOR dwBackColor);
```  
  
### <a name="parameters"></a>Parameter  
 *dwBackColor*  
 Ein **OLE_COLOR** Wert für den Hintergrund des Steuerelements Zeichnen verwendet werden soll.  
  
### <a name="remarks"></a>Hinweise  
 Weitere Informationen zur Verwendung dieser Eigenschaft und andere Eigenschaften beziehen, finden Sie im Artikel [ActiveX-Steuerelemente: Eigenschaften](../../mfc/mfc-activex-controls-properties.md).  
  
##  <a name="setborderstyle"></a>COleControl::SetBorderStyle  
 Legt den vordefinierten BorderStyle-Eigenschaftswert des Steuerelements fest.  
  
```  
void SetBorderStyle(short sBorderStyle);
```  
  
### <a name="parameters"></a>Parameter  
 *sBorderStyle*  
 Die neue Rahmenart für das Steuerelement; 0 gibt an, kein Rahmen und 1 zeigt einen normalen Rahmen an.  
  
### <a name="remarks"></a>Hinweise  
 Das Fenster des Steuerelements wird dann neu erstellt werden und `OnBorderStyleChanged` aufgerufen.  
  
##  <a name="setcapture"></a>COleControl::SetCapture  
 Bewirkt, dass das Steuerelement Containerfenster auszuführenden Besitz der Mausauswahl im Auftrag des Steuerelements.  
  
```  
CWnd* SetCapture();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Ein Zeiger auf die **CWnd** Window-Objekt, das zuvor Mauseingabe empfangen.  
  
### <a name="remarks"></a>Hinweise  
 Wenn das Steuerelement aktiviert und das fensterlose ist, wird diese Funktion Containerfenster auszuführenden Besitz der Mausauswahl, im Auftrag des Steuerelements das Steuerelement an. Diese Funktion verursacht, andernfalls das Steuerelement selbst wird der Besitz der Mausauswahl (identisch mit `CWnd::SetCapture`).  
  
##  <a name="setcontrolsize"></a>COleControl::SetControlSize  
 Legt die Größe des Steuerelementfensters OLE fest und benachrichtigt den Container, den die Website des Steuerelements geändert wird.  
  
```  
BOOL SetControlSize(int cx, int cy);
```  
  
### <a name="parameters"></a>Parameter  
 `cx`  
 Gibt die neue Breite des Steuerelements in Pixel an.  
  
 `cy`  
 Gibt die neue Höhe des Steuerelements in Pixel an.  
  
### <a name="return-value"></a>Rückgabewert  
 Wert ungleich NULL, wenn der Aufruf erfolgreich war; andernfalls 0.  
  
### <a name="remarks"></a>Hinweise  
 Diese Funktion sollte nicht im Konstruktor des Steuerelements verwendet werden.  
  
 Beachten Sie, dass alle Koordinaten für das Steuerelement Windows relativ zur linken oberen Ecke des Steuerelements.  
  
##  <a name="setenabled"></a>COleControl::SetEnabled  
 Legt die Aktien aktiviert-Eigenschaftswert des Steuerelements fest.  
  
```  
void SetEnabled(BOOL bEnabled);
```  
  
### <a name="parameters"></a>Parameter  
 `bEnabled`  
 **"True"** Wenn das Steuerelement aktiviert werden andernfalls **"false"**.  
  
### <a name="remarks"></a>Hinweise  
 Nach dem Festlegen dieser Eigenschaft **OnEnabledChange** aufgerufen wird.  
  
##  <a name="setfocus"></a>COleControl::SetFocus  
 Bewirkt, dass das Steuerelement Containerfenster, schalten Sie Namen für das Steuerelement den Eingabefokus besitzt.  
  
```  
CWnd* SetFocus();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Ein Zeiger auf die **CWnd** Window-Objekt, das den Eingabefokus zuvor hatte oder **NULL** , wenn kein solcher Fenster vorhanden ist.  
  
### <a name="remarks"></a>Hinweise  
 Wenn das Steuerelement aktiviert und das fensterlose ist, wird diese Funktion Containerfenster, schalten Sie Namen für das Steuerelement den Eingabefokus besitzt das Steuerelement an. Der Eingabefokus weist Tastatureingaben an den Container-Fenster, und der Container verteilt alle nachfolgenden tastaturmeldungen auf die OLE-Objekt, das Aufrufe `SetFocus`. Ein Fenster, das wie den Eingabefokus zuvor verliert er.  
  
 Wenn das Steuerelement nicht fensterlose ist, diese Funktion bewirkt, dass das Steuerelement selbst, der den Eingabefokus besitzt auszuführenden (identisch mit `CWnd::SetFocus`).  
  
##  <a name="setfont"></a>COleControl::SetFont  
 Legt die vordefinierte Schriftarteigenschaft des Steuerelements fest.  
  
```  
void SetFont(LPFONTDISP pFontDisp);
```  
  
### <a name="parameters"></a>Parameter  
 *pFontDisp*  
 Ein Zeiger auf eine Schriftart Dispatch-Schnittstelle.  
  
##  <a name="setforecolor"></a>COleControl::SetForeColor  
 Legt den vordefinierten ForeColor-Eigenschaftswert des Steuerelements fest.  
  
```  
void SetForeColor(OLE_COLOR dwForeColor);
```  
  
### <a name="parameters"></a>Parameter  
 *dwForeColor*  
 Ein **OLE_COLOR** Wert für die Vordergrundfarbe des Steuerelements Zeichnen verwendet werden soll.  
  
### <a name="remarks"></a>Hinweise  
 Weitere Informationen zur Verwendung dieser Eigenschaft und andere Eigenschaften beziehen, finden Sie im Artikel [ActiveX-Steuerelemente: Eigenschaften](../../mfc/mfc-activex-controls-properties.md).  
  
##  <a name="setinitialdataformats"></a>COleControl::SetInitialDataFormats  
 Vom Framework aufgerufen wird, initialisieren die Liste der Datenformate, die vom Steuerelement unterstützt wird.  
  
```  
virtual void SetInitialDataFormats();
```  
  
### <a name="remarks"></a>Hinweise  
 Die Standardimplementierung gibt zwei Formate: `CF_METAFILEPICT` und die persistenten Eigenschaft festgelegt.  
  
##  <a name="setinitialsize"></a>COleControl::SetInitialSize  
 Legt die Größe eines OLE-Steuerelements, wenn in einem Container erstmals angezeigt.  
  
```  
void SetInitialSize(
    int cx,  
    int cy);
```  
  
### <a name="parameters"></a>Parameter  
 `cx`  
 Die anfängliche Breite des OLE-Steuerelements in Pixel.  
  
 `cy`  
 Die anfängliche Höhe des OLE-Steuerelements in Pixel.  
  
### <a name="remarks"></a>Hinweise  
 Rufen Sie diese Funktion in Ihrem Konstruktor, um die Anfangsgröße des Steuerelements festgelegt. Die anfängliche Größe wird in Geräteeinheiten oder Pixel gemessen. Es wird empfohlen, dass dieser Aufruf im Konstruktor des Steuerelements vorgenommen werden.  
  
##  <a name="setmodifiedflag"></a>COleControl::SetModifiedFlag  
 Ändert den geänderten Zustand eines Steuerelements an.  
  
```  
void SetModifiedFlag(BOOL bModified = TRUE);
```  
  
### <a name="parameters"></a>Parameter  
 `bModified`  
 Der neue Wert für das Steuerelement des Flag geändert. **"True"** gibt an, dass der Zustand des Steuerelements geändert wurde; **"False"** gibt an, dass der Zustand des Steuerelements gerade gespeichert wurde.  
  
### <a name="remarks"></a>Hinweise  
 Rufen Sie, dass diese Funktion, wenn eine Änderung, die erfolgt persistenten Status des Steuerelements auswirken würde. Beispielsweise wenn der Wert einer permanenten Eigenschaft geändert wird, rufen Sie diese Funktion mit `bModified` **"true"**.  
  
##  <a name="setnotpermitted"></a>COleControl::SetNotPermitted  
 Gibt an, dass eine Anforderung bearbeiten fehlgeschlagen ist.  
  
```  
void SetNotPermitted();
```  
  
### <a name="remarks"></a>Hinweise  
 Mit dieser Funktion wird bei der `BoundPropertyRequestEdit` ein Fehler auftritt. Diese Funktion löst eine Ausnahme vom Typ **COleDispScodeException** um anzugeben, dass die Set-Vorgang nicht zugelassen wurde.  
  
##  <a name="setnotsupported"></a>COleControl::SetNotSupported  
 Verhindert die Änderung an den Eigenschaftswert eines Steuerelements, durch den Benutzer.  
  
```  
void SetNotSupported();
```  
  
### <a name="remarks"></a>Hinweise  
 Mit dieser Funktion werden anstelle der Set-Funktion, einer beliebigen Eigenschaft, in dem Änderung des Werts der Benutzer das Steuerelement nicht unterstützt. Ein Beispiel wäre eine Eigenschaft, die schreibgeschützt ist.  
  
##  <a name="setrectincontainer"></a>COleControl::SetRectInContainer  
 Legt die Koordinaten für das Rechteck des Steuerelements relativ zu dem Container, der im Geräteeinheiten ausgedrückt.  
  
```  
BOOL SetRectInContainer(LPCRECT lpRect);
```  
  
### <a name="parameters"></a>Parameter  
 `lpRect`  
 Ein Zeiger auf ein Rechteck, das das Steuerelement die neuen Koordinaten relativ zu dem Container enthält.  
  
### <a name="return-value"></a>Rückgabewert  
 Wert ungleich NULL, wenn der Aufruf erfolgreich war; andernfalls 0.  
  
### <a name="remarks"></a>Hinweise  
 Wenn das Steuerelement geöffnet ist, wird er angepasst. andernfalls des Containers **OnPosRectChanged** Funktion aufgerufen wird.  
  
##  <a name="settext"></a>COleControl::SetText  
 Legt den Wert der Systemeigenschaft Beschriftung oder den Text-Eigenschaft des Steuerelements.  
  
```  
void SetText(LPCTSTR pszText);
```  
  
### <a name="parameters"></a>Parameter  
 `pszText`  
 Ein Zeiger auf eine Zeichenfolge.  
  
### <a name="remarks"></a>Hinweise  
 Beachten Sie, dass die Basiseigenschaften Titel und Text sowohl auf den gleichen Wert zugeordnet werden. Dies bedeutet, dass alle Änderungen an einer Eigenschaft beide Eigenschaften automatisch geändert werden. Im Allgemeinen sollte ein Steuerelement Aktie Beschriftung oder Text-Eigenschaft, aber nicht beides unterstützt.  
  
##  <a name="throwerror"></a>ThrowError  
 Signalisiert das Vorkommen eines Fehlers in das Steuerelement.  
  
```  
void ThrowError(
    SCODE sc,  
    UINT nDescriptionID,  
    UINT nHelpID = -1);

 
void ThrowError(
    SCODE sc,  
    LPCTSTR pszDescription = NULL,  
    UINT nHelpID = 0);
```  
  
### <a name="parameters"></a>Parameter  
 `sc`  
 Der Code Statuswert gemeldet werden. Eine vollständige Liste der möglichen Fehlercodes, finden Sie im Artikel [ActiveX-Steuerelemente: Weiterführende Themen](../../mfc/mfc-activex-controls-advanced-topics.md).  
  
 `nDescriptionID`  
 Die Zeichenfolgenressource-ID der Ausnahme gemeldet werden.  
  
 `nHelpID`  
 Die Hilfe-ID des Themas auf gemeldet werden.  
  
 `pszDescription`  
 Eine Zeichenfolge mit einer Beschreibung der Ausnahme gemeldet werden.  
  
### <a name="remarks"></a>Hinweise  
 Diese Funktion sollte nur von innerhalb einer Funktion abzurufen oder festzulegen für eine OLE-Eigenschaft oder die Implementierung einer OLE-Automatisierung-Methode aufgerufen werden. Wenn Sie Fehler darauf hinweisen, die zu anderen Zeiten auftreten müssen, sollten Sie die vordefinierte Error-Ereignis auslösen.  
  
##  <a name="transformcoords"></a>COleControl::TransformCoords  
 Transformationen Koordinatenwerte zwischen **HIMETRIC** Einheiten und systemeigene Einheiten des Containers.  
  
```  
void TransformCoords(
    POINTL* lpptlHimetric,  
    POINTF* lpptfContainer,  
    DWORD flags);
```  
  
### <a name="parameters"></a>Parameter  
 *lpptlHimetric*  
 Zeiger auf eine **POINTL** Struktur, die Koordinaten enthält **HIMETRIC** Einheiten.  
  
 *lpptfContainer*  
 Zeiger auf eine **POINTF** Struktur, die Koordinaten in der Größe des Containers enthält.  
  
 `flags`  
 Eine Kombination der folgenden Werte:  
  
- **XFORMCOORDS_POSITION** eine Position im Container.  
  
- **XFORMCOORDS_SIZE** eine Größe im Container.  
  
- **XFORMCOORDS_HIMETRICTOCONTAINER** transformieren **HIMETRIC** Einheiten, um die Einheiten für den Container.  
  
- **XFORMCOORDS_CONTAINERTOHIMETRIC** Transformieren des Containers Einheiten **HIMETRIC** Einheiten.  
  
### <a name="remarks"></a>Hinweise  
 Die ersten beiden Flags **XFORMCOORDS_POSITION** und **XFORMCOORDS_SIZE**, gibt an, ob die Koordinaten als eine Position oder eine Größe behandelt werden sollen. Die verbleibenden zwei Flags geben an, die Richtung der Transformation wird.  
  
##  <a name="translatecolor"></a>Memberfunktion COleControl:: TranslateColor  
 Konvertiert einen Farbwert aus der **OLE_COLOR** Datentyp, der [COLORREF](http://msdn.microsoft.com/library/windows/desktop/dd183449) -Datentyp.  
  
```  
COLORREF TranslateColor(
    OLE_COLOR clrColor,  
    HPALETTE hpal = NULL);
```  
  
### <a name="parameters"></a>Parameter  
 `clrColor`  
 Ein **OLE_COLOR** -Datentyp. Weitere Informationen finden Sie unter Windows [OleTranslateColor](http://msdn.microsoft.com/library/windows/desktop/ms694353) Funktion.  
  
 `hpal`  
 Ein Handle für einen optionalen Palette; kann **NULL**.  
  
### <a name="return-value"></a>Rückgabewert  
 Ein RGB (Rot, Grün, Blau)-32-Bit-Farben-Wert, der die Durchgezogen definiert Farbe am nächsten gelegenen der `clrColor` -Wert, der das Gerät darstellen kann.  
  
### <a name="remarks"></a>Hinweise  
 Diese Funktion ist nützlich, um die ForeColor und BackColor Basiseigenschaften zu übersetzen **COLORREF** Datentypen [CDC](../../mfc/reference/cdc-class.md) Memberfunktionen.  
  
##  <a name="willambientsbevalidduringload"></a>COleControl::WillAmbientsBeValidDuringLoad  
 Bestimmt, ob das Steuerelement die Werte der Umgebungseigenschaften als Standardwerte verwenden soll, wenn es anschließend vom persistenten Zustand geladen wird.  
  
```  
BOOL WillAmbientsBeValidDuringLoad();
```  
  
### <a name="return-value"></a>Rückgabewert  
 Nonzero gibt an, dass Umgebungseigenschaften gültig sind. Andernfalls werden Umgebungseigenschaften nicht gültig.  
  
### <a name="remarks"></a>Hinweise  
 In einigen Containern das Steuerelement möglicherweise keinen Zugriff auf seine Umgebungseigenschaften während des ersten Aufrufs an die Außerkraftsetzung der `COleControl::DoPropExchange`. Dies ist der Fall, wenn der Container aufruft [IPersistStreamInit::Load](http://msdn.microsoft.com/library/windows/desktop/ms680730) oder [IPersistStorage](http://msdn.microsoft.com/library/windows/desktop/ms680557) vor dem Aufruf [IOleObject::SetClientSite](http://msdn.microsoft.com/library/windows/desktop/ms684013) (d. h., wenn es keine Auswirkungen die **OLEMISC_SETCLIENTSITEFIRST** Statusbit).  
  
##  <a name="windowproc"></a>COleControl::WindowProc  
 Stellt eine Windows-Prozedur für eine `COleControl` Objekt.  
  
```  
virtual LRESULT WindowProc(
    UINT message,  
    WPARAM wParam,  
    LPARAM lParam);
```  
  
### <a name="parameters"></a>Parameter  
 `message`  
 Gibt die Windows-Meldung verarbeitet werden.  
  
 `wParam`  
 Enthält zusätzliche Informationen, die bei der Verarbeitung der Nachricht verwendet. Der Wert des Parameters hängt von der Nachricht ab.  
  
 `lParam`  
 Enthält zusätzliche Informationen, die bei der Verarbeitung der Nachricht verwendet. Der Wert des Parameters hängt von der Nachricht ab.  
  
### <a name="return-value"></a>Rückgabewert  
 Der Rückgabewert der Nachricht weitergeleitet werden soll.  
  
### <a name="remarks"></a>Hinweise  
 Rufen Sie diese Funktion, um bestimmte Nachrichten über das Steuerelement meldungszuordnung verteilt.  
  
## <a name="see-also"></a>Siehe auch  
 [MFC-Beispiel CIRC3](../../visual-cpp-samples.md)   
 [MFC-Beispiel TESTHELP](../../visual-cpp-samples.md)   
 [COlePropertyPage-Klasse](../../mfc/reference/colepropertypage-class.md)   
 [CWnd-Klasse](../../mfc/reference/cwnd-class.md)   
 [Hierarchiediagramm](../../mfc/hierarchy-chart.md)   
 [CFontHolder-Klasse](../../mfc/reference/cfontholder-class.md)   
 [CPictureHolder-Klasse](../../mfc/reference/cpictureholder-class.md)

