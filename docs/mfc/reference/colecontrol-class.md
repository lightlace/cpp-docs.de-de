---
title: COleControl-Klasse
ms.date: 08/27/2018
f1_keywords:
- COleControl
- AFXCTL/COleControl
- AFXCTL/COleControl::COleControl
- AFXCTL/COleControl::AmbientAppearance
- AFXCTL/COleControl::AmbientBackColor
- AFXCTL/COleControl::AmbientDisplayName
- AFXCTL/COleControl::AmbientFont
- AFXCTL/COleControl::AmbientForeColor
- AFXCTL/COleControl::AmbientLocaleID
- AFXCTL/COleControl::AmbientScaleUnits
- AFXCTL/COleControl::AmbientShowGrabHandles
- AFXCTL/COleControl::AmbientShowHatching
- AFXCTL/COleControl::AmbientTextAlign
- AFXCTL/COleControl::AmbientUIDead
- AFXCTL/COleControl::AmbientUserMode
- AFXCTL/COleControl::BoundPropertyChanged
- AFXCTL/COleControl::BoundPropertyRequestEdit
- AFXCTL/COleControl::ClientToParent
- AFXCTL/COleControl::ClipCaretRect
- AFXCTL/COleControl::ControlInfoChanged
- AFXCTL/COleControl::DisplayError
- AFXCTL/COleControl::DoClick
- AFXCTL/COleControl::DoPropExchange
- AFXCTL/COleControl::DoSuperclassPaint
- AFXCTL/COleControl::EnableSimpleFrame
- AFXCTL/COleControl::ExchangeExtent
- AFXCTL/COleControl::ExchangeStockProps
- AFXCTL/COleControl::ExchangeVersion
- AFXCTL/COleControl::FireClick
- AFXCTL/COleControl::FireDblClick
- AFXCTL/COleControl::FireError
- AFXCTL/COleControl::FireEvent
- AFXCTL/COleControl::FireKeyDown
- AFXCTL/COleControl::FireKeyPress
- AFXCTL/COleControl::FireKeyUp
- AFXCTL/COleControl::FireMouseDown
- AFXCTL/COleControl::FireMouseMove
- AFXCTL/COleControl::FireMouseUp
- AFXCTL/COleControl::FireReadyStateChange
- AFXCTL/COleControl::GetActivationPolicy
- AFXCTL/COleControl::GetAmbientProperty
- AFXCTL/COleControl::GetAppearance
- AFXCTL/COleControl::GetBackColor
- AFXCTL/COleControl::GetBorderStyle
- AFXCTL/COleControl::GetCapture
- AFXCTL/COleControl::GetClassID
- AFXCTL/COleControl::GetClientOffset
- AFXCTL/COleControl::GetClientRect
- AFXCTL/COleControl::GetClientSite
- AFXCTL/COleControl::GetControlFlags
- AFXCTL/COleControl::GetControlSize
- AFXCTL/COleControl::GetDC
- AFXCTL/COleControl::GetEnabled
- AFXCTL/COleControl::GetExtendedControl
- AFXCTL/COleControl::GetFocus
- AFXCTL/COleControl::GetFont
- AFXCTL/COleControl::GetFontTextMetrics
- AFXCTL/COleControl::GetForeColor
- AFXCTL/COleControl::GetHwnd
- AFXCTL/COleControl::GetMessageString
- AFXCTL/COleControl::GetNotSupported
- AFXCTL/COleControl::GetReadyState
- AFXCTL/COleControl::GetRectInContainer
- AFXCTL/COleControl::GetStockTextMetrics
- AFXCTL/COleControl::GetText
- AFXCTL/COleControl::GetWindowlessDropTarget
- AFXCTL/COleControl::InitializeIIDs
- AFXCTL/COleControl::InternalGetFont
- AFXCTL/COleControl::InternalGetText
- AFXCTL/COleControl::InternalSetReadyState
- AFXCTL/COleControl::InvalidateControl
- AFXCTL/COleControl::InvalidateRgn
- AFXCTL/COleControl::IsConvertingVBX
- AFXCTL/COleControl::IsModified
- AFXCTL/COleControl::IsOptimizedDraw
- AFXCTL/COleControl::IsSubclassedControl
- AFXCTL/COleControl::Load
- AFXCTL/COleControl::LockInPlaceActive
- AFXCTL/COleControl::OnAmbientPropertyChange
- AFXCTL/COleControl::OnAppearanceChanged
- AFXCTL/COleControl::OnBackColorChanged
- AFXCTL/COleControl::OnBorderStyleChanged
- AFXCTL/COleControl::OnClick
- AFXCTL/COleControl::OnClose
- AFXCTL/COleControl::OnDoVerb
- AFXCTL/COleControl::OnDraw
- AFXCTL/COleControl::OnDrawMetafile
- AFXCTL/COleControl::OnEdit
- AFXCTL/COleControl::OnEnabledChanged
- AFXCTL/COleControl::OnEnumVerbs
- AFXCTL/COleControl::OnEventAdvise
- AFXCTL/COleControl::OnFontChanged
- AFXCTL/COleControl::OnForeColorChanged
- AFXCTL/COleControl::OnFreezeEvents
- AFXCTL/COleControl::OnGetColorSet
- AFXCTL/COleControl::OnGetControlInfo
- AFXCTL/COleControl::OnGetDisplayString
- AFXCTL/COleControl::OnGetInPlaceMenu
- AFXCTL/COleControl::OnGetNaturalExtent
- AFXCTL/COleControl::OnGetPredefinedStrings
- AFXCTL/COleControl::OnGetPredefinedValue
- AFXCTL/COleControl::OnGetViewExtent
- AFXCTL/COleControl::OnGetViewRect
- AFXCTL/COleControl::OnGetViewStatus
- AFXCTL/COleControl::OnHideToolBars
- AFXCTL/COleControl::OnInactiveMouseMove
- AFXCTL/COleControl::OnInactiveSetCursor
- AFXCTL/COleControl::OnKeyDownEvent
- AFXCTL/COleControl::OnKeyPressEvent
- AFXCTL/COleControl::OnKeyUpEvent
- AFXCTL/COleControl::OnMapPropertyToPage
- AFXCTL/COleControl::OnMnemonic
- AFXCTL/COleControl::OnProperties
- AFXCTL/COleControl::OnQueryHitPoint
- AFXCTL/COleControl::OnQueryHitRect
- AFXCTL/COleControl::OnRenderData
- AFXCTL/COleControl::OnRenderFileData
- AFXCTL/COleControl::OnRenderGlobalData
- AFXCTL/COleControl::OnResetState
- AFXCTL/COleControl::OnSetClientSite
- AFXCTL/COleControl::OnSetData
- AFXCTL/COleControl::OnSetExtent
- AFXCTL/COleControl::OnSetObjectRects
- AFXCTL/COleControl::OnShowToolBars
- AFXCTL/COleControl::OnTextChanged
- AFXCTL/COleControl::OnWindowlessMessage
- AFXCTL/COleControl::ParentToClient
- AFXCTL/COleControl::PostModalDialog
- AFXCTL/COleControl::PreModalDialog
- AFXCTL/COleControl::RecreateControlWindow
- AFXCTL/COleControl::Refresh
- AFXCTL/COleControl::ReleaseCapture
- AFXCTL/COleControl::ReleaseDC
- AFXCTL/COleControl::ReparentControlWindow
- AFXCTL/COleControl::ResetStockProps
- AFXCTL/COleControl::ResetVersion
- AFXCTL/COleControl::ScrollWindow
- AFXCTL/COleControl::SelectFontObject
- AFXCTL/COleControl::SelectStockFont
- AFXCTL/COleControl::SerializeExtent
- AFXCTL/COleControl::SerializeStockProps
- AFXCTL/COleControl::SerializeVersion
- AFXCTL/COleControl::SetAppearance
- AFXCTL/COleControl::SetBackColor
- AFXCTL/COleControl::SetBorderStyle
- AFXCTL/COleControl::SetCapture
- AFXCTL/COleControl::SetControlSize
- AFXCTL/COleControl::SetEnabled
- AFXCTL/COleControl::SetFocus
- AFXCTL/COleControl::SetFont
- AFXCTL/COleControl::SetForeColor
- AFXCTL/COleControl::SetInitialSize
- AFXCTL/COleControl::SetModifiedFlag
- AFXCTL/COleControl::SetNotPermitted
- AFXCTL/COleControl::SetNotSupported
- AFXCTL/COleControl::SetRectInContainer
- AFXCTL/COleControl::SetText
- AFXCTL/COleControl::ThrowError
- AFXCTL/COleControl::TransformCoords
- AFXCTL/COleControl::TranslateColor
- AFXCTL/COleControl::WillAmbientsBeValidDuringLoad
- AFXCTL/COleControl::WindowProc
- AFXCTL/COleControl::DrawContent
- AFXCTL/COleControl::DrawMetafile
- AFXCTL/COleControl::IsInvokeAllowed
- AFXCTL/COleControl::SetInitialDataFormats
helpviewer_keywords:
- COleControl [MFC], COleControl
- COleControl [MFC], AmbientAppearance
- COleControl [MFC], AmbientBackColor
- COleControl [MFC], AmbientDisplayName
- COleControl [MFC], AmbientFont
- COleControl [MFC], AmbientForeColor
- COleControl [MFC], AmbientLocaleID
- COleControl [MFC], AmbientScaleUnits
- COleControl [MFC], AmbientShowGrabHandles
- COleControl [MFC], AmbientShowHatching
- COleControl [MFC], AmbientTextAlign
- COleControl [MFC], AmbientUIDead
- COleControl [MFC], AmbientUserMode
- COleControl [MFC], BoundPropertyChanged
- COleControl [MFC], BoundPropertyRequestEdit
- COleControl [MFC], ClientToParent
- COleControl [MFC], ClipCaretRect
- COleControl [MFC], ControlInfoChanged
- COleControl [MFC], DisplayError
- COleControl [MFC], DoClick
- COleControl [MFC], DoPropExchange
- COleControl [MFC], DoSuperclassPaint
- COleControl [MFC], EnableSimpleFrame
- COleControl [MFC], ExchangeExtent
- COleControl [MFC], ExchangeStockProps
- COleControl [MFC], ExchangeVersion
- COleControl [MFC], FireClick
- COleControl [MFC], FireDblClick
- COleControl [MFC], FireError
- COleControl [MFC], FireEvent
- COleControl [MFC], FireKeyDown
- COleControl [MFC], FireKeyPress
- COleControl [MFC], FireKeyUp
- COleControl [MFC], FireMouseDown
- COleControl [MFC], FireMouseMove
- COleControl [MFC], FireMouseUp
- COleControl [MFC], FireReadyStateChange
- COleControl [MFC], GetActivationPolicy
- COleControl [MFC], GetAmbientProperty
- COleControl [MFC], GetAppearance
- COleControl [MFC], GetBackColor
- COleControl [MFC], GetBorderStyle
- COleControl [MFC], GetCapture
- COleControl [MFC], GetClassID
- COleControl [MFC], GetClientOffset
- COleControl [MFC], GetClientRect
- COleControl [MFC], GetClientSite
- COleControl [MFC], GetControlFlags
- COleControl [MFC], GetControlSize
- COleControl [MFC], GetDC
- COleControl [MFC], GetEnabled
- COleControl [MFC], GetExtendedControl
- COleControl [MFC], GetFocus
- COleControl [MFC], GetFont
- COleControl [MFC], GetFontTextMetrics
- COleControl [MFC], GetForeColor
- COleControl [MFC], GetHwnd
- COleControl [MFC], GetMessageString
- COleControl [MFC], GetNotSupported
- COleControl [MFC], GetReadyState
- COleControl [MFC], GetRectInContainer
- COleControl [MFC], GetStockTextMetrics
- COleControl [MFC], GetText
- COleControl [MFC], GetWindowlessDropTarget
- COleControl [MFC], InitializeIIDs
- COleControl [MFC], InternalGetFont
- COleControl [MFC], InternalGetText
- COleControl [MFC], InternalSetReadyState
- COleControl [MFC], InvalidateControl
- COleControl [MFC], InvalidateRgn
- COleControl [MFC], IsConvertingVBX
- COleControl [MFC], IsModified
- COleControl [MFC], IsOptimizedDraw
- COleControl [MFC], IsSubclassedControl
- COleControl [MFC], Load
- COleControl [MFC], LockInPlaceActive
- COleControl [MFC], OnAmbientPropertyChange
- COleControl [MFC], OnAppearanceChanged
- COleControl [MFC], OnBackColorChanged
- COleControl [MFC], OnBorderStyleChanged
- COleControl [MFC], OnClick
- COleControl [MFC], OnClose
- COleControl [MFC], OnDoVerb
- COleControl [MFC], OnDraw
- COleControl [MFC], OnDrawMetafile
- COleControl [MFC], OnEdit
- COleControl [MFC], OnEnabledChanged
- COleControl [MFC], OnEnumVerbs
- COleControl [MFC], OnEventAdvise
- COleControl [MFC], OnFontChanged
- COleControl [MFC], OnForeColorChanged
- COleControl [MFC], OnFreezeEvents
- COleControl [MFC], OnGetColorSet
- COleControl [MFC], OnGetControlInfo
- COleControl [MFC], OnGetDisplayString
- COleControl [MFC], OnGetInPlaceMenu
- COleControl [MFC], OnGetNaturalExtent
- COleControl [MFC], OnGetPredefinedStrings
- COleControl [MFC], OnGetPredefinedValue
- COleControl [MFC], OnGetViewExtent
- COleControl [MFC], OnGetViewRect
- COleControl [MFC], OnGetViewStatus
- COleControl [MFC], OnHideToolBars
- COleControl [MFC], OnInactiveMouseMove
- COleControl [MFC], OnInactiveSetCursor
- COleControl [MFC], OnKeyDownEvent
- COleControl [MFC], OnKeyPressEvent
- COleControl [MFC], OnKeyUpEvent
- COleControl [MFC], OnMapPropertyToPage
- COleControl [MFC], OnMnemonic
- COleControl [MFC], OnProperties
- COleControl [MFC], OnQueryHitPoint
- COleControl [MFC], OnQueryHitRect
- COleControl [MFC], OnRenderData
- COleControl [MFC], OnRenderFileData
- COleControl [MFC], OnRenderGlobalData
- COleControl [MFC], OnResetState
- COleControl [MFC], OnSetClientSite
- COleControl [MFC], OnSetData
- COleControl [MFC], OnSetExtent
- COleControl [MFC], OnSetObjectRects
- COleControl [MFC], OnShowToolBars
- COleControl [MFC], OnTextChanged
- COleControl [MFC], OnWindowlessMessage
- COleControl [MFC], ParentToClient
- COleControl [MFC], PostModalDialog
- COleControl [MFC], PreModalDialog
- COleControl [MFC], RecreateControlWindow
- COleControl [MFC], Refresh
- COleControl [MFC], ReleaseCapture
- COleControl [MFC], ReleaseDC
- COleControl [MFC], ReparentControlWindow
- COleControl [MFC], ResetStockProps
- COleControl [MFC], ResetVersion
- COleControl [MFC], ScrollWindow
- COleControl [MFC], SelectFontObject
- COleControl [MFC], SelectStockFont
- COleControl [MFC], SerializeExtent
- COleControl [MFC], SerializeStockProps
- COleControl [MFC], SerializeVersion
- COleControl [MFC], SetAppearance
- COleControl [MFC], SetBackColor
- COleControl [MFC], SetBorderStyle
- COleControl [MFC], SetCapture
- COleControl [MFC], SetControlSize
- COleControl [MFC], SetEnabled
- COleControl [MFC], SetFocus
- COleControl [MFC], SetFont
- COleControl [MFC], SetForeColor
- COleControl [MFC], SetInitialSize
- COleControl [MFC], SetModifiedFlag
- COleControl [MFC], SetNotPermitted
- COleControl [MFC], SetNotSupported
- COleControl [MFC], SetRectInContainer
- COleControl [MFC], SetText
- COleControl [MFC], ThrowError
- COleControl [MFC], TransformCoords
- COleControl [MFC], TranslateColor
- COleControl [MFC], WillAmbientsBeValidDuringLoad
- COleControl [MFC], WindowProc
- COleControl [MFC], DrawContent
- COleControl [MFC], DrawMetafile
- COleControl [MFC], IsInvokeAllowed
- COleControl [MFC], SetInitialDataFormats
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
ms.openlocfilehash: 97c605426ed0ac869714f0f83d4957f7f6ce7d87
ms.sourcegitcommit: 180f63704f6ddd07a4172a93b179cf0733fd952d
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 09/06/2019
ms.locfileid: "70741400"
---
# <a name="colecontrol-class"></a>COleControl-Klasse

Eine leistungsstarke Basisklasse zum Entwickeln von OLE-Steuerelementen.

## <a name="syntax"></a>Syntax

```
class COleControl : public CWnd
```

## <a name="members"></a>Member

### <a name="public-constructors"></a>Öffentliche Konstruktoren

|Name|Beschreibung|
|----------|-----------------|
|[COleControl::COleControl](#colecontrol)|Erstellt ein `COleControl`-Objekt.|

### <a name="public-methods"></a>Öffentliche Methoden

|Name|Beschreibung|
|----------|-----------------|
|[COleControl::AmbientAppearance](#ambientappearance)|Ruft die aktuelle Darstellung des-Steuer Elements ab.|
|[COleControl::AmbientBackColor](#ambientbackcolor)|Gibt den Wert der ambient-BackColor-Eigenschaft zurück.|
|[COleControl::AmbientDisplayName](#ambientdisplayname)|Gibt den Namen des Steuer Elements zurück, wie vom Container angegeben.|
|[COleControl::AmbientFont](#ambientfont)|Gibt den Wert der ambient-Schriftart Eigenschaft zurück.|
|[COleControl::AmbientForeColor](#ambientforecolor)|Gibt den Wert der Ambient-ForeColor-Eigenschaft zurück.|
|[COleControl::AmbientLocaleID](#ambientlocaleid)|Gibt die Gebiets Schema-ID des Containers zurück.|
|[COleControl::AmbientScaleUnits](#ambientscaleunits)|Gibt den Typ der Einheiten zurück, die vom Container verwendet werden.|
|[COleControl::AmbientShowGrabHandles](#ambientshowgrabhandles)|Bestimmt, ob Zieh Punkte angezeigt werden sollen.|
|[COleControl::AmbientShowHatching](#ambientshowhatching)|Bestimmt, ob die Schraffur angezeigt werden soll.|
|[COleControl::AmbientTextAlign](#ambienttextalign)|Gibt den Typ der vom Container angegebenen Textausrichtung zurück.|
|[COleControl::AmbientUIDead](#ambientuidead)|Bestimmt, ob das Steuerelement auf Aktionen der Benutzeroberfläche reagieren soll.|
|[COleControl::AmbientUserMode](#ambientusermode)|Bestimmt den Modus des Containers.|
|[COleControl::BoundPropertyChanged](#boundpropertychanged)|Benachrichtigt den Container, dass eine gebundene Eigenschaft geändert wurde.|
|[COleControl::BoundPropertyRequestEdit](#boundpropertyrequestedit)|Fordert die Berechtigung zum Bearbeiten des Eigenschafts Werts an.|
|[COleControl::ClientToParent](#clienttoparent)|Übersetzt einen Punkt relativ zum Ursprung des-Steuer Elements in einen Punkt relativ zum Ursprungs des Containers.|
|[COleControl::ClipCaretRect](#clipcaretrect)|Passt ein Caretzeichen an, wenn es von einem-Steuerelement überlappen wird.|
|[COleControl::ControlInfoChanged](#controlinfochanged)|Diese Funktion wird aufgerufen, nachdem sich der vom-Steuerelement behandelte mnetmonics-Satz geändert hat.|
|[COleControl::DisplayError](#displayerror)|Zeigt die Fehlerereignisse des Steuer Elements an.|
|[COleControl::DoClick](#doclick)|Implementierung der Stock `DoClick` -Methode.|
|[COleControl::DoPropExchange](#dopropexchange)|Serialisiert die Eigenschaften eines `COleControl` -Objekts.|
|[COleControl::DoSuperclassPaint](#dosuperclasspaint)|Zeichnet ein OLE-Steuerelement, das von einem Windows-Steuerelement untergeordnet wurde, neu.|
|[COleControl::EnableSimpleFrame](#enablesimpleframe)|Ermöglicht die einfache Frame Unterstützung für ein Steuerelement.|
|[COleControl::ExchangeExtent](#exchangeextent)|Serialisiert die Breite und Höhe des Steuer Elements.|
|[COleControl::ExchangeStockProps](#exchangestockprops)|Serialisiert die Eigenschaften des Steuer Elements.|
|[COleControl::ExchangeVersion](#exchangeversion)|Serialisiert die Versionsnummer des Steuer Elements.|
|[COleControl::FireClick](#fireclick)|Löst das Aktien `Click` Ereignis aus.|
|[COleControl::FireDblClick](#firedblclick)|Löst das Aktien `DblClick` Ereignis aus.|
|[COleControl::FireError](#fireerror)|Löst das Aktien `Error` Ereignis aus.|
|[COleControl::FireEvent](#fireevent)|Löst ein benutzerdefiniertes Ereignis aus.|
|[COleControl::FireKeyDown](#firekeydown)|Löst das Aktien `KeyDown` Ereignis aus.|
|[COleControl::FireKeyPress](#firekeypress)|Löst das Aktien `KeyPress` Ereignis aus.|
|[COleControl::FireKeyUp](#firekeyup)|Löst das Aktien `KeyUp` Ereignis aus.|
|[COleControl::FireMouseDown](#firemousedown)|Löst das Aktien `MouseDown` Ereignis aus.|
|[COleControl::FireMouseMove](#firemousemove)|Löst das Aktien `MouseMove` Ereignis aus.|
|[COleControl::FireMouseUp](#firemouseup)|Löst das Aktien `MouseUp` Ereignis aus.|
|[COleControl::FireReadyStateChange](#firereadystatechange)|Löst ein Ereignis aus, wenn der bereit Zustand des-Steuer Elements geändert wird.|
|[COleControl::GetActivationPolicy](#getactivationpolicy)|Ändert das Standard Aktivierungs Verhalten eines Steuer Elements, das die `IPointerInactive` -Schnittstelle unterstützt.|
|[COleControl::GetAmbientProperty](#getambientproperty)|Gibt den Wert der angegebenen Ambient-Eigenschaft zurück.|
|[COleControl::GetAppearance](#getappearance)|Gibt den Wert der Eigenschaft für die Bestands Darstellung zurück.|
|[COleControl::GetBackColor](#getbackcolor)|Gibt den Wert der Eigenschaft "Stock BackColor" zurück.|
|[COleControl::GetBorderStyle](#getborderstyle)|Gibt den Wert der Stock BorderStyle-Eigenschaft zurück.|
|[COleControl::GetCapture](#getcapture)|Bestimmt, ob ein fensterloses, aktiviertes Steuerelement Objekt über die Maus Aufzeichnung verfügt.|
|[COleControl::GetClassID](#getclassid)|Ruft die OLE-Klassen-ID des Steuer Elements ab.|
|[COleControl::GetClientOffset](#getclientoffset)|Ruft den Unterschied zwischen der linken oberen Ecke des rechteckigen Bereichs des Steuer Elements und der oberen linken Ecke des Client Bereichs ab.|
|[COleControl::GetClientRect](#getclientrect)|Ruft die Größe des Client Bereichs des Steuer Elements ab.|
|[COleControl::GetClientSite](#getclientsite)|Fragt ein Objekt für den Zeiger auf die aktuelle Client Site in seinem Container ab.|
|[COleControl::GetControlFlags](#getcontrolflags)|Ruft die Steuerelement-Flag-Einstellungen ab.|
|[COleControl::GetControlSize](#getcontrolsize)|Gibt die Position und die Größe des OLE-Steuer Elements zurück.|
|[COleControl::GetDC](#getdc)|Bietet eine Möglichkeit für ein fensterloses Steuerelement, um einen Gerätekontext aus dem Container zu erhalten.|
|[COleControl::GetEnabled](#getenabled)|Gibt den Wert der Eigenschaft "Stock aktiviert" zurück.|
|[COleControl::GetExtendedControl](#getextendedcontrol)|Ruft einen Zeiger auf ein erweitertes Steuerelement Objekt ab, das zum Container gehört.|
|[COleControl::GetFocus](#getfocus)|Bestimmt, ob das Steuerelement den Fokus besitzt.|
|[COleControl::GetFont](#getfont)|Gibt den Wert der Eigenschaft "Stock Font" zurück.|
|[COleControl::GetFontTextMetrics](#getfonttextmetrics)|Gibt die Metriken eines `CFontHolder` -Objekts zurück.|
|[COleControl::GetForeColor](#getforecolor)|Gibt den Wert der Stock ForeColor-Eigenschaft zurück.|
|[COleControl::GetHwnd](#gethwnd)|Gibt den Wert der Stock-hWnd-Eigenschaft zurück.|
|[COleControl::GetMessageString](#getmessagestring)|Stellt Status leisten Text für ein Menü Element bereit.|
|[COleControl::GetNotSupported](#getnotsupported)|Verhindert den Zugriff auf den Eigenschafts Wert eines Steuer Elements durch den Benutzer.|
|[COleControl::GetReadyState](#getreadystate)|Gibt den Bereitschafts Zustand des-Steuer Elements zurück.|
|[COleControl::GetRectInContainer](#getrectincontainer)|Gibt das Rechteck des Steuer Elements relativ zu seinem Container zurück.|
|[COleControl::GetStockTextMetrics](#getstocktextmetrics)|Gibt die Metriken der Eigenschaft "Stock Font" zurück.|
|[COleControl::GetText](#gettext)|Gibt den Wert der Eigenschaft "Stock Text" oder "Caption" zurück.|
|[COleControl::GetWindowlessDropTarget](#getwindowlessdroptarget)|Überschreiben, um ein fensterloses Steuerelement als Ziel von Drag & Drop-Vorgängen zu ermöglichen.|
|[COleControl::InitializeIIDs](#initializeiids)|Informiert die Basisklasse der IIDs, die vom Steuerelement verwendet werden.|
|[COleControl::InternalGetFont](#internalgetfont)|Gibt ein `CFontHolder` -Objekt für die Eigenschaft "Stock Font" zurück.|
|[COleControl::InternalGetText](#internalgettext)|Ruft die Eigenschaft "Stock Caption" oder "Text" ab.|
|[COleControl::InternalSetReadyState](#internalsetreadystate)|Legt den Bereitschafts Zustand des-Steuer Elements fest und löst das Ready-State-Change-Ereignis aus.|
|[COleControl::InvalidateControl](#invalidatecontrol)|Erklärt einen Bereich des angezeigten Steuer Elements für ungültig und bewirkt, dass es neu gezeichnet wird.|
|[COleControl::InvalidateRgn](#invalidatergn)|Macht den Client Bereich des Container Fensters innerhalb der angegebenen Region ungültig. Kann verwendet werden, um fensterlose Steuerelemente im Bereich neu zu zeichnen.|
|[COleControl::IsConvertingVBX](#isconvertingvbx)|Ermöglicht das spezialisierte Laden eines OLE-Steuer Elements.|
|[COleControl::IsModified](#ismodified)|Bestimmt, ob sich der Zustand des Steuer Elements geändert hat.|
|[COleControl::IsOptimizedDraw](#isoptimizeddraw)|Gibt an, ob der Container optimierte Zeichnung für den aktuellen Zeichnungs Vorgang unterstützt.|
|[COleControl::IsSubclassedControl](#issubclassedcontrol)|Wird aufgerufen, um zu bestimmen, ob das Steuerelement ein Windows-Steuerelement Unterklassen|
|[COleControl::Load](#load)|Setzt alle vorherigen asynchronen Daten zurück und initiiert eine neue Last der asynchronen Eigenschaft des Steuer Elements.|
|[COleControl::LockInPlaceActive](#lockinplaceactive)|Bestimmt, ob das Steuerelement durch den Container deaktiviert werden kann.|
|[COleControl::OnAmbientPropertyChange](#onambientpropertychange)|Wird aufgerufen, wenn eine Ambient-Eigenschaft geändert wird.|
|[COleControl::OnAppearanceChanged](#onappearancechanged)|Wird aufgerufen, wenn die Eigenschaft für die Bestands Darstellung geändert wird.|
|[COleControl::OnBackColorChanged](#onbackcolorchanged)|Wird aufgerufen, wenn die Eigenschaft "Stock BackColor" geändert wird.|
|[COleControl::OnBorderStyleChanged](#onborderstylechanged)|Wird aufgerufen, wenn die Eigenschaft "Stock BorderStyle" geändert wird.|
|[COleControl::OnClick](#onclick)|Wird aufgerufen, um das Aktien Klick Ereignis auszulösen.|
|[COleControl::OnClose](#onclose)|Benachrichtigt das Steuerelement, `IOleControl::Close` das aufgerufen wurde.|
|[COleControl::OnDoVerb](#ondoverb)|Wird aufgerufen, nachdem ein Steuerelement Verb ausgeführt wurde.|
|[COleControl::OnDraw](#ondraw)|Wird aufgerufen, wenn ein Steuerelement aufgefordert wird, sich selbst neu zu zeichnen.|
|[COleControl::OnDrawMetafile](#ondrawmetafile)|Wird vom Container aufgerufen, wenn ein Steuerelement aufgefordert wird, sich selbst mithilfe eines Metadatei-Geräte Kontexts neu zu zeichnen.|
|[COleControl::OnEdit](#onedit)|Wird vom Container aufgerufen, um ein OLE-Steuerelement zu aktivieren.|
|[COleControl::OnEnabledChanged](#onenabledchanged)|Wird aufgerufen, wenn die Eigenschaft für die Aktien Aktivierung geändert wird.|
|[COleControl::OnEnumVerbs](#onenumverbs)|Wird vom Container aufgerufen, um Verben eines Steuer Elements aufzuzählen.|
|[COleControl::OnEventAdvise](#oneventadvise)|Wird aufgerufen, wenn Ereignishandler von einem Steuerelement verbunden oder getrennt werden.|
|[COleControl::OnFontChanged](#onfontchanged)|Wird aufgerufen, wenn die Eigenschaft "Stock Font" geändert wird.|
|[COleControl::OnForeColorChanged](#onforecolorchanged)|Wird aufgerufen, wenn die Stock ForeColor-Eigenschaft geändert wird.|
|[COleControl::OnFreezeEvents](#onfreezeevents)|Wird aufgerufen, wenn die Ereignisse eines Steuer Elements eingefroren oder nicht fixiert werden.|
|[COleControl::OnGetColorSet](#ongetcolorset)|Benachrichtigt das Steuerelement, `IOleObject::GetColorSet` das aufgerufen wurde.|
|[COleControl::OnGetControlInfo](#ongetcontrolinfo)|Stellt mnetmonische Informationen für den Container bereit.|
|[COleControl::OnGetDisplayString](#ongetdisplaystring)|Wird aufgerufen, um eine Zeichenfolge abzurufen, die einen Eigenschafts Wert darstellt.|
|[COleControl::OnGetInPlaceMenu](#ongetinplacemenu)|Fordert das Handle für das Menü des Steuer Elements an, das mit dem Container Menü zusammengeführt wird.|
|[COleControl::OnGetNaturalExtent](#ongetnaturalextent)|Überschreiben, um die Anzeige Größe des Steuer Elements abzurufen, die der vorgeschlagenen Größe und dem Block Modus am nächsten liegt.|
|[COleControl::OnGetPredefinedStrings](#ongetpredefinedstrings)|Gibt Zeichen folgen zurück, die mögliche Werte für eine Eigenschaft darstellen.|
|[COleControl::OnGetPredefinedValue](#ongetpredefinedvalue)|Gibt den Wert zurück, der einer vordefinierten Zeichenfolge entspricht.|
|[COleControl::OnGetViewExtent](#ongetviewextent)|Überschreiben, um die Größe der Anzeige Bereiche des Steuer Elements abzurufen (kann verwendet werden, um die zwei-Pass-Zeichnung zu aktivieren).|
|[COleControl::OnGetViewRect](#ongetviewrect)|Überschreiben, um die Größe des Steuer Elements in ein Rechteck zu konvertieren, beginnend an einer bestimmten Position.|
|[COleControl::OnGetViewStatus](#ongetviewstatus)|Überschreiben, um den Ansichts Status des Steuer Elements abzurufen.|
|[COleControl::OnHideToolBars](#onhidetoolbars)|Wird vom Container aufgerufen, wenn das Steuerelement die Benutzeroberfläche deaktiviert ist.|
|[COleControl::OnInactiveMouseMove](#oninactivemousemove)|Überschreiben, damit der Container für das inaktive Steuerelement unter dem Mauszeiger WM_MOUSEMOVE-Nachrichten an das Steuerelement weitergibt.|
|[COleControl::OnInactiveSetCursor](#oninactivesetcursor)|Überschreiben, damit der Container für das inaktive Steuerelement unter dem Mauszeiger WM_SETCURSOR-Nachrichten an das Steuerelement weitergibt.|
|[COleControl::OnKeyDownEvent](#onkeydownevent)|Wird aufgerufen, nachdem das Aktien KeyDown-Ereignis ausgelöst wurde.|
|[COleControl::OnKeyPressEvent](#onkeypressevent)|Wird aufgerufen, nachdem das Stock KeyPress-Ereignis ausgelöst wurde.|
|[COleControl::OnKeyUpEvent](#onkeyupevent)|Wird aufgerufen, nachdem das Aktien KeyUp-Ereignis ausgelöst wurde.|
|[COleControl::OnMapPropertyToPage](#onmappropertytopage)|Gibt an, welche Eigenschaften Seite zum Bearbeiten einer Eigenschaft verwendet werden soll.|
|[COleControl::OnMnemonic](#onmnemonic)|Wird aufgerufen, wenn ein mnetmonisches Schlüssel des Steuer Elements gedrückt wurde.|
|[COleControl::OnProperties](#onproperties)|Wird aufgerufen, wenn das "Properties"-Verb des Steuer Elements aufgerufen wurde.|
|[COleControl::OnQueryHitPoint](#onqueryhitpoint)|Überschreiben, um abzufragen, ob die Anzeige eines Steuer Elements einen bestimmten Punkt überlappt.|
|[COleControl::OnQueryHitRect](#onqueryhitrect)|Überschreiben, um abzufragen, ob die Anzeige eines Steuer Elements einen beliebigen Punkt in einem angegebenen Rechteck überlappt.|
|[COleControl::OnRenderData](#onrenderdata)|Wird von Framework aufgerufen, um Daten im angegebenen Format abzurufen.|
|[COleControl::OnRenderFileData](#onrenderfiledata)|Wird von Framework aufgerufen, um Daten aus einer Datei im angegebenen Format abzurufen.|
|[COleControl::OnRenderGlobalData](#onrenderglobaldata)|Wird von Framework aufgerufen, um Daten im angegebenen Format aus dem globalen Speicher abzurufen.|
|[COleControl::OnResetState](#onresetstate)|Setzt die Eigenschaften eines Steuer Elements auf die Standardwerte zurück.|
|[COleControl::OnSetClientSite](#onsetclientsite)|Benachrichtigt das Steuerelement, `IOleControl::SetClientSite` das aufgerufen wurde.|
|[COleControl::OnSetData](#onsetdata)|Ersetzt die Daten des Steuer Elements durch einen anderen Wert.|
|[COleControl::OnSetExtent](#onsetextent)|Wird aufgerufen, nachdem sich der Bereich des-Steuer Elements geändert hat.|
|[COleControl::OnSetObjectRects](#onsetobjectrects)|Wird aufgerufen, nachdem die Abmessungen des Steuer Elements geändert wurden.|
|[COleControl::OnShowToolBars](#onshowtoolbars)|Wird aufgerufen, wenn das Steuerelement für die Benutzeroberfläche aktiviert wurde.|
|[COleControl::OnTextChanged](#ontextchanged)|Wird aufgerufen, wenn die Eigenschaft Stock Text oder Caption geändert wird.|
|[COleControl::OnWindowlessMessage](#onwindowlessmessage)|Verarbeitet Fenster Meldungen (mit Ausnahme von Maus-und Tastatur Meldungen) für fensterlose Steuerelemente.|
|[COleControl::ParentToClient](#parenttoclient)|Übersetzt einen Punkt relativ zum Ursprung des Containers zu einem Punkt relativ zum Ursprungs des-Steuer Elements.|
|[COleControl::PostModalDialog](#postmodaldialog)|Benachrichtigt den Container, dass ein modales Dialogfeld geschlossen wurde.|
|[COleControl::PreModalDialog](#premodaldialog)|Benachrichtigt den Container, dass ein modales Dialogfeld angezeigt wird.|
|[COleControl::RecreateControlWindow](#recreatecontrolwindow)|Zerstört und erstellt das Fenster des Steuer Elements erneut.|
|[COleControl::Refresh](#refresh)|Erzwingt das Neuzeichnen der Darstellung eines Steuer Elements.|
|[COleControl::ReleaseCapture](#releasecapture)|Gibt die Maus Aufzeichnung frei.|
|[COleControl::ReleaseDC](#releasedc)|Gibt den Anzeigegeräte Kontext eines Containers eines fensterlosen Steuer Elements frei.|
|[COleControl::ReparentControlWindow](#reparentcontrolwindow)|Setzt das übergeordnete Element des Steuerelement Fensters zurück.|
|[COleControl::ResetStockProps](#resetstockprops)|Initialisiert `COleControl` die vordefinierten Eigenschaften mit ihren Standardwerten.|
|[COleControl::ResetVersion](#resetversion)|Initialisiert die Versionsnummer mit einem angegebenen Wert.|
|[COleControl::ScrollWindow](#scrollwindow)|Ermöglicht einem fensterlosen Steuerelement einen Bildlauf in einem Bereich innerhalb seines direkt aktiven Bilds auf der Anzeige.|
|[COleControl::SelectFontObject](#selectfontobject)|Wählt eine benutzerdefinierte Schriftart Eigenschaft in einen Gerätekontext aus.|
|[COleControl::SelectStockFont](#selectstockfont)|Wählt die Eigenschaft "Stock Font" in einen Gerätekontext aus.|
|[COleControl::SerializeExtent](#serializeextent)|Serialisiert oder initialisiert den Anzeigebereich für das Steuerelement.|
|[COleControl::SerializeStockProps](#serializestockprops)|Serialisiert oder initialisiert die `COleControl` vordefinierten Eigenschaften.|
|[COleControl::SerializeVersion](#serializeversion)|Serialisiert oder initialisiert die Versionsinformationen des-Steuer Elements.|
|[COleControl::SetAppearance](#setappearance)|Legt den Wert der Eigenschaft für die Bestands Darstellung fest.|
|[COleControl::SetBackColor](#setbackcolor)|Legt den Wert der Eigenschaft Stock BackColor fest.|
|[COleControl::SetBorderStyle](#setborderstyle)|Legt den Wert der Eigenschaft "Stock BorderStyle" fest.|
|[COleControl::SetCapture](#setcapture)|Bewirkt, dass das Containerfenster des Steuer Elements im Namen des Steuer Elements die Maus Aufzeichnung übernimmt.|
|[COleControl::SetControlSize](#setcontrolsize)|Legt die Position und die Größe des OLE-Steuer Elements fest.|
|[COleControl::SetEnabled](#setenabled)|Legt den Wert der Eigenschaft "Stock aktiviert" fest.|
|[COleControl::SetFocus](#setfocus)|Bewirkt, dass das Containerfenster des Steuer Elements den Eingabefokus auf den Namen des Steuer Elements übernimmt.|
|[COleControl::SetFont](#setfont)|Legt den Wert der Eigenschaft "Stock Font" fest.|
|[COleControl::SetForeColor](#setforecolor)|Legt den Wert der Stock ForeColor-Eigenschaft fest.|
|[COleControl::SetInitialSize](#setinitialsize)|Legt die Größe eines OLE-Steuer Elements fest, wenn das erste Element in einem Container angezeigt wird.|
|[COleControl::SetModifiedFlag](#setmodifiedflag)|Ändert den geänderten Zustand eines-Steuer Elements.|
|[COleControl::SetNotPermitted](#setnotpermitted)|Gibt an, dass eine Bearbeitungs Anforderung fehlgeschlagen ist.|
|[COleControl::SetNotSupported](#setnotsupported)|Verhindert die Änderung des Eigenschafts Werts eines Steuer Elements durch den Benutzer.|
|[COleControl::SetRectInContainer](#setrectincontainer)|Legt das Rechteck des Steuer Elements relativ zu seinem Container fest.|
|[COleControl::SetText](#settext)|Legt den Wert der Eigenschaft "Stock Text" oder "Caption" fest.|
|[COleControl::ThrowError](#throwerror)|Signalisiert, dass ein Fehler in einem OLE-Steuerelement aufgetreten ist.|
|[COleControl::TransformCoords](#transformcoords)|Wandelt Koordinaten Werte zwischen einem Container und dem Steuerelement um.|
|[COleControl::TranslateColor](#translatecolor)|Konvertiert einen OLE_COLOR-Wert in einen COLORREF-Wert.|
|[COleControl::WillAmbientsBeValidDuringLoad](#willambientsbevalidduringload)|Bestimmt, ob Ambient-Eigenschaften verfügbar sind, wenn das Steuerelement das nächste Mal geladen wird.|
|[COleControl::WindowProc](#windowproc)|Stellt eine Windows-Prozedur für `COleControl` ein-Objekt bereit.|

### <a name="protected-methods"></a>Geschützte Methoden

|Name|Beschreibung|
|----------|-----------------|
|[COleControl::DrawContent](#drawcontent)|Wird von Framework aufgerufen, wenn die Darstellung des Steuer Elements aktualisiert werden muss.|
|[COleControl::DrawMetafile](#drawmetafile)|Wird von Framework aufgerufen, wenn der Metadatei-Gerätekontext verwendet wird.|
|[COleControl::IsInvokeAllowed](#isinvokeallowed)|Aktiviert den Aufruf der Automatisierungs Methode.|
|[COleControl::SetInitialDataFormats](#setinitialdataformats)|Wird von Framework aufgerufen, um die Liste der Datenformate zu initialisieren, die vom-Steuerelement unterstützt werden.|

## <a name="remarks"></a>Hinweise

Diese Klasse `CWnd`wird von abgeleitet und erbt die gesamte Funktionalität eines Windows-Fenster Objekts sowie zusätzliche Funktionen, die für OLE spezifisch sind, z. b. das Auslösen von Ereignissen und die Möglichkeit zur Unterstützung von Methoden und Eigenschaften.

OLE-Steuerelemente können in OLE-Container Anwendungen eingefügt werden und mit dem Container kommunizieren, indem ein bidirektionales System des Ereignisses zum Auslösen und verfügbar machen von Methoden und Eigenschaften für den Container verwendet wird. Beachten Sie, dass OLE-Standardcontainer nur die Grundfunktionen eines OLE-Steuer Elements unterstützen. Die erweiterten Funktionen eines OLE-Steuer Elements können nicht unterstützt werden. Das Auslösen von Ereignissen tritt auf, wenn Ereignisse als Folge bestimmter Aktionen im Steuerelement an den Container gesendet werden. Der Container kommuniziert wiederum mit dem Steuerelement, indem er einen verfügbar gemachten Satz von Methoden und Eigenschaften analog zu den Element Funktionen und Datenmembern C++ einer Klasse verwendet. Dieser Ansatz ermöglicht es dem Entwickler, die Darstellung des Steuer Elements zu steuern und den Container zu benachrichtigen, wenn bestimmte Aktionen stattfinden.

## <a name="windowless-controls"></a>Fensterlose Steuerelemente

OLE-Steuerelemente können direkt ohne ein Fenster verwendet werden. Fensterlose Steuerelemente haben bedeutende Vorteile:

- Fensterlose Steuerelemente können transparent und nicht rechteckig sein.

- Fensterlose Steuerelemente reduzieren die instanzgröße und die Erstellungszeit des Objekts.

Steuerelemente benötigen kein Fenster. Dienste, die von einem Fenster angeboten werden, können problemlos über ein einzelnes frei gegebenes Fenster (normalerweise den Container) und einen Teil des dispatchcodes bereitgestellt werden. Ein Fenster ist größtenteils eine unnötige Komplikation für das Objekt.

Wenn die Fensterlose Aktivierung verwendet wird, ist der Container (der über ein Fenster verfügt) für die Bereitstellung von Diensten zuständig, die andernfalls vom eigenen Fenster des Steuer Elements bereitgestellt worden wären. Wenn beispielsweise das Steuerelement den Tastaturfokus Abfragen, die Maus Aufzeichnung Abfragen oder einen Gerätekontext abrufen muss, werden diese Vorgänge vom Container verwaltet. Die `COleControl` Member-Funktionen mit Windowless-Operation rufen diese Vorgänge für den Container auf.

Wenn die Fensterlose Aktivierung aktiviert ist, delegiert der Container Eingabe Nachrichten an die- `IOleInPlaceObjectWindowless` Schnittstelle des Steuer Elements (eine Erweiterung von [IOleInPlaceObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject) für die Unterstützung von Windows less). `COleControl`die Implementierung dieser Schnittstelle versendet diese Nachrichten über die Meldungs Zuordnung Ihres Steuer Elements, nachdem die Maus Koordinaten entsprechend angepasst wurden. Diese Nachrichten können wie normale Fenster Meldungen verarbeitet werden, indem der Meldungs Zuordnung die entsprechenden Einträge hinzugefügt werden.

In einem fensterlosen Steuerelement sollten Sie immer die `COleControl` -Member-Funktionen anstelle der entsprechenden `CWnd` Element Funktionen oder der zugehörigen Windows-API-Funktionen verwenden.

OLE-Steuerungs Objekte können auch nur dann ein Fenster erstellen, wenn Sie aktiv werden, aber der erforderliche Arbeitsaufwand für den aktiv/aktiv-Übergang steigt und die Geschwindigkeit des Übergangs sinkt. Es gibt Fälle, in denen es sich um ein Problem handelt, z. b. ein Raster von Textfeldern. Wenn Sie in der Spalte ein-und herunterskalieren, muss jedes Steuerelement direkt aktiviert und anschließend deaktiviert werden. Die Geschwindigkeit des inaktiven/aktiven Übergangs wirkt sich direkt auf die Scrollgeschwindigkeit aus.

Weitere Informationen zum Entwickeln eines OLE-Steuerelement-Frameworks finden Sie in den Artikeln [MFC-ActiveX](../../mfc/mfc-activex-controls.md) -Steuerelemente und [Übersicht: Erstellen eines MFC-ActiveX-](../../mfc/reference/mfc-activex-control-wizard.md)Steuerelement Programms Weitere Informationen zum Optimieren von OLE-Steuerelementen, einschließlich fensterloser und Flimmer freier Steuerelemente [, finden Sie unter MFC-ActiveX-Steuerelemente: Optimierung](../../mfc/mfc-activex-controls-optimization.md).

## <a name="inheritance-hierarchy"></a>Vererbungshierarchie

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`COleControl`

## <a name="requirements"></a>Anforderungen

**Header:** afxctl.h

##  <a name="ambientbackcolor"></a>COleControl:: ambientbackcolor

Gibt den Wert der ambient-BackColor-Eigenschaft zurück.

```
OLE_COLOR AmbientBackColor();
```

### <a name="return-value"></a>Rückgabewert

Der aktuelle Wert der ambient-BackColor-Eigenschaft des Containers, sofern vorhanden. Wenn die Eigenschaft nicht unterstützt wird, gibt diese Funktion die vom System definierte Windows-Hintergrundfarbe zurück.

### <a name="remarks"></a>Hinweise

Die ambient BackColor-Eigenschaft ist für alle Steuerelemente verfügbar und wird durch den Container definiert. Beachten Sie, dass der Container diese Eigenschaft nicht unterstützen muss.

##  <a name="ambientdisplayname"></a>COleControl:: ambientdisplayname

Der Name, den der Container dem Steuerelement zugewiesen hat, kann in den Fehlermeldungen verwendet werden, die dem Benutzer angezeigt werden.

```
CString AmbientDisplayName();
```

### <a name="return-value"></a>Rückgabewert

Der Name des OLE-Steuer Elements. Der Standardwert ist eine Zeichenfolge der Länge 0 (null).

### <a name="remarks"></a>Hinweise

Beachten Sie, dass der Container diese Eigenschaft nicht unterstützen muss.

##  <a name="ambientfont"></a>COleControl:: ambientfont

Gibt den Wert der ambient-Schriftart Eigenschaft zurück.

```
LPFONTDISP AmbientFont();
```

### <a name="return-value"></a>Rückgabewert

Ein Zeiger auf die Ambient-Schriftart Dispatch-Schnittstelle des Containers. Der Standardwert ist NULL. Wenn die Rückgabe nicht gleich NULL ist, sind Sie verantwortlich für das Freigeben der Schriftart durch Aufrufen der [IUnknown:: Release](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) -Member-Funktion.

### <a name="remarks"></a>Hinweise

Die Eigenschaft Ambient Font wird durch den Container definiert und ist für alle Steuerelemente verfügbar. Beachten Sie, dass der Container diese Eigenschaft nicht unterstützen muss.

##  <a name="ambientforecolor"></a>COleControl:: ambientforecolor

Gibt den Wert der Ambient-ForeColor-Eigenschaft zurück.

```
OLE_COLOR AmbientForeColor();
```

### <a name="return-value"></a>Rückgabewert

Der aktuelle Wert der Ambient-ForeColor-Eigenschaft des Containers, sofern vorhanden. Wenn dies nicht unterstützt wird, gibt diese Funktion die vom System definierte Windows-Textfarbe zurück.

### <a name="remarks"></a>Hinweise

Die Ambient-ForeColor-Eigenschaft ist für alle Steuerelemente verfügbar und wird durch den Container definiert. Beachten Sie, dass der Container diese Eigenschaft nicht unterstützen muss.

##  <a name="ambientlocaleid"></a>COleControl:: AmbientLocaleID

Gibt die Gebiets Schema-ID des Containers zurück.

```
LCID AmbientLocaleID();
```

### <a name="return-value"></a>Rückgabewert

Der Wert der LocaleID-Eigenschaft des Containers, sofern vorhanden. Wenn diese Eigenschaft nicht unterstützt wird, gibt diese Funktion 0 zurück.

### <a name="remarks"></a>Hinweise

Das Steuerelement kann die LocaleID verwenden, um die Benutzeroberfläche für bestimmte Gebiets Schemas anzupassen. Beachten Sie, dass der Container diese Eigenschaft nicht unterstützen muss.

##  <a name="ambientappearance"></a>COleControl:: ambientappearance

Ruft die aktuelle Darstellungs Einstellung für das Steuerelement Objekt ab.

```
short AmbientAppearance();
```

### <a name="return-value"></a>Rückgabewert

Das Aussehen des Steuer Elements:

- **0** flache Darstellung

- **1** 3D-Darstellung

### <a name="remarks"></a>Hinweise

Rufen Sie diese Funktion auf, um den aktuellen Wert der DISPID_AMBIENT_APPEARANCE-Eigenschaft für das Steuerelement abzurufen.

##  <a name="ambientscaleunits"></a>COleControl:: ambientscaleunits

Gibt den Typ der Einheiten zurück, die vom Container verwendet werden.

```
CString AmbientScaleUnits();
```

### <a name="return-value"></a>Rückgabewert

Eine Zeichenfolge, die die Ambiente-Skalierungs Einheiten des Containers enthält. Wenn diese Eigenschaft nicht unterstützt wird, gibt diese Funktion eine Zeichenfolge der Länge 0 (null) zurück.

### <a name="remarks"></a>Hinweise

Die Ambient scaleunits-Eigenschaft des Containers kann zum Anzeigen von Positionen oder Dimensionen verwendet werden, die mit der ausgewählten Einheit bezeichnet werden, z. b. Twips oder cm. Beachten Sie, dass der Container diese Eigenschaft nicht unterstützen muss.

##  <a name="ambientshowgrabhandles"></a>COleControl:: ambientshowgrabhandles

Bestimmt, ob der Container dem Steuerelement ermöglicht, Zieh Punkte für sich selbst anzuzeigen, wenn es aktiv ist.

```
BOOL AmbientShowGrabHandles();
```

### <a name="return-value"></a>Rückgabewert

Ungleich 0 (null), wenn Zieh Punkte angezeigt werden sollen. andernfalls 0. Wird diese Eigenschaft nicht unterstützt, gibt diese Funktion einen Wert ungleich 0 (null) zurück.

### <a name="remarks"></a>Hinweise

Beachten Sie, dass der Container diese Eigenschaft nicht unterstützen muss.

##  <a name="ambientshowhatching"></a>COleControl:: ambientshowhatching

Bestimmt, ob der Container dem Steuerelement ermöglicht, sich selbst mit einem Schraffurmuster anzuzeigen, wenn die Benutzeroberfläche aktiv

```
BOOL AmbientShowHatching();
```

### <a name="return-value"></a>Rückgabewert

Ungleich 0 (null), wenn das ausgelöste Muster angezeigt werden soll. andernfalls 0. Wird diese Eigenschaft nicht unterstützt, gibt diese Funktion einen Wert ungleich 0 (null) zurück.

### <a name="remarks"></a>Hinweise

Beachten Sie, dass der Container diese Eigenschaft nicht unterstützen muss.

##  <a name="ambienttextalign"></a>COleControl:: ambienttextalign

Bestimmt die Umgebungs Textausrichtung, die vom Steuerelement Container bevorzugt wird.

```
short AmbientTextAlign();
```

### <a name="return-value"></a>Rückgabewert

Der Status der Ambient-TextAlign-Eigenschaft des Containers. Wenn diese Eigenschaft nicht unterstützt wird, gibt diese Funktion 0 zurück.

Im folgenden finden Sie eine Liste gültiger Rückgabewerte:

|Rückgabewert|Bedeutung|
|------------------|-------------|
|0|Allgemeine Ausrichtung (Zahlen auf der rechten Seite, Text auf der linken Seite).|
|1|Linksbündig|
|2|Center|
|3|Rechtsbündig|

### <a name="remarks"></a>Hinweise

Diese Eigenschaft ist für alle eingebetteten Steuerelemente verfügbar und wird durch den Container definiert. Beachten Sie, dass der Container diese Eigenschaft nicht unterstützen muss.

##  <a name="ambientuidead"></a>COleControl:: ambientuidead

Bestimmt, ob der Container das Steuerelement auf Aktionen der Benutzeroberfläche reagieren soll.

```
BOOL AmbientUIDead();
```

### <a name="return-value"></a>Rückgabewert

Ungleich 0 (null), wenn das Steuerelement auf Benutzeroberflächen Aktionen reagieren soll. andernfalls 0. Wenn diese Eigenschaft nicht unterstützt wird, gibt diese Funktion 0 zurück.

### <a name="remarks"></a>Hinweise

Beispielsweise kann ein Container dies im Entwurfs Modus auf "true" festlegen.

##  <a name="ambientusermode"></a>COleControl:: ambientusermode

Bestimmt, ob sich der Container im Entwurfs Modus oder im Benutzermodus befindet.

```
BOOL AmbientUserMode();
```

### <a name="return-value"></a>Rückgabewert

Ungleich 0 (null), wenn sich der Container im Benutzermodus befindet. andernfalls 0 (im Entwurfs Modus). Wenn diese Eigenschaft nicht unterstützt wird, gibt diese Funktion "true" zurück.

### <a name="remarks"></a>Hinweise

Beispielsweise kann ein Container im Entwurfs Modus auf false festlegen.

##  <a name="boundpropertychanged"></a>COleControl:: BoundPropertyChanged

Signalisiert, dass sich der gebundene Eigenschafts Wert geändert hat.

```
void BoundPropertyChanged(DISPID dispid);
```

### <a name="parameters"></a>Parameter

*dispid*<br/>
Die Dispatch-ID einer gebundenen Eigenschaft des Steuer Elements.

### <a name="remarks"></a>Hinweise

Dies muss jedes Mal aufgerufen werden, wenn sich der Wert der-Eigenschaft ändert, auch in Fällen, in denen die Änderung nicht durch die-Eigenschaften Satz Methode erfolgt ist. Beachten Sie insbesondere gebundene Eigenschaften, die Element Variablen zugeordnet sind. Jedes Mal, wenn eine solche Element Variable `BoundPropertyChanged` geändert wird, muss aufgerufen werden.

##  <a name="boundpropertyrequestedit"></a>COleControl:: BoundPropertyRequestEdit

Fordert die Berechtigung von `IPropertyNotifySink` der-Schnittstelle zum Ändern eines gebundenen Eigenschafts Werts, der vom-Steuerelement bereitgestellt

```
BOOL BoundPropertyRequestEdit(DISPID dispid);
```

### <a name="parameters"></a>Parameter

*dispid*<br/>
Die Dispatch-ID einer gebundenen Eigenschaft des Steuer Elements.

### <a name="return-value"></a>Rückgabewert

Ungleich 0 (null), wenn die Änderung zulässig ist. andernfalls 0. Der Standardwert ist ungleich 0 (null).

### <a name="remarks"></a>Hinweise

Wenn die Berechtigung verweigert wird, darf das Steuerelement den Wert der-Eigenschaft nicht ändern. Dies kann erreicht werden, indem die Aktion, die versucht hat, den Eigenschafts Wert zu ändern, ignoriert oder fehlerhaft ist

##  <a name="clienttoparent"></a>COleControl:: clienttoparent

Übersetzt die Koordinaten von *PPoint* in übergeordnete Koordinaten.

```
virtual void ClientToParent(
    LPCRECT lprcBounds,
    LPPOINT pPoint) const;
```

### <a name="parameters"></a>Parameter

*lprcBounds*<br/>
Ein Zeiger auf die Begrenzungen des OLE-Steuer Elements innerhalb des Containers. Nicht der Client Bereich, sondern der Bereich des gesamten Steuer Elements, einschließlich Rahmen und Bild Lauf leisten.

*pPoint*<br/>
Zeiger auf den OLE-Client Bereichs Punkt, der in die Koordinaten des übergeordneten Elements (Container) übersetzt werden soll.

### <a name="remarks"></a>Hinweise

Auf dem Eingabe- *PPoint* ist relativ zum Ursprung des Client Bereichs des OLE-Steuer Elements (obere linke Ecke des Client Bereichs des Steuer Elements). Auf dem Ausgabe- *PPoint* ist relativ zum Ursprung der übergeordneten (oberen linken Ecke des Containers).

##  <a name="clipcaretrect"></a>COleControl:: clipcaretrect

Passt ein Caretzeichen an, wenn es vollständig oder teilweise durch überlappende, nicht transparente Objekte abgedeckt wird.

```
BOOL ClipCaretRect(LPRECT lpRect);
```

### <a name="parameters"></a>Parameter

*lpRect*<br/>
Bei Eingabe ein Zeiger auf eine [Rect](/windows/win32/api/windef/ns-windef-rect) -Struktur, die den anzuzeigenden Einfügebereich enthält. Bei Ausgabe, der angepasste Einfügemarke oder NULL, wenn das Caretzeichen vollständig abgedeckt ist.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Hinweise

Ein Caretzeichen ist eine blinkende Linie, ein Block oder eine Bitmap, die in der Regel angibt, wo Text oder Grafiken eingefügt werden.

Ein fensterloses Objekt kann eine Einfügemarke nicht sicher anzeigen, ohne zuvor zu überprüfen, ob das Caretzeichen durch überlappende Objekte teilweise oder vollständig ausgeblendet ist Um dies zu ermöglichen, kann ein-Objekt verwenden `ClipCaretRect` , um die Anpassung des Caretzeichen (reduziert) zu ermöglichen, um sicherzustellen, dass es in den Ausschneide Bereich passt.

Objekte, die eine Einfügemarke erstellen, sollten das `ClipCaretRect` Caretzeichen an übermitteln und das angepasste Rechteck für die Einfügemarke verwenden. Wenn die Einfügemarke vollständig ausgeblendet ist, gibt diese Methode false zurück, und die Einfügemarke sollte in diesem Fall überhaupt nicht angezeigt werden.

##  <a name="colecontrol"></a>COleControl:: COleControl

Erstellt ein `COleControl`-Objekt.

```
COleControl();
```

### <a name="remarks"></a>Hinweise

Diese Funktion wird normalerweise nicht direkt aufgerufen. Stattdessen wird das OLE-Steuerelement normalerweise von seiner Klassenfactory erstellt.

##  <a name="controlinfochanged"></a>COleControl:: controlinfochanged

Diese Funktion wird aufgerufen, wenn der vom-Steuerelement unterstützte mnetmonics-Satz geändert wurde.

```
void ControlInfoChanged();
```

### <a name="remarks"></a>Hinweise

Beim Empfang dieser Benachrichtigung erhält der Container des Steuer Elements den neuen Satz von mnetmonics, indem er [IOleControl:: GetControlInfo](/windows/win32/api/ocidl/nf-ocidl-iolecontrol-getcontrolinfo)aufruft. Beachten Sie, dass der Container nicht auf diese Benachrichtigung reagieren muss.

##  <a name="displayerror"></a>COleControl::D isplayerror

Wird von Framework aufgerufen, nachdem das Aktien Fehler Ereignis behandelt wurde (es sei denn, der Ereignishandler hat die Anzeige des Fehlers unterdrückt).

```
virtual void DisplayError(
    SCODE scode,
    LPCTSTR lpszDescription,
    LPCTSTR lpszSource,
    LPCTSTR lpszHelpFile,
    UINT nHelpID);
```

### <a name="parameters"></a>Parameter

*scode*<br/>
Der Status Codewert, der gemeldet werden soll. Eine umfassende Liste der möglichen Codes finden Sie im Artikel [ActiveX-Steuerelemente: Erweiterte Themen](../../mfc/mfc-activex-controls-advanced-topics.md).

*lpszDescription*<br/>
Die Beschreibung des Fehlers, der gemeldet wird.

*lpszSource*<br/>
Der Name des Moduls, das den Fehler erzeugt (in der Regel der Name des OLE-Steuerungs Moduls).

*lpszHelpFile*<br/>
Der Name der Hilfedatei, die eine Beschreibung des Fehlers enthält.

*nHelpID*<br/>
Die Hilfe Kontext-ID des gemeldeten Fehlers.

### <a name="remarks"></a>Hinweise

Das Standardverhalten zeigt ein Meldungs Feld mit der Beschreibung des Fehlers an, der in *lpszdescription*enthalten ist.

Überschreiben Sie diese Funktion, um anzupassen, wie Fehler angezeigt werden.

##  <a name="doclick"></a>COleControl::D-oclick

Simuliert eine Maus Klick Aktion für das-Steuerelement.

```
void DoClick();
```

### <a name="remarks"></a>Hinweise

Die über schreibbare `COleControl::OnClick` Member-Funktion wird aufgerufen, und ein "Stock Click"-Ereignis wird ausgelöst, wenn das Steuerelement unterstützt wird.

Diese Funktion wird von der `COleControl` Basisklasse als Aktien Methode namens "DoClick" unterstützt. Weitere Informationen finden Sie im Artikel [ActiveX-Steuerelemente: -](../../mfc/mfc-activex-controls-methods.md)Methoden.

##  <a name="dopropexchange"></a>COleControl::D opropexchange

Wird vom Framework aufgerufen, wenn ein Steuerelement aus einer permanenten Speicher Darstellung, z. b. einem Stream oder einem Eigenschaften Satz, geladen oder gespeichert wird.

```
virtual void DoPropExchange(CPropExchange* pPX);
```

### <a name="parameters"></a>Parameter

*pPX*<br/>
Ein Zeiger auf ein `CPropExchange` -Objekt. Das Framework stellt dieses Objekt bereit, um den Kontext des Eigenschaften Austauschs einschließlich seiner Richtung einzurichten.

### <a name="remarks"></a>Hinweise

Diese Funktion führt normalerweise Aufrufe an die **PX_** -Funktions Familie aus, um bestimmte benutzerdefinierte Eigenschaften eines OLE-Steuer Elements zu laden oder zu speichern.

Wenn der Steuerelement-Assistent zum Erstellen des OLE-Steuerelement Projekts verwendet wurde, serialisiert die überschriebene Version dieser Funktion die von `COleControl` unterstützten Aktien Eigenschaften mit einem-Befehl der `COleControl::DoPropExchange`-Basisklassen Funktion. Wenn Sie dem OLE-Steuerelement benutzerdefinierte Eigenschaften hinzufügen, müssen Sie diese Funktion ändern, um die neuen Eigenschaften zu serialisieren. Weitere Informationen zur Serialisierung finden Sie im Artikel [ActiveX-Steuerelemente: Serialisieren](../../mfc/mfc-activex-controls-serializing.md).

##  <a name="dosuperclasspaint"></a>COleControl::D osuperclasspaint

Zeichnet ein OLE-Steuerelement, das von einem Windows-Steuerelement untergeordnet wurde, neu.

```
void DoSuperclassPaint(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>Parameter

*pDC*<br/>
Ein Zeiger auf den Gerätekontext des Steuerelement Containers.

*rcBounds*<br/>
Der Bereich, in dem das Steuerelement gezeichnet werden soll.

### <a name="remarks"></a>Hinweise

Diese Funktion wird aufgerufen, um das Zeichnen eines nicht aktiven OLE-Steuer Elements ordnungsgemäß zu behandeln. Diese Funktion sollte nur verwendet werden, wenn das OLE-Steuerelement ein Windows-Steuerelement Unterklassen und `OnDraw` in der-Funktion des Steuer Elements aufgerufen werden sollte.

Weitere Informationen zu dieser Funktion und zum Unterklassen eines Windows-Steuer Elements finden Sie im [Artikel ActiveX-Steuerelemente: Unterklassen eines Windows-Steuer](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md)Elements.

##  <a name="drawcontent"></a>COleControl::D rawcontent

Wird von Framework aufgerufen, wenn die Darstellung des Steuer Elements aktualisiert werden muss.

```
void DrawContent(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>Parameter

*pDC*<br/>
Zeiger auf den Gerätekontext.

*rc*<br/>
Rechteckiger Bereich, in dem gezeichnet werden soll.

### <a name="remarks"></a>Hinweise

Diese Funktion Ruft die über schreibbare `OnDraw` Funktion direkt auf.

##  <a name="drawmetafile"></a>COleControl::D rawmetafile

Wird von Framework aufgerufen, wenn der Metadatei-Gerätekontext verwendet wird.

```
void DrawMetafile(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>Parameter

*pDC*<br/>
Zeiger auf den Metadatei-Gerätekontext.

*rc*<br/>
Rechteckiger Bereich, in dem gezeichnet werden soll.

##  <a name="enablesimpleframe"></a>COleControl:: enablesimpleframe

Aktiviert das einfache Frame Merkmal für ein OLE-Steuerelement.

```
void EnableSimpleFrame();
```

### <a name="remarks"></a>Hinweise

Dieses Merkmal ermöglicht einem Steuerelement die Unterstützung der visuellen Kapselung anderer Steuerelemente, jedoch nicht der echten OLE-Kapselung Ein Beispiel wäre ein Gruppenfeld mit mehreren Steuerelementen in. Diese Steuerelemente sind nicht in OLE enthalten, Sie befinden sich jedoch im gleichen Gruppenfeld.

##  <a name="exchangeextent"></a>COleControl:: exchangeblock

Serialisiert oder initialisiert den Zustand des Steuerelement Bereichs (seiner Dimensionen in HIMETRIC-Einheiten).

```
BOOL ExchangeExtent(CPropExchange* pPX);
```

### <a name="parameters"></a>Parameter

*pPX*<br/>
Ein Zeiger auf ein [CPropExchange](../../mfc/reference/cpropexchange-class.md) -Objekt. Das Framework stellt dieses Objekt bereit, um den Kontext des Eigenschaften Austauschs einschließlich seiner Richtung einzurichten.

### <a name="return-value"></a>Rückgabewert

Ungleich 0 (null), wenn die Funktion erfolgreich war. andernfalls 0.

### <a name="remarks"></a>Hinweise

Diese Funktion wird normalerweise von der Standard Implementierung von `COleControl::DoPropExchange`aufgerufen.

##  <a name="exchangestockprops"></a>COleControl:: exchangestock-Eigenschaften

Serialisiert oder initialisiert den Zustand der vordefinierten Eigenschaften des Steuer Elements.

```
void ExchangeStockProps(CPropExchange* pPX);
```

### <a name="parameters"></a>Parameter

*pPX*<br/>
Ein Zeiger auf ein [CPropExchange](../../mfc/reference/cpropexchange-class.md) -Objekt. Das Framework stellt dieses Objekt bereit, um den Kontext des Eigenschaften Austauschs einschließlich seiner Richtung einzurichten.

### <a name="remarks"></a>Hinweise

Diese Funktion wird normalerweise von der Standard Implementierung von `COleControl::DoPropExchange`aufgerufen.

##  <a name="exchangeversion"></a>COleControl:: ExchangeVersion

Serialisiert oder initialisiert den Zustand der Versionsinformationen eines Steuer Elements.

```
BOOL ExchangeVersion(
    CPropExchange* pPX,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>Parameter

*pPX*<br/>
Ein Zeiger auf ein `CPropExchange` -Objekt. Das Framework stellt dieses Objekt bereit, um den Kontext des Eigenschaften Austauschs einschließlich seiner Richtung einzurichten.

*dwVersionDefault*<br/>
Die aktuelle Versionsnummer des Steuer Elements.

*bConvert*<br/>
Gibt an, ob persistente Daten in das aktuelle Format konvertiert werden sollen, wenn Sie gespeichert oder im gleichen Format verwaltet werden, das geladen wurde.

### <a name="return-value"></a>Rückgabewert

Die Funktion war erfolgreich. andernfalls 0.

### <a name="remarks"></a>Hinweise

In der Regel ist dies die erste Funktion, die von der außer Kraft `COleControl::DoPropExchange`Setzung eines Steuer Elements aufgerufen wird. Beim Laden liest diese Funktion die Versionsnummer der persistenten Daten und legt das Versions Attribut des [CPropExchange](../../mfc/reference/cpropexchange-class.md) -Objekts entsprechend fest. Beim Speichern schreibt diese Funktion die Versionsnummer der persistenten Daten.

Weitere Informationen zur Persistenz und Versionsverwaltung finden Sie im Artikel [ActiveX-Steuerelemente: Serialisieren](../../mfc/mfc-activex-controls-serializing.md).

##  <a name="fireclick"></a>COleControl:: freclick

Wird vom Framework aufgerufen, wenn auf einen aktiven Steuerelement geklickt wird.

```
void FireClick();
```

### <a name="remarks"></a>Hinweise

Wenn dieses Ereignis als benutzerdefiniertes Ereignis definiert ist, legen Sie fest, wann das Ereignis ausgelöst wird.

Damit ein Click-Ereignis automatisch ausgelöst wird, muss für die Ereignis Zuordnung des-Steuer Elements ein "Stock Click"-Ereignis definiert werden.

##  <a name="firedblclick"></a>COleControl:: firedblclick

Wird von Framework aufgerufen, wenn auf einen aktiven Steuerelement Doppel geklickt wird.

```
void FireDblClick();
```

### <a name="remarks"></a>Hinweise

Wenn dieses Ereignis als benutzerdefiniertes Ereignis definiert ist, legen Sie fest, wann das Ereignis ausgelöst wird.

Damit ein DblClick-Ereignis automatisch ausgelöst wird, muss für die Ereignis Zuordnung des-Steuer Elements ein "Stock DblClick"-Ereignis definiert werden.

##  <a name="fireerror"></a>COleControl:: FireError

Löst das Aktien Fehler Ereignis aus.

```
void FireError(
    SCODE scode,
    LPCTSTR lpszDescription,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>Parameter

*scode*<br/>
Der Status Codewert, der gemeldet werden soll. Eine umfassende Liste der möglichen Codes finden Sie im Artikel [ActiveX-Steuerelemente: Erweiterte Themen](../../mfc/mfc-activex-controls-advanced-topics.md).

*lpszDescription*<br/>
Die Beschreibung des Fehlers, der gemeldet wird.

*nHelpID*<br/>
Die Hilfe-ID des gemeldeten Fehlers.

### <a name="remarks"></a>Hinweise

Dieses Ereignis bietet eine Möglichkeit, an den entsprechenden Stellen im Code zu signalisieren, dass innerhalb Ihres Steuer Elements ein Fehler aufgetreten ist. Anders als bei anderen Aktien Ereignissen, wie z. b. Click oder moulemove, wird der Fehler nie vom Framework ausgelöst.

Um einen Fehler zu melden, der während einer Get-Funktion, einer Eigenschafts Satz Funktion oder einer Automatisierungs Methode auftritt, wenden Sie [COleControl:: ThrowError](#throwerror)an.

Die Implementierung des Aktien Fehler Ereignisses eines OLE-Steuer Elements verwendet einen SCODE-Wert. Wenn das Steuerelement dieses Ereignis verwendet und in Visual Basic 4,0 verwendet werden soll, erhalten Sie Fehler, da der SCODE-Wert in Visual Basic nicht unterstützt wird.

Um dieses Problem zu beheben, ändern Sie den SCODE-Parameter manuell in der des-Steuer Elements. ODL-Datei zu **Long**. Außerdem verursacht jedes benutzerdefinierte Ereignis, jede Methode oder Eigenschaft, die einen SCODE-Parameter verwendet, auch das gleiche Problem.

##  <a name="fireevent"></a>COleControl:: FireEvent

Löst ein benutzerdefiniertes Ereignis aus dem Steuerelement mit beliebig vielen optionalen Argumenten aus.

```
void AFX_CDECL FireEvent(
    DISPID dispid,
    BYTE* pbParams,
...);
```

### <a name="parameters"></a>Parameter

*dispid*<br/>
Die Dispatch-ID des auszulösenden Ereignisses.

*pbParams*<br/>
Ein Deskriptor für die Parametertypen des Ereignisses.

### <a name="remarks"></a>Hinweise

Normalerweise sollte diese Funktion nicht direkt aufgerufen werden. Stattdessen werden die Funktionen zum Auslösen von Ereignissen im Ereignis Zuordnungs Abschnitt der Klassen Deklaration Ihres Steuer Elements aufgerufen.

Das *pbparams* -Argument ist eine durch Leerzeichen getrennte Liste von **VTS_** . Einer oder mehrere dieser Werte, durch Leerzeichen (nicht Kommas) getrennt, gibt bzw. geben die Parameterliste der Funktion an. Folgende Werte sind möglich:

|Symbol|Parametertyp|
|------------|--------------------|
|VTS_COLOR|OLE_COLOR|
|VTS_FONT|`IFontDisp*`|
|VTS_HANDLE|HWND|
|VTS_PICTURE|`IPictureDisp*`|
|VTS_OPTEXCLUSIVE|OLE_OPTEXCLUSIVE*|
|VTS_TRISTATE|OLE_TRISTATE|
|VTS_XPOS_HIMETRIC|OLE_XPOS_HIMETRIC|
|VTS_YPOS_HIMETRIC|OLE_YPOS_HIMETRIC|
|VTS_XPOS_PIXELS|OLE_XPOS_PIXELS|
|VTS_YPOS_PIXELS|OLE_YPOS_PIXELS|
|VTS_XSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_YSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_XSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|
|VTS_YSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|

> [!NOTE]
>  Für alle Variant-Typen wurden zusätzliche Variant-Konstanten definiert, mit Ausnahme von VTS_FONT und VTS_PICTURE, die einen Zeiger auf die Variant-Daten Konstante bereitstellen. Diese Konstanten werden mithilfe der **VTS_P** `constantname` -Konvention benannt. Beispielsweise ist VTS_PCOLOR ein Zeiger auf eine VTS_COLOR-Konstante.

##  <a name="firekeydown"></a>COleControl:: firekeydown

Wird von Framework aufgerufen, wenn eine Taste gedrückt wird, während das Steuerelement aktiv ist.

```
void FireKeyDown(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>Parameter

*pnChar*<br/>
Zeiger auf den Wert des virtuellen Schlüsselcodes der gedrückten Taste. Eine Liste der virtuellen Standardschlüssel Codes finden Sie unter Winuser. h.

*nShiftState*<br/>
Enthält eine Kombination der folgenden Flags:

- SHIFT_MASK die UMSCHALTTASTE wurde während der Aktion gedrückt.

- CTRL_MASK die STRG-Taste wurde während der Aktion gedrückt.

- ALT_MASK die Alt-Taste wurde während der Aktion gedrückt.

### <a name="remarks"></a>Hinweise

Wenn dieses Ereignis als benutzerdefiniertes Ereignis definiert ist, legen Sie fest, wann das Ereignis ausgelöst wird.

Damit ein KeyDown-Ereignis automatisch ausgelöst wird, muss für die Ereignis Zuordnung des-Steuer Elements ein Aktien KeyDown-Ereignis definiert werden.

##  <a name="firekeypress"></a>COleControl:: firekeypress

Wird von Framework aufgerufen, wenn eine Taste gedrückt und freigegeben wird, während das benutzerdefinierte Steuerelement innerhalb des Containers aktiv ist.

```
void FireKeyPress(USHORT* pnChar);
```

### <a name="parameters"></a>Parameter

*pnChar*<br/>
Ein Zeiger auf den Zeichen Wert des gedrückten Schlüssels.

### <a name="remarks"></a>Hinweise

Wenn dieses Ereignis als benutzerdefiniertes Ereignis definiert ist, legen Sie fest, wann das Ereignis ausgelöst wird.

Der Empfänger des Ereignisses kann *pnchar*ändern, z. b. alle Kleinbuchstaben in Großbuchstaben konvertieren. Wenn Sie das geänderte Zeichen untersuchen möchten, über `OnKeyPressEvent`schreiben Sie.

Damit ein KeyPress-Ereignis automatisch ausgelöst wird, muss für die Ereignis Zuordnung des-Steuer Elements ein Stock KeyPress-Ereignis definiert werden.

##  <a name="firekeyup"></a>COleControl:: firekeyup

Wird von Framework aufgerufen, wenn eine Taste losgelassen wird, während das benutzerdefinierte Steuerelement im Container eine aktive Benutzeroberfläche ist.

```
void FireKeyUp(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>Parameter

*pnChar*<br/>
Zeiger auf den Wert des virtuellen Schlüsselcodes des freigegebenen Schlüssels. Eine Liste der virtuellen Standardschlüssel Codes finden Sie unter Winuser. h.

*nShiftState*<br/>
Enthält eine Kombination der folgenden Flags:

- SHIFT_MASK die UMSCHALTTASTE wurde während der Aktion gedrückt.

- CTRL_MASK die STRG-Taste wurde während der Aktion gedrückt.

- ALT_MASK die Alt-Taste wurde während der Aktion gedrückt.

### <a name="remarks"></a>Hinweise

Wenn dieses Ereignis als benutzerdefiniertes Ereignis definiert ist, legen Sie fest, wann das Ereignis ausgelöst wird.

Damit ein KeyUp-Ereignis automatisch ausgelöst wird, muss für die Ereignis Zuordnung des-Steuer Elements ein Aktien KeyUp-Ereignis definiert werden.

##  <a name="firemousedown"></a>COleControl:: firemouldown

Wird von Framework aufgerufen, wenn eine Maustaste über einem aktiven benutzerdefinierten Steuerelement gedrückt wird.

```
void FireMouseDown(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Parameter

*nButton*<br/>
Der numerische Wert der Maus Taste, auf die geklickt wird. Sie kann einen der folgenden Werte enthalten:

- LEFT_BUTTON die linke Maustaste wurde gedrückt.

- MIDDLE_BUTTON die mittlere Maustaste wurde gedrückt.

- RIGHT_BUTTON die Rechte Maustaste wurde gedrückt.

*nShiftState*<br/>
Enthält eine Kombination der folgenden Flags:

- SHIFT_MASK die UMSCHALTTASTE wurde während der Aktion gedrückt.

- CTRL_MASK die STRG-Taste wurde während der Aktion gedrückt.

- ALT_MASK die Alt-Taste wurde während der Aktion gedrückt.

*w*<br/>
Die x-Koordinate des Cursors, wenn eine Maustaste gedrückt wurde. Die Koordinate ist relativ zur linken oberen Ecke des Steuerelement Fensters.

*y*<br/>
Die y-Koordinate des Cursors, wenn eine Maustaste gedrückt wurde. Die Koordinate ist relativ zur linken oberen Ecke des Steuerelement Fensters.

### <a name="remarks"></a>Hinweise

Wenn dieses Ereignis als benutzerdefiniertes Ereignis definiert ist, legen Sie fest, wann das Ereignis ausgelöst wird.

Damit ein mousdown-Ereignis automatisch ausgelöst wird, muss für die Ereignis Zuordnung des-Steuer Elements ein Kurs-mousdown-Ereignis definiert werden.

##  <a name="firemousemove"></a>COleControl:: firemouanmove

Wird von Framework aufgerufen, wenn der Cursor über ein aktives benutzerdefiniertes Steuerelement bewegt wird.

```
void FireMouseMove(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Parameter

*nButton*<br/>
Der numerische Wert der Maustasten, die gedrückt werden. Enthält eine Kombination der folgenden Werte:

- LEFT_BUTTON die linke Maustaste wurde während der Aktion gedrückt.

- MIDDLE_BUTTON die mittlere Maustaste wurde während der Aktion gedrückt.

- RIGHT_BUTTON die Rechte Maustaste wurde während der Aktion gedrückt.

*nShiftState*<br/>
Enthält eine Kombination der folgenden Flags:

- SHIFT_MASK die UMSCHALTTASTE wurde während der Aktion gedrückt.

- CTRL_MASK die STRG-Taste wurde während der Aktion gedrückt.

- ALT_MASK die Alt-Taste wurde während der Aktion gedrückt.

*w*<br/>
Die x-Koordinate des Cursors. Die Koordinate ist relativ zur linken oberen Ecke des Steuerelement Fensters.

*y*<br/>
Die y-Koordinate des Cursors. Die Koordinate ist relativ zur linken oberen Ecke des Steuerelement Fensters.

### <a name="remarks"></a>Hinweise

Wenn dieses Ereignis als benutzerdefiniertes Ereignis definiert ist, legen Sie fest, wann das Ereignis ausgelöst wird.

Damit ein mousmove-Ereignis automatisch ausgelöst wird, muss für die Ereignis Zuordnung des-Steuer Elements ein Kurs-mousmove-Ereignis definiert werden.

##  <a name="firemouseup"></a>COleControl:: firemoueinup

Wird von Framework aufgerufen, wenn eine Maustaste über ein aktives benutzerdefiniertes Steuerelement losgelassen wird.

```
void FireMouseUp(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Parameter

*nButton*<br/>
Der numerische Wert der freigegebenen Maustaste. Sie kann einen der folgenden Werte aufweisen:

- LEFT_BUTTON die linke Maustaste wurde losgelassen.

- MIDDLE_BUTTON die mittlere Maustaste wurde losgelassen.

- RIGHT_BUTTON die Rechte Maustaste wurde losgelassen.

*nShiftState*<br/>
Enthält eine Kombination der folgenden Flags:

- SHIFT_MASK die UMSCHALTTASTE wurde während der Aktion gedrückt.

- CTRL_MASK die STRG-Taste wurde während der Aktion gedrückt.

- ALT_MASK die Alt-Taste wurde während der Aktion gedrückt.

*w*<br/>
Die x-Koordinate des Cursors, wenn eine Maustaste losgelassen wurde. Die Koordinate ist relativ zur linken oberen Ecke des Steuerelement Fensters.

*y*<br/>
Die y-Koordinate eines Cursors, wenn eine Maustaste losgelassen wurde. Die Koordinate ist relativ zur linken oberen Ecke des Steuerelement Fensters.

### <a name="remarks"></a>Hinweise

Wenn dieses Ereignis als benutzerdefiniertes Ereignis definiert ist, legen Sie fest, wann das Ereignis ausgelöst wird.

Damit ein mouberup-Ereignis automatisch ausgelöst wird, muss für die Ereignis Zuordnung des-Steuer Elements ein "Stock mousup"-Ereignis definiert werden.

##  <a name="firereadystatechange"></a>COleControl:: firereadystatechange

Löst ein Ereignis mit dem aktuellen Wert des Ready-Zustands des Steuer Elements aus.

```
void FireReadyStateChange();
```

### <a name="remarks"></a>Hinweise

Der Status "bereit" kann einer der folgenden Werte sein:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Standard Initialisierungs Status|
|READYSTATE_LOADING|Die Eigenschaften des Steuer Elements werden zurzeit geladen.|
|READYSTATE_LOADED|Das Steuerelement wurde initialisiert.|
|READYSTATE_INTERACTIVE|Das Steuerelement verfügt über genügend Daten, um interaktiv zu sein, aber nicht alle asynchronen Daten sind noch geladen.|
|READYSTATE_COMPLETE|Das Steuerelement verfügt über alle Daten.|

Verwenden Sie [getreadystate](#getreadystate) , um die aktuelle Bereitschaft des Steuer Elements zu bestimmen.

[Internalstreadystate](#internalsetreadystate) ändert den Status bereit in den angegebenen Wert und ruft `FireReadyStateChange`dann auf.

##  <a name="getactivationpolicy"></a>COleControl:: GetActivationPolicy

Ändert das Standard Aktivierungs Verhalten eines Steuer Elements, das die `IPointerInactive` -Schnittstelle unterstützt.

```
virtual DWORD GetActivationPolicy();
```

### <a name="return-value"></a>Rückgabewert

Eine Kombination von Flags aus der pointerinaktiven Enumeration. Mögliche Flags:

|||
|-|-|
|POINTERINACTIVE_ACTIVATEONENTRY|Das Objekt sollte direkt aktiviert sein, wenn der Mauszeiger während eines Verschiebungs Vorgangs bewegt wird.|
|POINTERINACTIVE_DEACTIVATEONLEAVE|Das Objekt sollte deaktiviert werden, wenn der Mauszeiger das Objekt während eines Verschiebungs Vorgangs verlässt.|
|POINTERINACTIVE_ACTIVATEONDRAG|Das Objekt sollte direkt aktiviert sein, wenn die Maus während eines Drag & Drop-Vorgangs darauf gezogen wird.|

### <a name="remarks"></a>Hinweise

Wenn die `IPointerInactive` Schnittstelle aktiviert ist, delegiert der Container WM_SETCURSOR-und WM_MOUSEMOVE-Nachrichten an ihn. `COleControl`die Implementierung dieser Schnittstelle versendet diese Nachrichten über die Meldungs Zuordnung Ihres Steuer Elements, nachdem die Maus Koordinaten entsprechend angepasst wurden.

Wenn der Container eine WM_SETCURSOR-oder WM_MOUSEMOVE-Nachricht mit dem Mauszeiger über ein inaktives `IPointerInactive`Objekt empfängt, das `GetActivationPolicy` unterstützt, sollte es für die-Schnittstelle aufzurufen und Flags von der pointerinaktiven Enumeration zurückgeben.

Diese Nachrichten können wie normale Fenster Meldungen verarbeitet werden, indem die entsprechenden Einträge der Meldungs Zuordnung hinzugefügt werden. Vermeiden Sie in ihren Handlern die Verwendung `m_hWnd` der Element Variablen (oder der Member-Funktionen, die diese verwenden), ohne zu überprüfen, ob der Wert nicht NULL ist.

Jedes Objekt, das mehr als den Maus Cursor festlegen und/oder ein MouseMove-Ereignis auslösen soll, z. b. besonderes visuelles Feedback geben sollte, sollte das POINTERINACTIVE_ACTIVATEONENTRY-Flag zurückgeben und das Feedback nur dann zeichnen, wenn es aktiv ist. Wenn das-Objekt dieses Flag zurückgibt, sollte der Container es direkt direkt aktivieren und dann die gleiche Nachricht weiterleiten, die den-Aufrufvorgang `GetActivationPolicy`ausgelöst hat.

Wenn die Flags POINTERINACTIVE_ACTIVATEONENTRY und POINTERINACTIVE_DEACTIVATEONLEAVE zurückgegeben werden, wird das Objekt nur aktiviert, wenn sich der Mauszeiger über dem Objekt befindet. Wenn nur das POINTERINACTIVE_ACTIVATEONENTRY-Flag zurückgegeben wird, wird das-Objekt nur einmal aktiviert, wenn der Mauszeiger zum ersten Mal in das-Objekt eintritt.

Möglicherweise möchten Sie auch ein inaktives Steuerelement als Ziel eines OLE-Drag & Drop-Vorgangs festlegen. Hierfür muss das Steuerelement aktiviert werden, wenn der Benutzer ein Objekt darüber zieht, damit das Fenster des Steuer Elements als Ablage Ziel registriert werden kann. Um die Aktivierung während eines Zieh Vorgangs zu bewirken, geben Sie das POINTERINACTIVE_ACTIVATEONDRAG-Flag zurück:

[!code-cpp[NVC_MFCAxCtl#1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]

Die von `GetActivationPolicy` kommunizierten Informationen dürfen nicht von einem Container zwischengespeichert werden. Stattdessen sollte diese Methode jedes Mal aufgerufen werden, wenn der Mauszeiger in ein inaktives Objekt eintritt.

Wenn ein inaktives Objekt keine direkte Aktivierung erfordert, wenn der Mauszeiger darauf wechselt, sollte der zugehörige Container nachfolgende WM_SETCURSOR-Nachrichten an dieses Objekt senden, indem er [oninactivesetcursor](#oninactivesetcursor) aufruft, solange der Mauszeiger über dem Objekt verbleibt.

Wenn Sie `IPointerInactive` die Schnittstelle aktivieren, bedeutet dies in der Regel, dass das Steuerelement die Maus Meldungen jederzeit verarbeiten soll. Um dieses Verhalten in einem Container zu erhalten, der die `IPointerInactive` -Schnittstelle nicht unterstützt, müssen Sie das Steuerelement immer aktivieren, wenn es sichtbar ist, was bedeutet, dass das Steuerelement das OLEMISC_ACTIVATEWHENVISIBLE-Flag unter den verschiedenen Flags aufweisen sollte. Sie können jedoch auch das OLEMISC_IGNOREACTIVATEWHENVISIBLE-Flag angeben, um zu verhindern, dass `IPointerInactive`dieses Flag in einem Container wirksam wird, der unterstützt.

[!code-cpp[NVC_MFCAxCtl#10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]

##  <a name="getambientproperty"></a>COleControl:: getAmbientProperty

Ruft den Wert einer Ambient-Eigenschaft des Containers ab.

```
BOOL GetAmbientProperty(
    DISPID dispid,
    VARTYPE vtProp,
    void* pvProp);
```

### <a name="parameters"></a>Parameter

*dwDispid*<br/>
Die Dispatch-ID der gewünschten Ambient-Eigenschaft.

*vtProp*<br/>
Ein Variant Type-Tag, das den Typ des Werts angibt, der in *pvprop*zurückgegeben werden soll.

*pvProp*<br/>
Ein Zeiger auf die Adresse der Variablen, die den Eigenschafts Wert oder Rückgabewert empfängt. Der tatsächliche Typ dieses Zeigers muss mit dem von *vtprop*angegebenen Typ identisch sein.

|vtProp|Typ von pvprop|
|------------|--------------------|
|VT_BOOL|`BOOL*`|
|VT_BSTR|`CString*`|
|VT_I2|`short*`|
|VT_I4|`long*`|
|VT_R4|`float*`|
|VT_R8|`double*`|
|VT_CY|`CY*`|
|VT_COLOR|`OLE_COLOR*`|
|VT_DISPATCH|`LPDISPATCH*`|
|VT_FONT|`LPFONTDISP*`|

### <a name="return-value"></a>Rückgabewert

Ungleich NULL, wenn die Ambient-Eigenschaft unterstützt wird. andernfalls 0.

### <a name="remarks"></a>Hinweise

Wenn Sie verwenden `GetAmbientProperty` , um die Eigenschaften für "Ambient Display Name" und "scaleunits" abzurufen, legen Sie *vtprop* auf `CString*`VT_BSTR und *pvprop* auf fest. Wenn Sie die Eigenschaft Ambient Font (Schriftart) abrufen, legen Sie *vtprop* auf VT_FONT und *pvprop* auf LPFONTDISP * fest.

Beachten Sie, dass Funktionen bereits für gängige Ambient-Eigenschaften, wie z. b. [ambientbackcolor](#ambientbackcolor) und [ambientfont](#ambientfont), bereitgestellt wurden.

##  <a name="getappearance"></a>COleControl:: getappearance

Implementiert die Get-Funktion der Stock-Darstellungs Eigenschaft Ihres Steuer Elements.

```
short GetAppearance ();
```

### <a name="return-value"></a>Rückgabewert

Der Rückgabewert gibt die aktuelle Darstellungs Einstellung als **kurzen** Wert (VT_I2) an, wenn erfolgreich. Dieser Wert ist 0 (null), wenn die Darstellung des Steuer Elements flach ist, und 1, wenn die Darstellung des Steuer Elements 3D ist.

##  <a name="getbackcolor"></a>COleControl:: GetBackColor

Implementiert die Get-Funktion der Stock BackColor-Eigenschaft Ihres Steuer Elements.

```
OLE_COLOR GetBackColor();
```

### <a name="return-value"></a>Rückgabewert

Der Rückgabewert gibt die aktuelle Hintergrundfarbe als OLE_COLOR-Wert an, wenn erfolgreich. Dieser Wert kann mit einem `TranslateColor`-Befehl in einen COLORREF-Wert übersetzt werden.

##  <a name="getborderstyle"></a>COleControl:: getborderstyle

Implementiert die Get-Funktion der Stock BorderStyle-Eigenschaft Ihres Steuer Elements.

```
short GetBorderStyle();
```

### <a name="return-value"></a>Rückgabewert

1, wenn das Steuerelement über einen normalen Rahmen verfügt. 0, wenn das Steuerelement keinen Rahmen hat.

##  <a name="getcapture"></a>COleControl:: GetCapture

Bestimmt, ob `COleControl` das Objekt über die Maus Aufzeichnung verfügt.

```
CWnd* GetCapture();
```

### <a name="return-value"></a>Rückgabewert

Wenn das Steuerelement aktiviert und Fenster frei ist, wird **dieses** zurückgegeben, wenn das Steuerelement derzeit über die Maus Aufzeichnung verfügt (wie durch den Container des Steuer Elements bestimmt), oder NULL, wenn es nicht über die Erfassung verfügt.

Andernfalls wird das `CWnd` -Objekt zurückgegeben, das die Maus Aufzeichnung hat `CWnd::GetCapture`(identisch mit).

### <a name="remarks"></a>Hinweise

Ein aktiviertes fensterloses Steuerelement empfängt die Maus Aufzeichnung, wenn [SetCapture](#setcapture) aufgerufen wird.

##  <a name="getclassid"></a>COleControl:: GetClassID

Wird von Framework aufgerufen, um die OLE-Klassen-ID des Steuer Elements abzurufen.

```
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;
```

### <a name="parameters"></a>Parameter

*pclsid*<br/>
Zeiger auf den Speicherort der Klassen-ID.

### <a name="return-value"></a>Rückgabewert

Ungleich 0 (null), wenn der-Vorgang nicht erfolgreich war. andernfalls 0.

### <a name="remarks"></a>Hinweise

Wird normalerweise von der [IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex)implementiert.

##  <a name="getclientoffset"></a>COleControl:: getclientoffset

Ruft den Unterschied zwischen der linken oberen Ecke des rechteckigen Bereichs des Steuer Elements und der oberen linken Ecke des Client Bereichs ab.

```
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;
```

### <a name="parameters"></a>Parameter

*pdxOffset*<br/>
Zeiger auf den horizontalen Offset des Client Bereichs des OLE-Steuer Elements.

*pdyOffset*<br/>
Zeiger auf den vertikalen Offset des Client Bereichs des OLE-Steuer Elements.

### <a name="remarks"></a>Hinweise

Das OLE-Steuerelement verfügt über einen rechteckigen Bereich in seinem Container. Der Client Bereich des Steuer Elements ist der Steuerbereich mit Ausnahme von Rahmen und Bild Lauf leisten. Der Offset, der `GetClientOffset` von abgerufen wird, ist der Unterschied zwischen der linken oberen Ecke des rechteckigen Bereichs des Steuer Elements und der oberen linken Ecke des Client Bereichs. Wenn das Steuerelement andere nicht-Client Elemente als die Standardrahmen und Bild Lauf leisten aufweist, überschreiben Sie diese Member-Funktion, um den Offset anzugeben.

##  <a name="getclientrect"></a>COleControl:: GetClientRect

Ruft die Größe des Client Bereichs des Steuer Elements ab.

```
virtual void GetClientRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>Parameter

*lpRect*<br/>
Ein Zeiger auf `RECT` eine-Struktur, die die Abmessungen des Client Bereichs des fensterlosen Steuer Elements enthält, d. h. die Größe des Steuer Elements minus Fensterrahmen, Rahmen, Scrollleisten usw. Der *lprect* -Parameter gibt die Größe des Client Rechtecks des Steuer Elements an, nicht seine Position.

##  <a name="getclientsite"></a>COleControl:: GetClientSite

Fragt ein Objekt für den Zeiger auf die aktuelle Client Site in seinem Container ab.

```
LPOLECLIENTSITE GetClientSite();
```

### <a name="return-value"></a>Rückgabewert

Ein Zeiger auf die aktuelle Client Site des-Steuer Elements in seinem Container.

### <a name="remarks"></a>Hinweise

Der zurückgegebene Zeiger verweist auf eine Instanz `IOleClientSite`von. Die `IOleClientSite` Schnittstelle, die von Containern implementiert wird, ist die Ansicht Ihres Kontexts des Objekts: wo Sie im Dokument verankert ist, wo Sie den Speicher, die Benutzeroberfläche und andere Ressourcen erhält.

##  <a name="getcontrolflags"></a>COleControl:: GetControlFlags

Ruft die Steuerelement-Flag-Einstellungen ab.

```
virtual DWORD GetControlFlags();
```

### <a name="return-value"></a>Rückgabewert

Eine ORed-Kombination der Flags in der ControlFlags-Enumeration:

```
enum ControlFlags {
    fastBeginPaint = 0x0001,
    clipPaintDC = 0x0002,
    pointerInactive = 0x0004,
    noFlickerActivate = 0x0008,
    windowlessActivate = 0x0010,
    canOptimizeDraw = 0x0020,
    };
```

### <a name="remarks"></a>Hinweise

Standardmäßig wird `GetControlFlags` zurück `fastBeginPaint | clipPaintDC`gegeben.

|||
|-|-|
|`fastBeginPaint`|Wenn festgelegt, verwendet eine BEGIN-Paint-Funktion, die auf OLE-Steuerelemente zugeschnitten ist, anstatt auf die [BeginPaint](/windows/win32/api/winuser/nf-winuser-beginpaint) -API (standardmäßig eingestellt).|
|`clipPaintDC`|Wenn diese Einstellung nicht festgelegt ist, wird `IntersectClipRect` der von `COleControl` vorgenommene-Befehl von deaktiviert und ein kleiner Geschwindigkeitsvorteil erzielt. Wenn Sie die Fensterlose Aktivierung verwenden, hat das Flag keine Auswirkung.|
|`pointerInactive`|Wenn festgelegt, stellt die Maus Interaktion bereit, während das Steuer `COleControl`Element inaktiv ist `IPointerInactive` , indem die Implementierung der-Schnittstelle aktiviert wird, die standardmäßig deaktiviert ist.|
|`noFlickerActivate`|Wenn diese Einstellung festgelegt ist, werden zusätzliche Zeichnungsvorgänge und das zugehörige visuelle Flimmern eliminiert. Verwenden Sie, wenn sich das Steuerelement in den inaktiven und aktiven Zuständen identisch zeichnet. Wenn Sie die Fensterlose Aktivierung verwenden, hat das Flag keine Auswirkung.|
|`windowlessActivate`|Gibt an, dass das Steuerelement die Fensterlose Aktivierung verwendet, sofern festgelegt.|
|`canOptimizeDraw`|Wenn festgelegt, wird angegeben, dass das Steuerelement eine optimierte Zeichnung durchführt, wenn der Container dies unterstützt.|

Weitere Informationen zu `GetControlFlags` und anderen Optimierungen von OLE-Steuerelementen finden [Sie unter ActiveX-Steuerelemente: Optimierung](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="getcontrolsize"></a>COleControl:: getcontrolsize

Ruft die Größe des OLE-Steuerelement Fensters ab.

```
void GetControlSize(
    int* pcx,
    int* pcy);
```

### <a name="parameters"></a>Parameter

*pcx*<br/>
Gibt die Breite des Steuer Elements in Pixel an.

*pcy*<br/>
Gibt die Höhe des Steuer Elements in Pixel an.

### <a name="remarks"></a>Hinweise

Beachten Sie, dass alle Koordinaten für Steuerelement Fenster relativ zur linken oberen Ecke des-Steuer Elements sind.

##  <a name="getdc"></a>COleControl:: GetDC

Stellt ein fensterloses Objekt bereit, um einen Bildschirm-(oder kompatiblen) Gerätekontext aus dem Container zu erhalten.

```
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```

### <a name="parameters"></a>Parameter

*lprcRect*<br/>
Ein Zeiger auf das Rechteck, das vom fensterlosen Steuerelement neu gezeichnet werden soll, in Client Koordinaten des Steuer Elements. NULL bezeichnet den Block des vollständigen Objekts.

*dwFlags*<br/>
Zeichnungs Attribute des Geräte Kontexts. Folgende Optionen sind verfügbar:

- OLEDC_NODRAW gibt an, dass das Objekt den Gerätekontext nicht verwendet, um eine Zeichnung auszuführen, sondern lediglich Informationen zum Anzeigegerät zu erhalten. Der Container sollte den DC des Fensters einfach ohne weitere Verarbeitung übergeben.

- OLEDC_PAINTBKGND fordert an, dass der Container den Hintergrund vor der Rückgabe des DC zeichnet. Ein Objekt sollte dieses Flag verwenden, wenn es einen DC anfordert, um einen Bereich mit transparentem Hintergrund neu zu zeichnen.

- OLEDC_OFFSCREEN informiert den Container, dass das Objekt in einer Offscreen-Bitmap dargestellt werden will, die dann auf den Bildschirm kopiert werden soll. Ein Objekt sollte dieses Flag verwenden, wenn der Zeichnungs Vorgang, den es ausführt, eine Menge Flimmern generiert. Der Container kann diese Anforderung nicht einhalten. Wenn dieses Flag jedoch nicht festgelegt ist, muss der Container einen auf dem Bildschirm-DC zurückgeben. Dadurch können-Objekte direkt Bildschirm Vorgänge ausführen, wie z. b. das Anzeigen einer Auswahl (über einen **Xor** -Vorgang).

### <a name="return-value"></a>Rückgabewert

Zeiger auf den Anzeigegeräte Kontext für den Container `CWnd` Client Bereich, wenn der Vorgang erfolgreich ist. andernfalls ist der Rückgabewert NULL. Der Anzeigegeräte Kontext kann in nachfolgenden GDI-Funktionen verwendet werden, um im Client Bereich des Container Fensters zu zeichnen.

### <a name="remarks"></a>Hinweise

Die [ReleaseDC](#releasedc) -Member-Funktion muss aufgerufen werden, um den Kontext nach dem Zeichnen freizugeben. Beim Aufrufen `GetDC`von übergeben-Objekte das Rechteck, das in ihren eigenen Client Koordinaten gezeichnet werden soll. `GetDC`übersetzt diese in Koordinaten des Container Client Bereichs. Das Objekt sollte kein gewünschtes Zeichen Rechteck anfordern, das größer als das eigene Client Bereichs Rechteck ist, dessen Größe mit [GetClientRect](#getclientrect)abgerufen werden kann. Dadurch wird verhindert, dass Objekte versehentlich gezeichnet werden, wenn Sie nicht an Sie gesendet werden.

##  <a name="getenabled"></a>COleControl:: GetEnabled

Implementiert die Get-Funktion der vordefinierten Eigenschaft des Steuer Elements.

```
BOOL GetEnabled();
```

### <a name="return-value"></a>Rückgabewert

Ungleich NULL, wenn das Steuerelement aktiviert ist. andernfalls 0.

##  <a name="getextendedcontrol"></a>COleControl:: getextendecodcontrol

Erhält einen Zeiger auf ein Objekt, das durch den Container verwaltet wird, der das Steuerelement mit einem erweiterten Satz von Eigenschaften darstellt.

```
LPDISPATCH GetExtendedControl();
```

### <a name="return-value"></a>Rückgabewert

Ein Zeiger auf das erweiterte Steuerelement Objekt des Containers. Wenn kein Objekt verfügbar ist, ist der Wert NULL.

Dieses Objekt kann über seine `IDispatch` -Schnittstelle manipuliert werden. Sie können auch verwenden `QueryInterface` , um andere vom-Objekt bereitgestellte Schnittstellen abzurufen. Das-Objekt ist jedoch nicht erforderlich, um einen bestimmten Satz von Schnittstellen zu unterstützen. Beachten Sie, dass die Portabilität Ihres Steuer Elements auf andere beliebige Container beschränkt ist, wenn Sie sich auf die spezifischen Funktionen des erweiterten Steuerungs Objekts eines Containers verlassen.

### <a name="remarks"></a>Hinweise

Die Funktion, die diese Funktion aufruft, ist dafür verantwortlich, den Zeiger freizugeben, wenn das Objekt beendet wird. Beachten Sie, dass der Container dieses Objekt nicht unterstützen muss.

##  <a name="getfocus"></a>COleControl:: GetFocus

Bestimmt, ob `COleControl` das Objekt den Fokus besitzt.

```
CWnd* GetFocus();
```

### <a name="return-value"></a>Rückgabewert

Wenn das Steuerelement aktiviert und Fenster frei ist, wird **dieses** zurückgegeben, wenn das Steuerelement derzeit über den Tastaturfokus verfügt (wie durch den Container des Steuer Elements bestimmt), oder NULL, wenn es nicht den Fokus besitzt.

Andernfalls wird das `CWnd` -Objekt zurückgegeben, das über den Fokus `CWnd::GetFocus`verfügt (identisch mit).

### <a name="remarks"></a>Hinweise

Ein aktiviertes fensterloses Steuerelement erhält den Fokus, wenn [SetFocus](#setfocus) aufgerufen wird.

##  <a name="getfont"></a>COleControl:: getFont

Implementiert die Get-Funktion der Stock Font-Eigenschaft.

```
LPFONTDISP GetFont();
```

### <a name="return-value"></a>Rückgabewert

Ein Zeiger auf die Schriftart Dispatchschnittstelle der vordefinierten Schriftart Eigenschaft des Steuer Elements.

### <a name="remarks"></a>Hinweise

Beachten Sie, dass der Aufrufer das Objekt nach dem Abschluss freigeben muss. Verwenden `InternalGetFont` Sie in der Implementierung des-Steuer Elements, um auf das Stock Font-Objekt des Steuer Elements zuzugreifen. Weitere Informationen zum Verwenden von Schriftarten in Ihrem Steuerelement finden Sie [im Artikel ActiveX-Steuerelemente: Verwenden von Schriftarten in einem](../../mfc/mfc-activex-controls-using-fonts.md)ActiveX-Steuerelement.

##  <a name="getfonttextmetrics"></a>COleControl:: getfonttextmetrics

Misst die textmetriken für `CFontHolder` jedes Objekt, das im Besitz des-Steuer Elements ist.

```
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>Parameter

*lptm*<br/>
Zeiger auf eine [TextMetric](/windows/win32/api/wingdi/ns-wingdi-textmetricw) -Struktur.

*fontHolder*<br/>
Verweis auf ein [cfontholder](../../mfc/reference/cfontholder-class.md) -Objekt.

### <a name="remarks"></a>Hinweise

Eine solche Schriftart kann mit der [COleControl:: selectfontobject](#selectfontobject) -Funktion ausgewählt werden. `GetFontTextMetrics`Initialisiert die Struktur `TEXTMETRIC` , auf die *lptm* zeigt, mit gültigen metrikinformationen über `fontHolder`die Schriftart, wenn erfolgreich, oder füllen Sie die Struktur mit Nullen aus, wenn dies nicht erfolgreich war. Sie sollten diese Funktion anstelle von [GetTextMetrics](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics) verwenden, wenn Sie das Steuerelement zeichnen, da Steuerelemente, wie z. b. ein eingebettetes OLE-Objekt, möglicherweise erforderlich sind, um sich in einer Metadatei

Die `TEXTMETRIC` Struktur für die Standard Schriftart wird aktualisiert, wenn die [selectfontobject](#selectfontobject) -Funktion aufgerufen wird. Sie sollten erst `GetFontTextMetrics` nach dem Auswählen der Eigenschaft "Stock Font" aufgerufen werden, um sicherzustellen, dass die bereitgestellten Informationen gültig sind.

##  <a name="getforecolor"></a>COleControl:: getForeColor

Implementiert die Get-Funktion der Stock ForeColor-Eigenschaft.

```
OLE_COLOR GetForeColor();
```

### <a name="return-value"></a>Rückgabewert

Der Rückgabewert gibt die aktuelle Vordergrundfarbe als OLE_COLOR-Wert an, wenn erfolgreich. Dieser Wert kann mit einem `TranslateColor`-Befehl in einen [COLORREF](/windows/win32/gdi/colorref) -Wert übersetzt werden.

##  <a name="gethwnd"></a>COleControl:: GetHwnd

Implementiert die Get-Funktion der Stock-hWnd-Eigenschaft.

```
OLE_HANDLE GetHwnd();
```

### <a name="return-value"></a>Rückgabewert

Das Fenster Handle des OLE-Steuer Elements, sofern vorhanden. andernfalls NULL.

##  <a name="getmessagestring"></a>COleControl:: GetMessageString

Wird von Framework aufgerufen, um eine kurze Zeichenfolge zu erhalten, die den Zweck des durch *NID*identifizierten Menü Elements beschreibt.

```
virtual void GetMessageString(
    UINT nID,
    CString& rMessage) const;
```

### <a name="parameters"></a>Parameter

*nID*<br/>
Eine Menü Element-ID.

*rmessage*<br/>
Ein Verweis auf ein [CString](../../atl-mfc-shared/reference/cstringt-class.md) -Objekt, über das eine Zeichenfolge zurückgegeben wird.

### <a name="remarks"></a>Hinweise

Dies kann verwendet werden, um eine Meldung zu erhalten, die in einer Statusleiste angezeigt wird, während das Menü Element hervorgehoben ist. Die Standard Implementierung versucht, eine durch *NID*identifizierte Zeichen folgen Ressource zu laden.

##  <a name="getnotsupported"></a>COleControl:: GetNotSupported

Verhindert den Zugriff auf den Eigenschafts Wert eines Steuer Elements durch den Benutzer.

```
void GetNotSupported();
```

### <a name="remarks"></a>Hinweise

Diese Funktion wird anstelle der Get-Funktion jeder Eigenschaft aufgerufen, bei der das Abrufen der Eigenschaft durch den Benutzer des Steuer Elements nicht unterstützt wird. Ein Beispiel wäre eine Eigenschaft, die schreibgeschützt ist.

##  <a name="getreadystate"></a>COleControl:: getreadystate

Gibt den Bereitschafts Zustand des Steuer Elements zurück.

```
long GetReadyState();
```

### <a name="return-value"></a>Rückgabewert

Der Bereitschafts Zustand des Steuer Elements, einer der folgenden Werte:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Standard Initialisierungs Status|
|READYSTATE_LOADING|Die Eigenschaften des Steuer Elements werden zurzeit geladen.|
|READYSTATE_LOADED|Das Steuerelement wurde initialisiert.|
|READYSTATE_INTERACTIVE|Das Steuerelement verfügt über genügend Daten, um interaktiv zu sein, aber nicht alle asynchronen Daten sind noch geladen.|
|READYSTATE_COMPLETE|Das Steuerelement verfügt über alle Daten.|

### <a name="remarks"></a>Hinweise

Die meisten einfachen Steuerelemente müssen niemals zwischen "geladen" und "interaktiv" unterscheiden. Steuerelemente, die Daten Pfad Eigenschaften unterstützen, können jedoch möglicherweise nicht interaktiv sein, bis zumindest einige Daten asynchron empfangen werden. Ein Steuerelement sollte so schnell wie möglich interaktiv werden.

##  <a name="getrectincontainer"></a>COleControl:: getrectincontainer

Ruft die Koordinaten des Rechteck des Steuer Elements relativ zum Container ab, ausgedrückt in Geräte Einheiten.

```
BOOL GetRectInContainer(LPRECT lpRect);
```

### <a name="parameters"></a>Parameter

*lpRect*<br/>
Ein Zeiger auf die Rechteck Struktur, in die die Koordinaten des Steuer Elements kopiert werden.

### <a name="return-value"></a>Rückgabewert

Ungleich 0 (null), wenn das Steuerelement direkt aktiv ist. andernfalls 0.

### <a name="remarks"></a>Hinweise

Das Rechteck ist nur gültig, wenn das Steuerelement direkt aktiv ist.

##  <a name="getstocktextmetrics"></a>COleControl:: getstocktextmetrics

Misst die Textmetrik für die Eigenschaft "Stock Font" des Steuer Elements, die mit der [SelectStockFont](#selectstockfont) -Funktion ausgewählt werden kann.

```
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```

### <a name="parameters"></a>Parameter

*lptm*<br/>
Ein Zeiger auf eine [TextMetric](/windows/win32/api/wingdi/ns-wingdi-textmetricw) -Struktur.

### <a name="remarks"></a>Hinweise

Die `GetStockTextMetrics` Funktion initialisiert die Struktur `TEXTMETRIC` , auf die *lptm* mit gültigen metrikinformationen verweist, wenn Sie erfolgreich war, oder die Struktur mit Nullen, wenn Sie nicht erfolgreich war. Verwenden Sie diese Funktion anstelle von [GetTextMetrics](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics) , wenn Sie das Steuerelement zeichnen, da Steuerelemente, wie ein beliebiges eingebettetes OLE-Objekt, ggf

Die `TEXTMETRIC` Struktur für die Standard Schriftart wird aktualisiert, wenn `SelectStockFont` die-Funktion aufgerufen wird. Diese Funktion sollte nur aufgerufen werden, nachdem die Schriftart ausgewählt wurde, um sicherzustellen, dass die von ihr bereitgestellten Informationen gültig sind.

##  <a name="gettext"></a>COleControl:: gettext

Implementiert die Get-Funktion der Stock Text-oder Caption-Eigenschaft.

```
BSTR GetText();
```

### <a name="return-value"></a>Rückgabewert

Der aktuelle Wert der Steuerelement Text Zeichenfolge oder eine Zeichenfolge der Länge 0 (null), wenn keine Zeichenfolge vorhanden ist.

> [!NOTE]
>  Weitere Informationen zum BSTR-Datentyp finden Sie unter [Datentypen](../../mfc/reference/data-types-mfc.md) im Abschnitt Makros und Globals.

### <a name="remarks"></a>Hinweise

Beachten Sie, dass der Aufrufer dieser `SysFreeString` Funktion für die zurückgegebene Zeichenfolge aufgerufen werden muss, um die Ressource freizugeben. Verwenden `InternalGetText` Sie in der Implementierung des-Steuer Elements, um auf die vordefinierte Eigenschaft des Steuer Elements oder den Beschriftungs Wert zuzugreifen.

##  <a name="getwindowlessdroptarget"></a>COleControl:: GetWindowlessDropTarget

Über `GetWindowlessDropTarget` schreiben Sie, wenn Sie ein fensterloses Steuerelement als Ziel eines OLE-Drag & Drop-Vorgangs festlegen möchten.

```
virtual IDropTarget* GetWindowlessDropTarget();
```

### <a name="return-value"></a>Rückgabewert

Ein Zeiger auf die- `IDropTarget` Schnittstelle des Objekts. Da es kein Fenster hat, kann ein fensterloses Objekt eine `IDropTarget` Schnittstelle nicht registrieren. Um jedoch an Drag & Drop teilnehmen zu können, kann ein fensterloses Objekt die-Schnittstelle implementieren und in `GetWindowlessDropTarget`zurückgeben.

### <a name="remarks"></a>Hinweise

Normalerweise würde dies erfordern, dass das Fenster des Steuer Elements als Ablage Ziel registriert wird. Da das Steuerelement jedoch kein eigenes Fenster hat, verwendet der Container sein eigenes Fenster als Ablage Ziel. Das-Steuerelement muss lediglich eine Implementierung der `IDropTarget` -Schnittstelle bereitstellen, an die der Container Aufrufe zum richtigen Zeitpunkt delegieren kann. Beispiel:

[!code-cpp[NVC_MFCAxCtl#2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]

##  <a name="initializeiids"></a>COleControl:: initializeiids

Informiert die Basisklasse der IIDs, die vom Steuerelement verwendet werden.

```
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```

### <a name="parameters"></a>Parameter

*piidPrimary*<br/>
Ein Zeiger auf die-Schnittstellen-ID der primären Dispatch-Schnittstelle des Steuer Elements.

*piidEvents*<br/>
Ein Zeiger auf die Schnittstellen-ID der Ereignis Schnittstelle des Steuer Elements.

### <a name="remarks"></a>Hinweise

Diese Funktion wird im Konstruktor des Steuer Elements aufgerufen, um die Basisklasse der Schnittstellen-IDs, die Ihr Steuerelement verwendet, zu informieren.

##  <a name="internalgetfont"></a>COleControl:: InternalGetFont

Greift auf die Eigenschaft "Stock Font" des Steuer Elements zu

```
CFontHolder& InternalGetFont();
```

### <a name="return-value"></a>Rückgabewert

Ein Verweis auf ein [cfontholder](../../mfc/reference/cfontholder-class.md) -Objekt, das das Stock Font-Objekt enthält.

##  <a name="internalgettext"></a>COleControl:: InternalGetText

Greift auf die Stock-Text-oder Caption-Eigenschaft des Steuer Elements zu.

```
const CString& InternalGetText();
```

### <a name="return-value"></a>Rückgabewert

Ein Verweis auf die Text Zeichenfolge des Steuer Elements.

##  <a name="internalsetreadystate"></a>COleControl:: internalssetreadystate

Legt den Bereitschafts Zustand des-Steuer Elements fest.

```
void InternalSetReadyState(long lNewReadyState);
```

### <a name="parameters"></a>Parameter

*lNewReadyState*<br/>
Der Bereitschafts Zustand, der für das Steuerelement festgelegt werden soll, einer der folgenden Werte:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Standard Initialisierungs Status|
|READYSTATE_LOADING|Die Eigenschaften des Steuer Elements werden zurzeit geladen.|
|READYSTATE_LOADED|Das Steuerelement wurde initialisiert.|
|READYSTATE_INTERACTIVE|Das Steuerelement verfügt über genügend Daten, um interaktiv zu sein, aber nicht alle asynchronen Daten sind noch geladen.|
|READYSTATE_COMPLETE|Das Steuerelement verfügt über alle Daten.|

### <a name="remarks"></a>Hinweise

Die meisten einfachen Steuerelemente müssen niemals zwischen "geladen" und "interaktiv" unterscheiden. Steuerelemente, die Daten Pfad Eigenschaften unterstützen, können jedoch möglicherweise nicht interaktiv sein, bis zumindest einige Daten asynchron empfangen werden. Ein Steuerelement sollte so schnell wie möglich interaktiv werden.

##  <a name="invalidatecontrol"></a>COleControl:: InvalidateControl

Erzwingt, dass sich das Steuerelement selbst neu zeichnet.

```
void InvalidateControl(
    LPCRECT lpRect = NULL,
    BOOL bErase = TRUE);
```

### <a name="parameters"></a>Parameter

*lpRect*<br/>
Ein Zeiger auf den Bereich des Steuer Elements, der für ungültig erklärt werden soll.

*bErase*<br/>
Gibt an, ob der Hintergrund innerhalb des Aktualisierungs Bereichs gelöscht werden soll, wenn der Aktualisierungs Bereich verarbeitet wird.

### <a name="remarks"></a>Hinweise

Wenn *lprect* einen NULL-Wert aufweist, wird das gesamte Steuerelement neu gezeichnet. Wenn *lprect* nicht NULL ist, gibt dies den Teil des Rechtecks des Steuer Elements an, das für ungültig erklärt werden soll. In Fällen, in denen das Steuerelement kein Fenster hat oder zurzeit nicht aktiv ist, wird das Rechteck ignoriert, und es wird ein Rückruf an die [IAdviseSink:: OnViewChange](/windows/win32/api/objidl/nf-objidl-iadvisesink-onviewchange) -Member-Funktion des Client Standorts durchgeführt. Verwenden Sie diese Funktion anstelle `CWnd::InvalidateRect` von `InvalidateRect`oder.

##  <a name="invalidatergn"></a>COleControl:: InvalidateRgn

Macht den Client Bereich des Container Fensters innerhalb der angegebenen Region ungültig.

```
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```

### <a name="parameters"></a>Parameter

*pRgn*<br/>
Ein Zeiger auf ein [crgn](../../mfc/reference/crgn-class.md) -Objekt, das den Anzeigebereich des OLE-Objekts angibt, das für ungültig erklärt werden soll, in Client Koordinaten des enthaltenden Fensters. Wenn dieser Parameter NULL ist, ist der Block das gesamte Objekt.

*bErase*<br/>
Gibt an, ob der Hintergrund innerhalb des ungültigen Bereichs gelöscht werden soll. TRUE gibt an, dass der Hintergrund gelöscht wird. Wenn der Wert false ist, bleibt der Hintergrund unverändert.

### <a name="remarks"></a>Hinweise

Dies kann verwendet werden, um fensterlose Steuerelemente im Container neu zu zeichnen. Der ungültige Bereich wird zusammen mit allen anderen Bereichen im Update Bereich zum Zeichnen gekennzeichnet, wenn die nächste [WM_PAINT](/windows/win32/gdi/wm-paint) -Nachricht gesendet wird.

Wenn die *berase* für einen beliebigen Teil des Aktualisierungs Bereichs true ist, wird der Hintergrund in der gesamten Region, nicht nur im angegebenen Teil, gelöscht.

##  <a name="isconvertingvbx"></a>COleControl:: isconvertingvbx

Ermöglicht das spezialisierte Laden eines OLE-Steuer Elements.

```
BOOL IsConvertingVBX();
```

### <a name="return-value"></a>Rückgabewert

Ungleich 0 (null), wenn das Steuerelement konvertiert wird. andernfalls 0.

### <a name="remarks"></a>Hinweise

Wenn Sie ein Formular, das VBX-Steuerelemente verwendet, in ein Formular mit OLE-Steuerelementen umrechnen, ist möglicherweise spezieller Lade Code für die OLE-Steuerelemente Wenn Sie z. b. eine Instanz des OLE-Steuer Elements laden, verfügen Sie möglicherweise über einen [PX_Font](persistence-of-ole-controls.md#px_font) - `DoPropExchange`aufrufbefehl in Ihrem:

[!code-cpp[NVC_MFCAxCtl#3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]

VBX-Steuerelemente haben jedoch kein Font-Objekt. jede Schriftart Eigenschaft wurde einzeln gespeichert. In diesem Fall verwenden `IsConvertingVBX` Sie, um zwischen diesen beiden Fällen zu unterscheiden:

[!code-cpp[NVC_MFCAxCtl#4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]

Ein weiterer Fall wäre, wenn das VBX-Steuerelement proprietäre Binärdaten (in seinem VBM_SAVEPROPERTY-Nachrichten Handler) gespeichert hat und das OLE-Steuerelement seine Binärdaten in einem anderen Format speichert. Wenn Sie möchten, dass Ihr OLE-Steuerelement abwärts kompatibel mit dem VBX-Steuerelement ist, können Sie sowohl das alte als auch `IsConvertingVBX` das neue Format mit der Funktion lesen, indem Sie unterscheiden, ob das VBX-Steuerelement oder das OLE-Steuerelement geladen wurde.

In der-Funktion `DoPropExchange` des Steuer Elements können Sie diese Bedingung überprüfen und bei "true" Code für diese Konvertierung ausführen (z. b. die vorherigen Beispiele). Wenn das Steuerelement nicht konvertiert wird, können Sie normalen Auslastungs Code ausführen. Diese Funktion gilt nur für Steuerelemente, die von VBX-Entsprechungen konvertiert werden.

##  <a name="isinvokeallowed"></a>COleControl:: isinvokeallowed

Aktiviert den Aufruf der Automatisierungs Methode.

```
BOOL IsInvokeAllowed(DISPID dispid);
```

### <a name="return-value"></a>Rückgabewert

Ungleich 0 (null), wenn das Steuerelement initialisiert wurde. andernfalls 0.

### <a name="remarks"></a>Hinweise

Die-Implementierung des Frame `IDispatch::Invoke` Works `IsInvokeAllowed` von Ruft auf, um zu bestimmen, ob `dispid`eine angegebene Funktion (identifiziert durch) aufgerufen werden kann. Das Standardverhalten für ein OLE-Steuerelement besteht darin, dass Automatisierungsmethoden nur aufgerufen werden können, wenn das Steuerelement initialisiert wurde. `IsInvokeAllowed` ist jedoch eine virtuelle Funktion und kann ggf. überschrieben werden (z. b. wenn das Steuerelement als Automatisierungsserver verwendet wird).

##  <a name="ismodified"></a>COleControl:: IsModified

Bestimmt, ob der Zustand des-Steuer Elements geändert wurde.

```
BOOL IsModified();
```

### <a name="return-value"></a>Rückgabewert

Ein Wert ungleich 0 (null), wenn der Zustand des Steuer Elements seit dem letzten Speichern geändert wurde. andernfalls 0.

### <a name="remarks"></a>Hinweise

Der Zustand eines Steuer Elements wird geändert, wenn sich ein Eigenschafts Wert ändert.

##  <a name="isoptimizeddraw"></a>COleControl:: IsOptimizedDraw

Bestimmt, ob der Container optimierte Zeichnung für den aktuellen Zeichnungs Vorgang unterstützt.

```
BOOL IsOptimizedDraw();
```

### <a name="return-value"></a>Rückgabewert

TRUE, wenn der Container optimierte Zeichnung für den aktuellen Zeichnungs Vorgang unterstützt. andernfalls false.

### <a name="remarks"></a>Hinweise

Wenn das optimierte zeichnen unterstützt wird, muss das Steuerelement alte Objekte (Stifte, Pinsel, Schriftarten usw.) nicht in den Gerätekontext auswählen, wenn das Zeichnen abgeschlossen ist.

##  <a name="issubclassedcontrol"></a>COleControl:: IsSubclassedControl

Wird von Framework aufgerufen, um zu bestimmen, ob das Steuerelement ein Windows-Steuerelement Unterklassen hat.

```
virtual BOOL IsSubclassedControl();
```

### <a name="return-value"></a>Rückgabewert

Ungleich 0 (null), wenn das Steuerelement untergeordnet ist. andernfalls 0.

### <a name="remarks"></a>Hinweise

Sie müssen diese Funktion überschreiben und true zurückgeben, wenn Ihre OLE-Steuerelemente ein Windows-Steuerelement Unterklassen.

##  <a name="load"></a>COleControl:: Load

Setzt alle zuvor geladenen Daten zurück, die asynchron geladen wurden, und initiiert ein neues Laden der asynchronen Eigenschaft des Steuer Elements.

```
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```

### <a name="parameters"></a>Parameter

*strNewPath*<br/>
Ein Zeiger auf eine Zeichenfolge, die den Pfad enthält, der auf den absoluten Speicherort der asynchronen Steuerelement Eigenschaft verweist.

*prop*<br/>
Ein [CDataPathProperty](../../mfc/reference/cdatapathproperty-class.md) -Objekt, das eine asynchrone Steuerelement Eigenschaft implementiert.

##  <a name="lockinplaceactive"></a>COleControl:: lockinplaceactive

Verhindert, dass der Container das Steuerelement deaktiviert.

```
BOOL LockInPlaceActive(BOOL bLock);
```

### <a name="parameters"></a>Parameter

*bLock*<br/>
TRUE, wenn der direkte aktive Zustand des Steuer Elements gesperrt werden soll. FALSE, wenn die Sperre aufgehoben werden soll.

### <a name="return-value"></a>Rückgabewert

Ungleich 0 (null), wenn die Sperre erfolgreich war. andernfalls 0.

### <a name="remarks"></a>Hinweise

Beachten Sie, dass jedes Sperren des-Steuer Elements mit dem Entsperren des-Steuer Elements gekoppelt werden muss, wenn es beendet wird. Sie sollten das Steuerelement nur für kurze Zeiträume sperren, z. b. beim Auslösen eines Ereignisses.

##  <a name="onambientpropertychange"></a>COleControl:: OnAmbientPropertyChange

Wird von Framework aufgerufen, wenn eine Ambient-Eigenschaft des Containers den Wert geändert hat.

```
virtual void OnAmbientPropertyChange(DISPID dispid);
```

### <a name="parameters"></a>Parameter

*dispID*<br/>
Die Dispatch-ID der Ambient-Eigenschaft, die sich geändert hat, oder DISPID_UNKNOWN, wenn mehrere Eigenschaften geändert wurden.

##  <a name="onappearancechanged"></a>COleControl:: onscheinbar ancechanged

Wird von Framework aufgerufen, wenn sich der Eigenschafts Wert der Aktien Darstellung geändert hat.

```
virtual void OnAppearanceChanged ();
```

### <a name="remarks"></a>Hinweise

Überschreiben Sie diese Funktion, wenn Sie eine Benachrichtigung wünschen, nachdem diese Eigenschaft geändert wurde. Die Standard Implementierung ruft `InvalidateControl`auf.

##  <a name="onbackcolorchanged"></a>COleControl:: OnBackColorChanged

Wird von Framework aufgerufen, wenn sich der Eigenschafts Wert der Stock BackColor geändert hat.

```
virtual void OnBackColorChanged();
```

### <a name="remarks"></a>Hinweise

Überschreiben Sie diese Funktion, wenn Sie eine Benachrichtigung wünschen, nachdem diese Eigenschaft geändert wurde. Die Standard Implementierung ruft `InvalidateControl`auf.

##  <a name="onborderstylechanged"></a>COleControl:: OnBorderStyleChanged

Wird von Framework aufgerufen, wenn sich der Wert der Stock BorderStyle-Eigenschaft geändert hat.

```
virtual void OnBorderStyleChanged();
```

### <a name="remarks"></a>Hinweise

Die Standard Implementierung ruft `InvalidateControl`auf.

Überschreiben Sie diese Funktion, wenn Sie eine Benachrichtigung wünschen, nachdem diese Eigenschaft geändert wurde.

##  <a name="onclick"></a>COleControl:: OnClick

Wird von Framework aufgerufen, wenn auf eine Maustaste geklickt wurde oder die doClick-Aktien Methode aufgerufen wurde.

```
virtual void OnClick(USHORT iButton);
```

### <a name="parameters"></a>Parameter

*iButton*<br/>
Der Index einer Maustaste. Kann einen der folgenden Werte aufweisen:

- LEFT_BUTTON die linke Maustaste wurde gedrückt.

- MIDDLE_BUTTON die mittlere Maustaste wurde gedrückt.

- RIGHT_BUTTON klicken Sie auf die Rechte Maustaste.

### <a name="remarks"></a>Hinweise

Die Standard Implementierung ruft `COleControl::FireClick`auf.

Überschreiben Sie diese Member-Funktion, um die Standardbehandlung zu ändern oder zu erweitern.

##  <a name="onclose"></a>COleControl:: OnClose

Wird von Framework aufgerufen, wenn der Container die `IOleControl::Close` Funktion des Steuer Elements aufgerufen hat.

```
virtual void OnClose(DWORD dwSaveOption);
```

### <a name="parameters"></a>Parameter

*dwSaveOption*<br/>
Flag, das angibt, ob das Objekt vor dem Laden gespeichert werden soll. Gültige Werte sind:

- OLECLOSE_SAVEIFDIRTY

- OLECLOSE_NOSAVE

- OLECLOSE_PROMPTSAVE

### <a name="remarks"></a>Hinweise

Standardmäßig speichert `OnClose` das Steuerelement Objekt, wenn es geändert wurde, und *dwsaveoption* ist entweder OLECLOSE_SAVEIFDIRTY oder OLECLOSE_PROMPTSAVE.

##  <a name="ondoverb"></a>COleControl:: ondoverb

Wird von Framework aufgerufen, wenn der Container die `IOleObject::DoVerb` Member-Funktion aufruft.

```
virtual BOOL OnDoVerb(
    LONG iVerb,
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Parameter

*iVerb*<br/>
Der Index des aufzurufenden Steuerelement Verbs.

*lpMsg*<br/>
Ein Zeiger auf die Windows-Meldung, die bewirkt hat, dass das Verb aufgerufen wird.

*hWndParent*<br/>
Das Handle für das übergeordnete Fenster des Steuer Elements. Wenn bei der Ausführung des Verbs ein Fenster (oder Windows) erstellt wird, sollte *hwndParent* als übergeordnetes Element verwendet werden.

*lpRect*<br/>
Ein Zeiger auf eine Rect-Struktur, in die die Koordinaten des Steuer Elements relativ zum Container kopiert werden.

### <a name="return-value"></a>Rückgabewert

Ungleich 0 (null), wenn der Rückruf erfolgreich war. andernfalls 0.

### <a name="remarks"></a>Hinweise

Die Standard Implementierung verwendet die Meldungs Zuordnungs Einträge ON_OLEVERB und ON_STDOLEVERB, um die richtige aufzurufende Funktion zu bestimmen.

Überschreiben Sie diese Funktion, um die Standardbehandlung des Verbs zu ändern.

##  <a name="ondraw"></a>COleControl:: OnDraw

Wird von Framework aufgerufen, um das OLE-Steuerelement mithilfe des angegebenen Geräte Kontexts in das angegebene umgebende Rechteck zu zeichnen.

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rcBounds,
    const CRect& rcInvalid);
```

### <a name="parameters"></a>Parameter

*pDC*<br/>
Der Gerätekontext, in dem die Zeichnung auftritt.

*rcBounds*<br/>
Der rechteckige Bereich des-Steuer Elements, einschließlich des Rahmens.

*rcInvalid*<br/>
Der rechteckige Bereich des-Steuer Elements, der ungültig ist.

### <a name="remarks"></a>Hinweise

`OnDraw`wird in der Regel für Bildschirm Anzeige aufgerufen und übergibt einen Bildschirm-Gerätekontext als *PDC*. Der *rcBounds* -Parameter identifiziert das Rechteck im Zielgeräte Kontext (relativ zum aktuellen Kartenmodus). Der *rcInvalid* -Parameter ist das tatsächliche Rechteck, das ungültig ist. In einigen Fällen handelt es sich hierbei um einen kleineren Bereich als *rcBounds*.

##  <a name="ondrawmetafile"></a>COleControl:: OnDrawMetafile

Wird von Framework aufgerufen, um das OLE-Steuerelement im angegebenen umgebenden Rechteck mithilfe des angegebenen Metadatei-Geräte Kontexts zu zeichnen.

```
virtual void OnDrawMetafile(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>Parameter

*pDC*<br/>
Der Gerätekontext, in dem die Zeichnung auftritt.

*rcBounds*<br/>
Der rechteckige Bereich des-Steuer Elements, einschließlich des Rahmens.

### <a name="remarks"></a>Hinweise

Die Standard Implementierung ruft die [OnDraw](#ondraw) -Funktion auf.

##  <a name="onedit"></a>COleControl:: onEdit

Bewirkt, dass das Steuerelement die Benutzeroberfläche aktiviert wird.

```
virtual BOOL OnEdit(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Parameter

*lpMsg*<br/>
Ein Zeiger auf die Windows-Meldung, die das Verb aufgerufen hat.

*hWndParent*<br/>
Ein Handle für das übergeordnete Fenster des Steuer Elements.

*lpRect*<br/>
Ein Zeiger auf das Rechteck, das vom-Steuerelement im Container verwendet wird.

### <a name="return-value"></a>Rückgabewert

Ungleich NULL, wenn der-Befehl erfolgreich ausgeführt wurde. andernfalls 0.

### <a name="remarks"></a>Hinweise

Dies hat dieselbe Auswirkung wie das Aufrufen des OLEIVERB_UIACTIVATE Verbs des Steuer Elements.

Diese Funktion wird in der Regel als Handlerfunktion für einen ON_OLEVERB Message Map-Eintrag verwendet. Dadurch ist das Verb "Bearbeiten" im Menü "Objekt" des Steuer Elements verfügbar. Beispiel:

[!code-cpp[NVC_MFCAxCtl#5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]

##  <a name="onenabledchanged"></a>COleControl:: OnEnabledChanged

Wird von Framework aufgerufen, wenn sich der Wert der vordefinierten Eigenschaft geändert hat.

```
virtual void OnEnabledChanged();
```

### <a name="remarks"></a>Hinweise

Überschreiben Sie diese Funktion, wenn Sie eine Benachrichtigung wünschen, nachdem diese Eigenschaft geändert wurde. Die Standard Implementierung ruft [InvalidateControl](#invalidatecontrol)auf.

##  <a name="onenumverbs"></a>COleControl:: onenumverbs

Wird von Framework aufgerufen, wenn der Container die `IOleObject::EnumVerbs` Member-Funktion aufruft.

```
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```

### <a name="parameters"></a>Parameter

*ppenumOleVerb*<br/>
Ein Zeiger auf das `IEnumOLEVERB` -Objekt, das die Verben des Steuer Elements auflistet.

### <a name="return-value"></a>Rückgabewert

Ungleich 0 (null), wenn Verben verfügbar sind; andernfalls 0.

### <a name="remarks"></a>Hinweise

Die Standard Implementierung listet die ON_OLEVERB-Einträge in der Meldungs Zuordnung auf.

Überschreiben Sie diese Funktion, um die Standardmethode zur Enumeration von Verben zu ändern.

##  <a name="oneventadvise"></a>COleControl:: OnEvent-Empfehlung

Wird von Framework aufgerufen, wenn ein Ereignishandler mit einem OLE-Steuerelement verbunden oder von diesem getrennt wird.

```
virtual void OnEventAdvise(BOOL bAdvise);
```

### <a name="parameters"></a>Parameter

*bAdvise*<br/>
TRUE gibt an, dass ein Ereignishandler mit dem Steuerelement verbunden ist. FALSE gibt an, dass ein Ereignishandler vom Steuerelement getrennt wurde.

##  <a name="onfontchanged"></a>COleControl:: OnFontChanged

Wird von Framework aufgerufen, wenn sich der Wert der Stock Font-Eigenschaft geändert hat.

```
virtual void OnFontChanged();
```

### <a name="remarks"></a>Hinweise

Die Standard Implementierung ruft `COleControl::InvalidateControl`auf. Wenn das Steuerelement ein Windows-Steuerelement unterteilt, sendet die Standard Implementierung auch eine WM_SETFONT-Meldung an das Fenster des Steuer Elements.

Überschreiben Sie diese Funktion, wenn Sie eine Benachrichtigung wünschen, nachdem diese Eigenschaft geändert wurde.

### <a name="example"></a>Beispiel

[!code-cpp[NVC_MFCAxCtl#6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]

##  <a name="onforecolorchanged"></a>COleControl:: OnForeColorChanged

Wird von Framework aufgerufen, wenn sich der Wert der Stock ForeColor-Eigenschaft geändert hat.

```
virtual void OnForeColorChanged();
```

### <a name="remarks"></a>Hinweise

Die Standard Implementierung ruft `InvalidateControl`auf.

Überschreiben Sie diese Funktion, wenn Sie eine Benachrichtigung wünschen, nachdem diese Eigenschaft geändert wurde.

##  <a name="onfreezeevents"></a>COleControl:: onfrezeevents

Wird von Framework aufgerufen, nachdem der Container `IOleControl::FreezeEvents`aufgerufen hat.

```
virtual void OnFreezeEvents(BOOL bFreeze);
```

### <a name="parameters"></a>Parameter

*bFreeze*<br/>
TRUE, wenn die Ereignis Behandlung des Steuer Elements eingefroren ist. andernfalls false.

### <a name="remarks"></a>Hinweise

Bei der Standardimplementierung wird keine Aktion ausgeführt.

Überschreiben Sie diese Funktion, wenn Sie zusätzliches Verhalten wünschen, wenn die Ereignis Behandlung eingefroren oder nicht eingefroren ist.

##  <a name="ongetcolorset"></a>COleControl:: ongetcolorset

Wird von Framework aufgerufen, wenn der Container die `IViewObject::GetColorSet` Member-Funktion aufruft.

```
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    LPLOGPALETTE* ppColorSet);
```

### <a name="parameters"></a>Parameter

*ptd*<br/>
Verweist auf das Zielgerät, für das das Bild gerendert werden soll. Wenn dieser Wert NULL ist, sollte das Bild für ein Standard Zielgerät, normalerweise ein Anzeigegerät, gerendert werden.

*hicTargetDev*<br/>
Gibt den Informations Kontext auf dem durch *ptd*gekennzeichneten Zielgerät an. Dieser Parameter kann ein Gerätekontext sein, ist aber nicht unbedingt eine solche. Wenn *ptd* NULL ist, sollte *hictargetdev* ebenfalls NULL sein.

*ppColorSet*<br/>
Ein Zeiger auf den Speicherort, an dem der verwendete Satz von Farben kopiert werden soll. Wenn die Funktion den Farbsatz nicht zurückgibt, wird NULL zurückgegeben.

### <a name="return-value"></a>Rückgabewert

Ungleich 0 (null), wenn ein gültiger Farbsatz zurückgegeben wird. andernfalls 0.

### <a name="remarks"></a>Hinweise

Der Container ruft diese Funktion auf, um alle Farben zu erhalten, die zum Zeichnen des OLE-Steuer Elements erforderlich sind. Der Container kann die Farbsätze verwenden, die in Verbindung mit den Farben abgerufen wurden, um die gesamte Farbpalette festzulegen. Die Standard Implementierung gibt false zurück.

Überschreiben Sie diese Funktion, um eine spezielle Verarbeitung dieser Anforderung durchzuführen.

##  <a name="ongetcontrolinfo"></a>COleControl:: ongetcontrolinfo

Wird von Framework aufgerufen, wenn der Container des Steuer Elements Informationen zum Steuerelement angefordert hat.

```
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```

### <a name="parameters"></a>Parameter

*pControlInfo*<br/>
Zeiger auf eine [controlInfo](/windows/win32/api/ocidl/ns-ocidl-controlinfo) -Struktur, die ausgefüllt werden soll.

### <a name="remarks"></a>Hinweise

Diese Informationen bestehen hauptsächlich aus einer Beschreibung der mnetmonischen Schlüssel des Steuer Elements. Die Standard Implementierung füllt *pcontrolinfo* mit Standardinformationen.

Überschreiben Sie diese Funktion, wenn das Steuerelement mnetmonische Schlüssel verarbeiten muss.

##  <a name="ongetdisplaystring"></a>COleControl:: ongetdisplaystring

Wird von Framework aufgerufen, um eine Zeichenfolge abzurufen, die den aktuellen Wert der von *DISPID*identifizierten Eigenschaft darstellt.

```
virtual BOOL OnGetDisplayString(
    DISPID dispid,
    CString& strValue);
```

### <a name="parameters"></a>Parameter

*dispid*<br/>
Die Verteiler-ID einer Eigenschaft des Steuerelements.

*strValue*<br/>
Ein Verweis auf ein [CString](../../atl-mfc-shared/reference/cstringt-class.md) -Objekt, über das eine Zeichenfolge zurückgegeben wird.

### <a name="return-value"></a>Rückgabewert

Ungleich 0 (null), wenn eine Zeichenfolge in ' *strevalue* ' zurückgegeben wurde, andernfalls 0.

### <a name="remarks"></a>Hinweise

Überschreiben Sie diese Funktion, wenn das Steuerelement über eine Eigenschaft verfügt, deren Wert nicht direkt in eine Zeichenfolge konvertiert werden kann, und Sie möchten, dass der Wert der Eigenschaft in einem vom Container bereitgestellten Eigenschaften Browser angezeigt wird.

##  <a name="ongetinplacemenu"></a>COleControl:: ongetinplacemenu

Wird von Framework aufgerufen, wenn das Steuerelement aktiviert ist, um das Menü zu erhalten, das mit dem vorhandenen Menü des Containers zusammengeführt werden soll.

```
virtual HMENU OnGetInPlaceMenu();
```

### <a name="return-value"></a>Rückgabewert

Das Handle des Steuer Elements des Steuer Elements oder NULL, wenn das Steuerelement keinen besitzt. Die Standard Implementierung gibt NULL zurück.

### <a name="remarks"></a>Hinweise

Weitere Informationen zum Zusammenführen von OLE-Ressourcen finden Sie in den Artikeln [Menüs und Ressourcen (OLE)](../../mfc/menus-and-resources-ole.md).

##  <a name="ongetnaturalextent"></a>COleControl:: ongetnaturalextent

Wird von Framework als Antwort auf die `IViewObjectEx::GetNaturalExtent` Anforderung eines Containers aufgerufen.

```
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```

### <a name="parameters"></a>Parameter

*dwAspect*<br/>
Gibt an, wie das Objekt dargestellt werden soll. Zu den Darstellungen gehören Inhalt, ein Symbol, eine Miniaturansicht oder ein gedruckter Dokument. Gültige Werte stammen aus der-Enumeration [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) oder DVASPECT2.

*lindex*<br/>
Der relevante Teil des Objekts. Derzeit ist nur-1 gültig.

*ptd*<br/>
Verweist auf die [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) -Struktur, die das Zielgerät definiert, für das die Größe des Objekts zurückgegeben werden soll.

*hicTargetDev*<br/>
Gibt den Informations Kontext für das Zielgerät an, das durch den *ptd-* Parameter angegeben wird, von dem das Objekt gerätemetriken extrahieren und die Funktionen des Geräts testen kann. Wenn *ptd* NULL ist, sollte das Objekt den Wert im *hictargetdev* -Parameter ignorieren.

*pExtentInfo*<br/>
Verweist auf die `DVEXTENTINFO` -Struktur, die die Größendaten angibt. Die `DVEXTENTINFO` Struktur sieht wie folgt aus:

```cpp
typedef struct tagExtentInfo
{
    UINT cb;
    DWORD dwExtentMode;
    SIZEL sizelProposed;
}   DVEXTENTINFO;
```

Der Strukturmember `dwExtentMode` kann einen von zwei Werten annehmen:

- DVEXTENT_CONTENT Fragen Sie nach, wie groß das Steuerelement sein sollte, um Inhalt genau anzupassen (Andocken).

- DVEXTENT_INTEGRAL bei der Größenänderung die vorgeschlagene Größe an Steuerelement übergeben

*psizel*<br/>
Zeigt auf die Größe der von Steuerelement zurückgegebenen Daten. Die zurückgegebenen Größendaten werden für jede Dimension auf-1 festgelegt, die nicht angepasst wurde.

### <a name="return-value"></a>Rückgabewert

Ungleich 0 (null), wenn die Größe erfolgreich zurückgegeben oder angepasst wird. andernfalls 0.

### <a name="remarks"></a>Hinweise

Überschreiben Sie diese Funktion, um die Anzeige Größe des Objekts zurückzugeben, die der vorgeschlagenen Größe und `DVEXTENTINFO` dem Block Modus in der Struktur am nächsten liegt. Die Standard Implementierung gibt false zurück und nimmt keine Anpassungen an der Größe vor.

##  <a name="ongetpredefinedstrings"></a>COleControl:: ongetpredefinedstrings

Wird von Framework aufgerufen, um einen Satz vordefinierter Zeichen folgen zu erhalten, die die möglichen Werte für eine Eigenschaft darstellen.

```
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,
    CStringArray* pStringArray,
    CDWordArray* pCookieArray);
```

### <a name="parameters"></a>Parameter

*dispid*<br/>
Die Verteiler-ID einer Eigenschaft des Steuerelements.

*pStringArray*<br/>
Ein Zeichen folgen Array, das mit Rückgabe Werten aufgefüllt werden soll.

*pCookieArray*<br/>
Ein DWORD-Array, das mit Rückgabe Werten aufgefüllt werden soll.

### <a name="return-value"></a>Rückgabewert

Ein Wert ungleich 0, wenn *pstringarray* und *pcookiearray*Elemente hinzugefügt wurden.

### <a name="remarks"></a>Hinweise

Überschreiben Sie diese Funktion, wenn das Steuerelement über eine Eigenschaft mit einem Satz möglicher Werte verfügt, die durch Zeichen folgen dargestellt werden können. Für jedes Element, das *pstringarray*hinzugefügt wird, sollten Sie *pcookiearray* ein entsprechendes "Cookie"-Element hinzufügen. Diese "Cookie"-Werte können später vom Framework an die `COleControl::OnGetPredefinedValue` Funktion weitergegeben werden.

##  <a name="ongetpredefinedvalue"></a>COleControl:: ongetpredefinedvalue

Wird von Framework aufgerufen, um den Wert zu erhalten, der einer der zuvor durch eine außer Kraft Setzung von `COleControl::OnGetPredefinedStrings`zurückgegebenen vordefinierten Zeichen folgen entspricht.

```
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,
    DWORD dwCookie,
    VARIANT* lpvarOut);
```

### <a name="parameters"></a>Parameter

*dispid*<br/>
Die Verteiler-ID einer Eigenschaft des Steuerelements.

*dwCookie*<br/>
Ein zuvor durch eine außer Kraft Setzung von `COleControl::OnGetPredefinedStrings`zurück gegebenes Cookie-Wert.

*lpvarOut*<br/>
Ein Zeiger auf `VARIANT` eine-Struktur, über die ein Eigenschafts Wert zurückgegeben wird.

### <a name="return-value"></a>Rückgabewert

Ungleich 0 (null), wenn ein Wert in *lpvarout*zurückgegeben wurde. andernfalls 0.

##  <a name="ongetviewextent"></a>COleControl:: ongetviewextent

Wird von Framework als Antwort auf die [IViewObject2:: GetExtent](/windows/win32/api/oleidl/nf-oleidl-iviewobject2-getextent) -Anforderung eines Containers aufgerufen.

```
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```

### <a name="parameters"></a>Parameter

*dwDrawAspect*<br/>
DWORD, das beschreibt, welches Formular oder welcher Aspekt eines Objekts angezeigt werden soll. Gültige Werte stammen aus der-Enumeration [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) oder DVASPECT2.

*lindex*<br/>
Der relevante Teil des Objekts. Derzeit ist nur-1 gültig.

*ptd*<br/>
Verweist auf die [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) -Struktur, die das Zielgerät definiert, für das die Größe des Objekts zurückgegeben werden soll.

*lpsizel*<br/>
Zeigt auf den Speicherort, an dem die Größe des Objekts zurückgegeben wird.

### <a name="return-value"></a>Rückgabewert

Ungleich 0 (null), wenn die Block Informationen erfolgreich zurückgegeben wurden andernfalls 0.

### <a name="remarks"></a>Hinweise

Überschreiben Sie diese Funktion, wenn das Steuerelement die zwei-Pass-Zeichnung verwendet und seine nicht transparenten und transparenten Teile unterschiedliche Dimensionen aufweisen.

##  <a name="ongetviewrect"></a>COleControl:: ongetviewrect

Wird von Framework als Antwort auf die `IViewObjectEx::GetRect` Anforderung eines Containers aufgerufen.

```
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```

### <a name="parameters"></a>Parameter

*dwAspect*<br/>
DWORD, das beschreibt, welches Formular oder welcher Aspekt eines Objekts angezeigt werden soll. Gültige Werte stammen aus der Enumeration [dvaspekto](/windows/win32/api/wtypes/ne-wtypes-dvaspect) oder DVASPECT2:

- DVASPECT_CONTENT Begrenzungs Rechteck des gesamten Objekts. Die linke obere Ecke des Ursprungs und der Größe des Objekts, die dem von `GetViewExtent`zurückgegebenen Wert entspricht *.*

- DVASPECT_OPAQUE-Objekte mit einem rechteckigen, nicht transparenten Bereich geben dieses Rechteck zurück. Andere Fehler.

- DVASPECT_TRANSPARENT Rechteck, das alle transparenten oder unregelmäßigen Teile abdeckt.

*pRect*<br/>
Verweist auf die [RECTL](/previous-versions/dd162907\(v=vs.85\)) -Struktur, die das Rechteck angibt, in dem das Objekt gezeichnet werden soll. Dieser Parameter steuert die Positionierung und Streckung des Objekts.

### <a name="return-value"></a>Rückgabewert

Ungleich 0 (null), wenn das Rechteck für das Objekt erfolgreich zurückgegeben wird. andernfalls 0.

### <a name="remarks"></a>Hinweise

Die Größe des Objekts wird von `OnGetViewRect` in ein Rechteck konvertiert, beginnend an einer bestimmten Position (der Standardwert ist die linke obere Ecke der Anzeige). Überschreiben Sie diese Funktion, wenn das Steuerelement die zwei-Pass-Zeichnung verwendet und seine nicht transparenten und transparenten Teile unterschiedliche Dimensionen aufweisen.

##  <a name="ongetviewstatus"></a>COleControl:: ongetviewstatus

Wird von Framework als Antwort auf die `IViewObjectEx::GetViewStatus` Anforderung eines Containers aufgerufen.

```
virtual DWORD OnGetViewStatus();
```

### <a name="return-value"></a>Rückgabewert

Einer der Werte der VIEWSTATUS-Enumeration, wenn erfolgreich. andernfalls 0. Mögliche Werte sind eine beliebige Kombination der folgenden Werte:

|||
|-|-|
|VIEWSTATUS_OPAQUE|Das Objekt ist vollständig nicht transparent. Wenn dieses Bit nicht festgelegt ist, enthält das-Objekt transparente Teile. Dieses Bit gilt nur für Inhalts bezogene Aspekte und nicht für DVASPECT_ICON oder DVASPECT_DOCPRINT.|
|VIEWSTATUS_SOLIDBKGND|Das Objekt verfügt über einen soliden Hintergrund (in einer voll Tonfarbe und nicht in einem Pinsel Muster). Dieses Bit ist nur dann sinnvoll, wenn VIEWSTATUS_OPAQUE festgelegt ist und nur auf Inhalts bezogene Aspekte und nicht auf DVASPECT_ICON oder DVASPECT_DOCPRINT anwendbar ist.|
|VIEWSTATUS_DVASPECTOPAQUE|Object unterstützt DVASPECT_OPAQUE. Alle IViewObjectEx-Methoden, die einen Zeichnungs Aspekt als Parameter annehmen, können mit diesem Aspekt aufgerufen werden.|
|VIEWSTATUS_DVASPECTTRANSPARENT|Object unterstützt DVASPECT_TRANSPARENT. Alle `IViewObjectEx` Methoden, die einen Zeichnungs Aspekt als Parameter annehmen, können mit diesem Aspekt aufgerufen werden.|

### <a name="remarks"></a>Hinweise

Überschreiben Sie diese Funktion, wenn das Steuerelement die zwei-Pass-Zeichnung verwendet. Die Standard Implementierung gibt VIEWSTATUS_OPAQUE zurück.

##  <a name="onhidetoolbars"></a>COleControl:: onhidetoolbars

Wird von Framework aufgerufen, wenn das Steuerelement die Benutzeroberfläche deaktiviert ist.

```
virtual void OnHideToolBars();
```

### <a name="remarks"></a>Hinweise

Die-Implementierung sollte alle Symbolleisten ausblenden, `OnShowToolbars`die von angezeigt werden.

##  <a name="oninactivemousemove"></a>COleControl:: oninactivemoulmove

Wird vom Container für das inaktive Objekt unter dem Mauszeiger beim Empfang einer WM_MOUSEMOVE-Nachricht aufgerufen.

```
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```

### <a name="parameters"></a>Parameter

*lprcBounds*<br/>
Das umgebende Rechteck des Objekts in den Client Koordinaten des enthaltenden Fensters. Weist das-Objekt an, die genaue Position und Größe auf dem Bildschirm anzuzeigen, als die WM_MOUSEMOVE-Nachricht empfangen wurde.

*w*<br/>
Die x-Koordinate der Mausposition in Client Koordinaten des enthaltenden Fensters.

*y*<br/>
Die y-Koordinate der Mausposition in Client Koordinaten des enthaltenden Fensters.

*dwKeyState*<br/>
Identifiziert den aktuellen Zustand der Tastatur-Modifizierertasten auf der Tastatur. Gültige Werte können eine Kombination aus allen Flags sein MK_CONTROL, MK_SHIFT, MK_ALT, MK_BUTTON, MK_LBUTTON, MK_MBUTTON und MK_RBUTTON.

### <a name="remarks"></a>Hinweise

Beachten Sie, dass Fenster Client Koordinaten (Pixel) verwendet werden, um die Position des Mauszeigers zu übergeben. Dies wird durch das Weiterleiten des umgebenden Rechtecks des Objekts im selben Koordinatensystem ermöglicht.

##  <a name="oninactivesetcursor"></a>COleControl:: oninactivesetcursor

Wird vom Container für das inaktive Objekt unter dem Mauszeiger beim Empfang einer WM_SETCURSOR-Nachricht aufgerufen.

```
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```

### <a name="parameters"></a>Parameter

*lprcBounds*<br/>
Das umgebende Rechteck des Objekts in den Client Koordinaten des enthaltenden Fensters. Weist das-Objekt an, die genaue Position und Größe auf dem Bildschirm anzuzeigen, als die WM_SETCURSOR-Nachricht empfangen wurde.

*w*<br/>
Die x-Koordinate der Mausposition in Client Koordinaten des enthaltenden Fensters.

*y*<br/>
Die y-Koordinate der Mausposition in Client Koordinaten des enthaltenden Fensters.

*dwMouseMsg*<br/>
Der Bezeichner der Maus Nachricht, für die ein WM_SETCURSOR aufgetreten ist.

*bSetAlways*<br/>
Gibt an, ob das Objekt den Cursor festlegen muss. TRUE gibt an, dass das-Objekt den Cursor festlegen muss. Wenn der Wert false ist, ist der Cursor nicht verpflichtet, den Cursor festzulegen, und sollte S_FALSE in diesem Fall zurückgeben.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Hinweise

Beachten Sie, dass Fenster Client Koordinaten (Pixel) verwendet werden, um die Position des Mauszeigers zu übergeben. Dies wird durch das Weiterleiten des umgebenden Rechtecks des Objekts im selben Koordinatensystem ermöglicht.

##  <a name="onkeydownevent"></a>COleControl:: onkeydownetvent

Wird von Framework aufgerufen, nachdem ein Aktien KeyDown-Ereignis verarbeitet wurde.

```
virtual void OnKeyDownEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>Parameter

*nChar*<br/>
Der Code Wert des virtuellen Schlüssels der gedrückten Taste. Eine Liste der virtuellen Standardschlüssel Codes finden Sie unter Winuser. h.

*nShiftState*<br/>
Enthält eine Kombination der folgenden Flags:

- SHIFT_MASK die UMSCHALTTASTE wurde während der Aktion gedrückt.

- CTRL_MASK die STRG-Taste wurde während der Aktion gedrückt.

- ALT_MASK die Alt-Taste wurde während der Aktion gedrückt.

### <a name="remarks"></a>Hinweise

Überschreiben Sie diese Funktion, wenn Ihr Steuerelement Zugriff auf die Schlüsselinformationen benötigt, nachdem das Ereignis ausgelöst wurde.

##  <a name="onkeypressevent"></a>COleControl:: onkeypressevent

Wird von Framework aufgerufen, nachdem das Stock KeyPress-Ereignis ausgelöst wurde.

```
virtual void OnKeyPressEvent(USHORT nChar);
```

### <a name="parameters"></a>Parameter

*nChar*<br/>
Enthält den Code Wert des virtuellen Schlüssels des gedrückten Schlüssels. Eine Liste der virtuellen Standardschlüssel Codes finden Sie unter Winuser. h.

### <a name="remarks"></a>Hinweise

Beachten Sie, dass der *NCHAR* -Wert möglicherweise durch den Container geändert wurde.

Überschreiben Sie diese Funktion, wenn Sie nach dem Auftreten dieses Ereignisses eine Benachrichtigung wünschen.

##  <a name="onkeyupevent"></a>COleControl:: onkeyupeer Vent

Wird von Framework aufgerufen, nachdem ein Aktien KeyDown-Ereignis verarbeitet wurde.

```
virtual void OnKeyUpEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>Parameter

*nChar*<br/>
Der Code Wert des virtuellen Schlüssels der gedrückten Taste. Eine Liste der virtuellen Standardschlüssel Codes finden Sie unter Winuser. h.

*nShiftState*<br/>
Enthält eine Kombination der folgenden Flags:

- SHIFT_MASK die UMSCHALTTASTE wurde während der Aktion gedrückt.

- CTRL_MASK die STRG-Taste wurde während der Aktion gedrückt.

- ALT_MASK die Alt-Taste wurde während der Aktion gedrückt.

### <a name="remarks"></a>Hinweise

Überschreiben Sie diese Funktion, wenn Ihr Steuerelement Zugriff auf die Schlüsselinformationen benötigt, nachdem das Ereignis ausgelöst wurde.

##  <a name="onmappropertytopage"></a>COleControl:: onmappropertytopage

Wird von Framework aufgerufen, um die Klassen-ID einer Eigenschaften Seite zu erhalten, die die Bearbeitung der angegebenen Eigenschaft implementiert.

```
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,
    LPCLSID lpclsid,
    BOOL* pbPageOptional);
```

### <a name="parameters"></a>Parameter

*dispid*<br/>
Die Verteiler-ID einer Eigenschaft des Steuerelements.

*lpclsid*<br/>
Ein Zeiger auf `CLSID` eine-Struktur, über die eine Klassen-ID zurückgegeben wird.

*pbPageOptional*<br/>
Gibt einen Indikator zurück, ob die Verwendung der angegebenen Eigenschaften Seite optional ist.

### <a name="return-value"></a>Rückgabewert

Ungleich 0 (null), wenn eine Klassen-ID in *lpclsid*zurückgegeben wurde. andernfalls 0.

### <a name="remarks"></a>Hinweise

Überschreiben Sie diese Funktion, um eine Möglichkeit bereitzustellen, die Eigenschaften Seiten Ihres Steuer Elements über den Eigenschaften Browser des Containers aufzurufen.

##  <a name="onmnemonic"></a>COleControl:: onmnetmonic

Wird von Framework aufgerufen, wenn der Container erkannt hat, dass ein mnetmonisches Schlüssel des OLE-Steuer Elements gedrückt wurde.

```
virtual void OnMnemonic(LPMSG pMsg);
```

### <a name="parameters"></a>Parameter

*pMsg*<br/>
Ein Zeiger auf die durch Drücken einer mnemonischen Taste generierte Windows-Meldung.

##  <a name="onproperties"></a>COleControl:: onproperties

Wird von Framework aufgerufen, wenn das Eigenschaften Verb des Steuer Elements vom Container aufgerufen wurde.

```
virtual BOOL OnProperties(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Parameter

*lpMsg*<br/>
Ein Zeiger auf die Windows-Meldung, die das Verb aufgerufen hat.

*hWndParent*<br/>
Ein Handle für das übergeordnete Fenster des Steuer Elements.

*lpRect*<br/>
Ein Zeiger auf das Rechteck, das vom-Steuerelement im Container verwendet wird.

### <a name="return-value"></a>Rückgabewert

Ungleich NULL, wenn der-Befehl erfolgreich ausgeführt wurde. andernfalls 0.

### <a name="remarks"></a>Hinweise

Die Standard Implementierung zeigt ein modales Eigenschaften Dialogfeld an.

Mit dieser Funktion können Sie auch die Anzeige der Eigenschaften Seiten Ihres Steuer Elements auslösen. Aufrufen der `OnProperties` -Funktion, wobei das Handle des übergeordneten Elements des Steuer Elements im *hwndParent* -Parameter übergeben wird. In diesem Fall werden die Werte der Parameter *lpmsg* und *lprect* ignoriert.

##  <a name="onqueryhitpoint"></a>COleControl:: onqueryhitpoint

Wird von Framework als Antwort auf die `IViewObjectEx::QueryHitPoint` Anforderung eines Containers aufgerufen.

```
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>Parameter

*dwAspect*<br/>
Gibt an, wie das Objekt dargestellt wird. Gültige Werte stammen aus der-Enumeration [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) oder DVASPECT2.

*pRectBounds*<br/>
Ein Zeiger auf `RECT` eine-Struktur, die das umschließende Rechteck des OLE-Steuerelement Client Bereichs angibt.

*ptlLoc*<br/>
Ein Zeiger auf `POINT` die-Struktur, die den Punkt angibt, der auf einen Treffer geprüft werden soll. Der Punkt wird in den OLE-Client Bereichs Koordinaten angegeben.

*lCloseHint*<br/>
Der Abstand, der "Close" zu dem Punkt definiert, der für einen Treffer geprüft wird.

*pHitResult*<br/>
Zeiger auf das Ergebnis der Treffer Abfrage. Einer der folgenden Werte:

- HITRESULT_OUTSIDE *ptlloc* befindet sich außerhalb des OLE-Objekts und ist nicht geschlossen.

- HITRESULT_TRANSPARENT *ptlloc* liegt innerhalb der Grenzen des OLE-Objekts, jedoch nicht in der Nähe des Bilds. Ein Punkt in der Mitte eines transparenten Kreises könnte z. b. "HITRESULT_TRANSPARENT" lauten.

- HITRESULT_CLOSE *ptlloc* befindet sich innerhalb oder außerhalb des OLE-Objekts, ist aber für das Objekt, das in Betracht gezogen werden soll, fast ausreichend. Bei kleinen, dünnen oder detaillierten Objekten kann dieser Wert verwendet werden. Auch wenn sich ein Punkt außerhalb des umschließenden Rechtecks eines Objekts befindet, ist es möglicherweise trotzdem geschlossen (Dies ist für das erreichen kleiner Objekte erforderlich).

- HITRESULT_HIT *ptlloc* befindet sich innerhalb des Bilds des-Objekts.

### <a name="return-value"></a>Rückgabewert

Ungleich 0 (null), wenn ein Treffer Ergebnis erfolgreich zurückgegeben wurde. andernfalls 0. Ein Treffer ist eine Überschneidung mit dem Anzeigebereich des OLE-Steuer Elements.

### <a name="remarks"></a>Hinweise

Fragt ab, ob das Anzeige Rechteck eines Objekts den angegebenen Punkt überlappt (erreicht den Punkt). `QueryHitPoint`kann überschrieben werden, um Treffer für nicht rechteckige Objekte zu testen.

##  <a name="onqueryhitrect"></a>COleControl:: onqueryhitrect

Wird von Framework als Antwort auf die `IViewObjectEx::QueryHitRect` Anforderung eines Containers aufgerufen.

```
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    LPCRECT prcLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>Parameter

*dwAspect*<br/>
Gibt an, wie das Objekt dargestellt werden soll. Gültige Werte stammen aus der-Enumeration [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) oder DVASPECT2.

*pRectBounds*<br/>
Ein Zeiger auf `RECT` eine-Struktur, die das umschließende Rechteck des OLE-Steuerelement Client Bereichs angibt.

*prcLoc*<br/>
Ein Zeiger auf `RECT` die-Struktur, die das Rechteck angibt, das auf einen Treffer (überlappen mit dem Objekt Rechteck) im Verhältnis zur linken oberen Ecke des Objekts geprüft werden soll.

*lCloseHint*<br/>
Wird nicht verwendet.

*pHitResult*<br/>
Zeiger auf das Ergebnis der Treffer Abfrage. Einer der folgenden Werte:

- HITRESULT_OUTSIDE es wird kein Punkt im Rechteck durch das OLE-Objekt getroffen.

- HITRESULT_HIT mindestens ein Punkt im Rechteck wäre ein Treffer für das Objekt.

### <a name="return-value"></a>Rückgabewert

Ungleich 0 (null), wenn ein Treffer Ergebnis erfolgreich zurückgegeben wurde. andernfalls 0.

### <a name="remarks"></a>Hinweise

Fragt ab, ob das Anzeige Rechteck eines Objekts einen beliebigen Punkt im angegebenen Rechteck überlappt (trifft auf das Rechteck). `QueryHitRect`kann überschrieben werden, um Treffer für nicht rechteckige Objekte zu testen.

##  <a name="onrenderdata"></a>COleControl:: OnRenderData

Wird von Framework aufgerufen, um Daten im angegebenen Format abzurufen.

```
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium);
```

### <a name="parameters"></a>Parameter

*lpFormatEtc*<br/>
Verweist auf die [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) -Struktur, die das Format angibt, in dem Informationen angefordert werden.

*lpStgMedium*<br/>
Verweist auf eine [STGMEDIUM](/windows/win32/api/objidl/ns-objidl-ustgmedium~r1) -Struktur, in der die Daten zurückgegeben werden sollen.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Hinweise

Das angegebene Format ist ein zuvor im Steuerelement Objekt angegebenes-Element mit den Element Funktionen " [Delta Data](../../mfc/reference/coledatasource-class.md#delayrenderdata) " oder " [Delta Data](../../mfc/reference/coledatasource-class.md#delayrenderfiledata) " für verzögertes Rendering. Die Standard Implementierung dieser Funktion ruft `OnRenderFileData` `OnRenderGlobalData`bzw. auf, wenn es sich bei dem angegebenen Speichermedium entweder um eine Datei oder einen Arbeitsspeicher handelt. Wenn das angeforderte Format CF_METAFILEPICT oder das persistente Eigenschaften Satz Format ist, rendert die Standard Implementierung die entsprechenden Daten und gibt einen Wert ungleich 0 (null) zurück. Andernfalls wird 0 zurückgegeben, und es wird keine Aktion durchführt.

Wenn *lpstgmedium-> TYMED* auf TYMED_NULL festgelegt ist, sollte STGMEDIUM entsprechend der Angabe durch *lpformatetc-> TYMED*zugeordnet und ausgefüllt werden. Wenn nicht TYMED_NULL, sollte das STGMEDIUM mit den Daten aufgefüllt werden.

Überschreiben Sie diese Funktion, um die Daten im angeforderten Format und Medium bereitzustellen. Abhängig von den Daten können Sie stattdessen eine der anderen Versionen dieser Funktion überschreiben. Wenn Ihre Daten klein sind und in der Größe fester Größe `OnRenderGlobalData`liegen, überschreiben Sie. Wenn sich Ihre Daten in einer Datei befinden oder eine Variable Größe haben, über `OnRenderFileData`schreiben Sie.

Weitere Informationen finden Sie in den `FORMATETC` - `STGMEDIUM` und-Strukturen in der Windows SDK.

##  <a name="onrenderfiledata"></a>COleControl:: onrenderfiledata

Wird von Framework aufgerufen, um Daten im angegebenen Format abzurufen, wenn das Speichermedium eine Datei ist.

```
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,
    CFile* pFile);
```

### <a name="parameters"></a>Parameter

*lpFormatEtc*<br/>
Verweist auf die [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) -Struktur, die das Format angibt, in dem Informationen angefordert werden.

*pFile*<br/>
Verweist auf ein [CFile](../../mfc/reference/cfile-class.md) -Objekt, in dem die Daten gerendert werden sollen.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Hinweise

Das angegebene Format ist ein zuvor im Steuerelement Objekt angegebenes-Element mit der [Delta Data](../../mfc/reference/coledatasource-class.md#delayrenderdata) -Element Funktion für verzögertes Rendering. Die Standard Implementierung dieser Funktion gibt einfach false zurück.

Überschreiben Sie diese Funktion, um die Daten im angeforderten Format und Medium bereitzustellen. Abhängig von den Daten können Sie stattdessen eine der anderen Versionen dieser Funktion überschreiben. Wenn Sie mehrere Speichermedien verarbeiten möchten, überschreiben `OnRenderData`Sie. Wenn sich Ihre Daten in einer Datei befinden oder eine Variable Größe haben, über `OnRenderFileData`schreiben Sie.

Weitere Informationen finden Sie in der `FORMATETC` Struktur des Windows SDK.

##  <a name="onrenderglobaldata"></a>COleControl:: onrenderglobaldata

Wird von Framework aufgerufen, um Daten im angegebenen Format abzurufen, wenn das angegebene Speichermedium globaler Speicher ist.

```
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,
    HGLOBAL* phGlobal);
```

### <a name="parameters"></a>Parameter

*lpFormatEtc*<br/>
Verweist auf die [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) -Struktur, die das Format angibt, in dem Informationen angefordert werden.

*phGlobal*<br/>
Verweist auf ein Handle für den globalen Speicher, in dem die Daten zurückgegeben werden sollen. Wenn kein Arbeitsspeicher zugeordnet wurde, kann dieser Parameter NULL sein.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Hinweise

Das angegebene Format ist ein zuvor im Steuerelement Objekt angegebenes-Element mit der [Delta Data](../../mfc/reference/coledatasource-class.md#delayrenderdata) -Element Funktion für verzögertes Rendering. Die Standard Implementierung dieser Funktion gibt einfach false zurück.

Wenn *phglobal* NULL ist, sollte ein neues HGLOBAL zugeordnet und in *phglobal*zurückgegeben werden. Andernfalls sollte der von *phglobal* angegebene HGLOBAL mit den Daten gefüllt werden. Die Menge der in der hglobal platzierten Daten darf die aktuelle Größe des Speicherblocks nicht überschreiten. Außerdem kann der Block nicht neu zugeordnet werden.

Überschreiben Sie diese Funktion, um die Daten im angeforderten Format und Medium bereitzustellen. Abhängig von den Daten können Sie stattdessen eine der anderen Versionen dieser Funktion überschreiben. Wenn Sie mehrere Speichermedien verarbeiten möchten, überschreiben `OnRenderData`Sie. Wenn sich Ihre Daten in einer Datei befinden oder eine Variable Größe haben, über `OnRenderFileData`schreiben Sie.

Weitere Informationen finden Sie in der `FORMATETC` Struktur des Windows SDK.

##  <a name="onresetstate"></a>COleControl:: OnResetState

Wird von Framework aufgerufen, wenn die Eigenschaften des Steuer Elements auf seine Standardwerte festgelegt werden sollen.

```
virtual void OnResetState();
```

### <a name="remarks"></a>Hinweise

Die Standard Implementierung ruft [DoPropExchange](#dopropexchange)auf und übergibt `CPropExchange` ein-Objekt, das bewirkt, dass Eigenschaften auf ihre Standardwerte festgelegt werden.

Der Steuerelement-Writer kann Initialisierungs Code für das OLE-Steuerelement in dieses über schreibbare einfügen. Diese Funktion wird aufgerufen, wenn [IPersistStream:: Load](/windows/win32/api/objidl/nf-objidl-ipersiststream-load) oder [IPersistStorage:: Load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) fehlschlägt oder [IPersistStreamInit:: InitNew](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-initnew) oder [IPersistStorage:: InitNew](/windows/win32/api/objidl/nf-objidl-ipersiststorage-initnew) aufgerufen wird, ohne dass zuerst `IPersistStream::Load` entweder oder `IPersistStorage::Load`aufgerufenwird.

##  <a name="onsetclientsite"></a>COleControl:: OnSetClientSite

Wird von Framework aufgerufen, wenn der Container die `IOleControl::SetClientSite` Funktion des Steuer Elements aufgerufen hat.

```
virtual void OnSetClientSite();
```

### <a name="remarks"></a>Hinweise

Standardmäßig überprüft `OnSetClientSite` , ob Daten Pfad Eigenschaften geladen werden, und ruft `DoDataPathPropExchange`, wenn dies der Fall ist, auf.

Überschreiben Sie diese Funktion, um eine spezielle Verarbeitung dieser Benachrichtigung durchzuführen. Insbesondere sollten über schreibungen dieser Funktion die-Basisklasse aufzurufen.

##  <a name="onsetdata"></a>COleControl:: onsetdata

Wird von Framework aufgerufen, um die Daten des Steuer Elements durch die angegebenen Daten zu ersetzen.

```
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```

### <a name="parameters"></a>Parameter

*lpFormatEtc*<br/>
Ein Zeiger auf eine [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) -Struktur, die das Format der Daten angibt.

*lpStgMedium*<br/>
Zeiger auf eine [STGMEDIUM](/windows/win32/api/objidl/ns-objidl-ustgmedium~r1) -Struktur, in der sich die Daten befinden.

*bRelease*<br/>
TRUE, wenn das Speichermedium vom Steuerelement freigegeben werden soll. FALSE, wenn das Speichermedium vom Steuerelement nicht freigegeben werden soll.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Hinweise

Wenn sich die Daten im persistenten Eigenschaften Satz Format befinden, ändert die Standard Implementierung den Zustand des Steuer Elements entsprechend. Andernfalls führt die Standard Implementierung keine Aktion aus. Wenn *brelease* den `ReleaseStgMedium` Wert true hat, wird ein-Rückruf durchgeführt; andernfalls nicht.

Überschreiben Sie diese Funktion, um die Daten des Steuer Elements durch die angegebenen Daten zu ersetzen.

Weitere Informationen finden Sie in den `FORMATETC` - `STGMEDIUM` und-Strukturen in der Windows SDK.

##  <a name="onsetextent"></a>COleControl:: onantextent

Wird von Framework aufgerufen, wenn das Steuerelement im Ergebnis eines Aufrufs von [IOleObject:: SetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setextent)geändert werden muss.

```
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```

### <a name="parameters"></a>Parameter

*lpSizeL*<br/>
Ein Zeiger auf die `SIZEL` -Struktur, die lange ganze Zahlen verwendet, um die Breite und Höhe des Steuer Elements darzustellen, ausgedrückt in HIMETRIC-Einheiten.

### <a name="return-value"></a>Rückgabewert

Ungleich 0 (null), wenn die Größenänderung akzeptiert wurde. andernfalls 0.

### <a name="remarks"></a>Hinweise

Die Standard Implementierung behandelt die Größe des Steuer Elements im Steuerelement. Wenn das-Steuerelement direkt aktiv ist, wird ein- `OnPosRectChanged` Rückruf für den Container ausgeführt.

Überschreiben Sie diese Funktion, um die Standardgröße des Steuer Elements zu ändern.

##  <a name="onsetobjectrects"></a>COleControl:: onssetobjectrects

Wird von Framework aufgerufen, um einen Aufruf von [IOleInPlaceObject:: SetObjectRects](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects)zu implementieren.

```
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,
    LPCRECT lpRectClip);
```

### <a name="parameters"></a>Parameter

*lpRectPos*<br/>
Ein Zeiger auf eine `RECT` -Struktur, die die neue Position und Größe des Steuer Elements relativ zum Container angibt.

*lpRectClip*<br/>
Ein Zeiger auf eine `RECT` -Struktur, die einen rechteckigen Bereich angibt, in den das Steuerelement abgeschnitten werden soll.

### <a name="return-value"></a>Rückgabewert

Ungleich 0 (null), wenn die Neupositionierung akzeptiert wurde. andernfalls 0.

### <a name="remarks"></a>Hinweise

Die Standard Implementierung behandelt automatisch die Neupositionierung und die Größe des Steuerelement Fensters und gibt true zurück.

Überschreiben Sie diese Funktion, um das Standardverhalten dieser Funktion zu ändern.

##  <a name="onshowtoolbars"></a>COleControl:: onshowtoolbars

Wird von Framework aufgerufen, wenn das Steuerelement für die Benutzeroberfläche aktiviert wurde.

```
virtual void OnShowToolBars();
```

### <a name="remarks"></a>Hinweise

Bei der Standardimplementierung wird keine Aktion ausgeführt.

##  <a name="ontextchanged"></a>COleControl:: OnTextChanged

Wird von Framework aufgerufen, wenn der Eigenschafts Wert für die Aktien Beschriftung oder den Text geändert wurde.

```
virtual void OnTextChanged();
```

### <a name="remarks"></a>Hinweise

Die Standard Implementierung ruft `InvalidateControl`auf.

Überschreiben Sie diese Funktion, wenn Sie eine Benachrichtigung wünschen, nachdem diese Eigenschaft geändert wurde.

##  <a name="onwindowlessmessage"></a>COleControl:: onwindowlessmessage

Wird von Framework als Antwort auf die `IOleInPlaceObjectWindowless::OnWindowMessage` Anforderung eines Containers aufgerufen.

```
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```

### <a name="parameters"></a>Parameter

*msg*<br/>
Nachrichten-ID wird von Windows übermittelt.

*wParam*<br/>
Wie von Windows übermittelt. Gibt zusätzliche Nachrichten spezifische Informationen an. Der Inhalt dieses Parameters hängt vom Wert des *msg* -Parameters ab.

*lParam*<br/>
Wie von Windows übermittelt. Gibt zusätzliche Nachrichten spezifische Informationen an. Der Inhalt dieses Parameters hängt vom Wert des *msg* -Parameters ab.

*plResult*<br/>
Windows-Ergebniscode. Gibt das Ergebnis der Nachrichtenverarbeitung an und hängt von der gesendeten Nachricht ab.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Hinweise

Verarbeitet Fenster Meldungen für fensterlose Steuerelemente. `COleControl`muss `OnWindowlessMessage` für Fenster Meldungen verwendet werden, die keine Maus-und Tastatur Meldungen sind. `COleControl`stellt [SetCapture](#setcapture) und [SetFocus](#setfocus) speziell zum Erfassen von Maus Eingaben und Tastaturfokus für fensterlose OLE-Objekte bereit.

Da fensterlose Objekte nicht über ein Fenster verfügen, benötigen Sie einen Mechanismus, mit dem der Container Nachrichten senden kann. Ein fensterloses OLE-Objekt ruft Nachrichten aus seinem Container über die `OnWindowMessage` -Methode auf `IOleInPlaceObjectWindowless` der-Schnittstelle ab (eine Erweiterung von [IOleInPlaceObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject) für die Unterstützung von Windows less). `OnWindowMessage`nimmt keinen Parameter an `HWND` .

##  <a name="parenttoclient"></a>COleControl::P arentper Client

Übersetzt die Koordinaten von *PPoint* in Client Koordinaten.

```
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;
```

### <a name="parameters"></a>Parameter

*lprcBounds*<br/>
Ein Zeiger auf die Begrenzungen des OLE-Steuer Elements innerhalb des Containers. Nicht der Client Bereich, sondern der Bereich des gesamten Steuer Elements, einschließlich Rahmen und Bild Lauf leisten.

*pPoint*<br/>
Ein Zeiger auf den übergeordneten (Container) Punkt, der in die Koordinaten des Client Bereichs des Steuer Elements übersetzt werden soll.

*bHitTest*<br/>
Gibt an, ob der Treffer Test an dem Punkt ausgeführt werden soll.

### <a name="return-value"></a>Rückgabewert

Wenn *bhittest* false ist, wird "htnirgendwo" zurückgegeben. Wenn *bhittest* den Wert true hat, wird der Speicherort zurückgegeben, an dem der übergeordnete (Container) Punkt im Client Bereich des OLE-Steuer Elements gelandet ist und einer der folgenden Maus Treffer-Test Werte ist:

- "Htborder" im Rahmen eines Fensters, das keinen Größen Anpassungsrahmen hat.

- "Htbottom" am unteren horizontalen Rand des Fensters.

- "Htbottomleft" in der unteren linken Ecke des Fensterrahmens.

- "Htbottomright" in der unteren rechten Ecke des Fensterrahmens.

- "Htcaption" in einem Titelleisten Bereich.

- "Htclient" in einem Client Bereich.

- HTError im Bildschirmhintergrund oder in einer Trennlinie zwischen Fenstern (identisch mit "htnirgendwo", mit `DefWndProc` der Ausnahme, dass die Windows-Funktion ein Systemsignal erzeugt, um einen Fehler anzugeben).

- "Htgrowbox" in einem Größen Feld.

- Hthscroll in der horizontalen Schiebe Leiste.

- "Htleft" am linken Rand des Fensters.

- "Htmaxbutton" in einer Schaltfläche zum maximieren

- "Htmenu" in einem Menübereich.

- "Htminbutton" in der Schaltfläche minimieren.

- "Htnirgendwo" im Bildschirmhintergrund oder in einer Trennlinie zwischen Fenstern.

- Htreduce in einer Minimieren-Schaltfläche.

- Htright an der rechten Rahmen des Fensters.

- "Htsize" in einem Größen Feld (identisch mit "htgrowbox").

- "Htsysmenu" in einem Steuerelement Menü oder in einer Schaltfläche "Schließen" in einem untergeordneten Fenster.

- Httop am oberen horizontalen Rand des Fensters.

- Httopleft in der oberen linken Ecke des Fensterrahmens.

- Httopright in der oberen rechten Ecke des Fensterrahmens.

- Httransparent in einem Fenster, das zurzeit von einem anderen Fenster abgedeckt wird.

- Htvscroll in der vertikalen Schiebe Leiste.

- Htzoom in einer Schaltfläche zum maximieren.

### <a name="remarks"></a>Hinweise

Auf dem Eingabe- *PPoint* ist relativ zum Ursprung der übergeordneten (oberen linken Ecke des Containers). Auf dem Ausgabe- *PPoint* ist relativ zum Ursprung des Client Bereichs des OLE-Steuer Elements (obere linke Ecke des Client Bereichs des Steuer Elements).

##  <a name="postmodaldialog"></a>COleControl::P ostmodaldialog

Benachrichtigt den Container, dass ein modales Dialogfeld geschlossen wurde.

```
void PostModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>Parameter

*hWndParent*<br/>
Handle für das übergeordnete Fenster des modalen Dialog Felds.

### <a name="remarks"></a>Hinweise

Diese Funktion wird aufgerufen, nachdem ein modales Dialogfeld angezeigt wurde. Sie müssen diese Funktion so aufzurufen, dass der Container alle Fenster der obersten Ebene aktivieren kann `PreModalDialog`, die von deaktiviert werden. Diese Funktion sollte mit einem-Rückruf `PreModalDialog`gekoppelt werden.

##  <a name="premodaldialog"></a>COleControl::P remodaldialog

Benachrichtigt den Container, dass ein modales Dialogfeld angezeigt wird.

```
void PreModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>Parameter

*hWndParent*<br/>
Handle für das übergeordnete Fenster des modalen Dialog Felds.

### <a name="remarks"></a>Hinweise

Diese Funktion wird aufgerufen, bevor ein modales Dialogfeld angezeigt wird. Sie müssen diese Funktion so aufruft, dass der Container alle Fenster der obersten Ebene deaktivieren kann. Nachdem das modale Dialogfeld angezeigt wurde, muss aufgerufen `PostModalDialog`werden.

##  <a name="recreatecontrolwindow"></a>COleControl:: recreatecontrolwindow

Zerstört und erstellt das Fenster des Steuer Elements erneut.

```
void RecreateControlWindow();
```

### <a name="remarks"></a>Hinweise

Dies ist möglicherweise erforderlich, wenn Sie die stylebits des Fensters ändern müssen.

##  <a name="refresh"></a>COleControl:: Refresh

Erzwingt eine Umgestaltung des OLE-Steuer Elements.

```
void Refresh();
```

### <a name="remarks"></a>Hinweise

Diese Funktion wird von der `COleControl` Basisklasse als eine Aktien Methode namens "Refresh" unterstützt. Dadurch können Benutzer des OLE-Steuer Elements das Steuerelement zu einem bestimmten Zeitpunkt neu zeichnen. Weitere Informationen zu dieser Methode finden Sie im Artikel [ActiveX-Steuerelemente: -](../../mfc/mfc-activex-controls-methods.md)Methoden.

##  <a name="releasecapture"></a>COleControl:: releasecapture

Gibt die Maus Aufzeichnung frei.

```
BOOL ReleaseCapture();
```

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Hinweise

Wenn das Steuerelement derzeit über die Maus Aufzeichnung verfügt, wird die Erfassung freigegeben. Andernfalls hat diese Funktion keine Auswirkung.

##  <a name="releasedc"></a>COleControl:: ReleaseDC

Gibt den Anzeigegeräte Kontext eines Containers eines fensterlosen Steuer Elements frei und gibt den Gerätekontext für die Verwendung durch andere Anwendungen frei.

```
int ReleaseDC(CDC* pDC);
```

### <a name="parameters"></a>Parameter

*pDC*<br/>
Identifiziert den Container Gerätekontext, der freigegeben werden soll.

### <a name="return-value"></a>Rückgabewert

Ungleich Null, wenn erfolgreich, andernfalls 0 (Null).

### <a name="remarks"></a>Hinweise

Die Anwendung muss für `ReleaseDC` jeden Rückruf von [GetDC](#getdc)aufrufen.

##  <a name="reparentcontrolwindow"></a>COleControl:: Analyse Controller Window

Legt das übergeordnete Element des Steuer Elements fest.

```
virtual void ReparentControlWindow(
    HWND hWndOuter,
    HWND hWndParent);
```

### <a name="parameters"></a>Parameter

*hWndOuter*<br/>
Das Handle des Steuerelement Fensters.

*hWndParent*<br/>
Das Handle des neuen übergeordneten Fensters.

### <a name="remarks"></a>Hinweise

Diese Funktion wird aufgerufen, um das übergeordnete Element des Steuerelement Fensters zurückzusetzen.

##  <a name="resetstockprops"></a>COleControl:: resetstock-Eigenschaften

Initialisiert den Zustand `COleControl` der vordefinierten Eigenschaften mit ihren Standardwerten.

```
void ResetStockProps();
```

### <a name="remarks"></a>Hinweise

Dabei handelt es sich um die folgenden Eigenschaften: Darstellung, Hintergrundfarbe, BorderStyle, Beschriftung, aktiviert, Schriftart, ForeColor, HWND und Text. Eine Beschreibung der vordefinierten Eigenschaften finden [Sie unter ActiveX-Steuerelemente: Hinzufügen von](../../mfc/mfc-activex-controls-adding-stock-properties.md)vordefinierten Eigenschaften

Sie können die binäre Initialisierungs Leistung eines Steuer Elements mithilfe von `ResetStockProps` und `ResetVersion` verbessern `COleControl::OnResetState`, um zu überschreiben. Siehe das unten aufgeführte Beispiel. Weitere Informationen zum Optimieren der Initialisierung finden [Sie unter ActiveX-Steuerelemente: Optimierung](../../mfc/mfc-activex-controls-optimization.md).

### <a name="example"></a>Beispiel

[!code-cpp[NVC_MFCAxCtl#7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]

##  <a name="resetversion"></a>COleControl:: resetversion

Initialisiert die Versionsnummer mit dem angegebenen Wert.

```
void ResetVersion(DWORD dwVersionDefault);
```

### <a name="parameters"></a>Parameter

*dwVersionDefault*<br/>
Die Versionsnummer, die dem Steuerelement zugewiesen werden soll.

### <a name="remarks"></a>Hinweise

Sie können die binäre Initialisierungs Leistung eines Steuer Elements mithilfe von `ResetVersion` und `ResetStockProps` verbessern `COleControl::OnResetState`, um zu überschreiben. Weitere Informationen finden Sie im Beispiel unter [resetstock-](#resetstockprops)Eigenschaften. Weitere Informationen zum Optimieren der Initialisierung finden [Sie unter ActiveX-Steuerelemente: Optimierung](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="scrollwindow"></a>COleControl:: scrollwindow

Ermöglicht einem fensterlosen OLE-Objekt einen Bildlauf in einem Bereich innerhalb seines direkt aktiven Bilds auf dem Bildschirm.

```
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>Parameter

*xamount*<br/>
Gibt den Betrag des horizontalen Bildlaufs in Geräte Einheiten an. Dieser Parameter muss ein negativer Wert sein, um einen Bildlauf nach links durchführen zu können.

*yamount*<br/>
Gibt den Betrag des vertikalen Bildlaufs in Geräte Einheiten an. Dieser Parameter muss ein negativer Wert sein, um nach oben scrollen zu können.

*lpRect*<br/>
Verweist auf ein [CRect](../../atl-mfc-shared/reference/crect-class.md) -Objekt oder eine Rect-Struktur, das den Teil des Client Bereichs des OLE-Objekts angibt, der in den Client Koordinaten des enthaltenden Fensters durchlaufen werden soll. Wenn *lprect* auf NULL festgelegt ist, wird der Client Bereich des gesamten OLE-Objekts gescrollt.

*lpClipRect*<br/>
Verweist auf ein `CRect` -Objekt `RECT` oder eine-Struktur, die das Rechteck angibt, auf das die Ausschneide Nur Pixel innerhalb des Rechtecks werden gescrollt. Bits außerhalb des Rechtecks sind nicht betroffen, auch wenn Sie sich im *lprect* -Rechteck befinden. Wenn *lpcliprect* NULL ist, wird kein Clipping für das Schiebe Rechteck ausgeführt.

##  <a name="selectfontobject"></a>COleControl:: selectfontobject

Wählt eine Schriftart in einen Gerätekontext aus.

```
CFont* SelectFontObject(
    CDC* pDC,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>Parameter

*pDC*<br/>
Zeiger auf ein Gerätekontext Objekt.

*fontHolder*<br/>
Verweis auf das [cfontholder](../../mfc/reference/cfontholder-class.md) -Objekt, das die auszuwählende Schriftart darstellt.

### <a name="return-value"></a>Rückgabewert

Ein Zeiger auf die zuvor ausgewählte Schriftart. Wenn der Aufrufer alle Zeichnungsvorgänge abgeschlossen hat *, die fontholder verwenden,* sollte die zuvor ausgewählte Schriftart erneut ausgewählt werden, indem Sie als Parameter an [CDC:: SelectObject](../../mfc/reference/cdc-class.md#selectobject)übergeben wird.

##  <a name="selectstockfont"></a>COleControl:: SelectStockFont

Wählt die Eigenschaft "Stock Font" in einen Gerätekontext aus.

```
CFont* SelectStockFont(CDC* pDC);
```

### <a name="parameters"></a>Parameter

*pDC*<br/>
Der Gerätekontext, in dem die Schriftart ausgewählt wird.

### <a name="return-value"></a>Rückgabewert

Ein Zeiger auf das zuvor ausgewählte `CFont` Objekt. Wenn Sie fertig sind, sollten Sie [CDC:: SelectObject](../../mfc/reference/cdc-class.md#selectobject) verwenden, um diese Schriftart wieder in den Gerätekontext auszuwählen.

##  <a name="serializeextent"></a>COleControl:: serializeblock

Serialisiert oder initialisiert den Zustand des Anzeige Raums, der dem Steuerelement zugewiesen ist.

```
void SerializeExtent(CArchive& ar);
```

### <a name="parameters"></a>Parameter

*ar*<br/>
Ein `CArchive` -Objekt, das in oder aus serialisiert werden soll.

### <a name="remarks"></a>Hinweise

Sie können `SerializeExtent`die binäre Persistenz eines Steuer Elements mithilfe von, `SerializeStockProps`und `SerializeVersion` verbessern, `COleControl::Serialize`um zu überschreiben. Siehe das unten aufgeführte Beispiel. Weitere Informationen zum Optimieren der Initialisierung finden [Sie unter ActiveX-Steuerelemente: Optimierung](../../mfc/mfc-activex-controls-optimization.md).

### <a name="example"></a>Beispiel

[!code-cpp[NVC_MFCAxCtl#8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]

##  <a name="serializestockprops"></a>COleControl:: serializestock-Eigenschaften

Serialisiert oder initialisiert den Zustand `COleControl` der vordefinierten Eigenschaften: Darstellung, Hintergrundfarbe, BorderStyle, Beschriftung, aktiviert, Schriftart, ForeColor und Text.

```
void SerializeStockProps(CArchive& ar);
```

### <a name="parameters"></a>Parameter

*ar*<br/>
Ein `CArchive` -Objekt, das in oder aus serialisiert werden soll.

### <a name="remarks"></a>Hinweise

Eine Beschreibung der vordefinierten Eigenschaften finden [Sie unter ActiveX-Steuerelemente: Hinzufügen von](../../mfc/mfc-activex-controls-adding-stock-properties.md)vordefinierten Eigenschaften

Sie können `SerializeStockProps`die binäre Persistenz eines Steuer Elements mithilfe von, `SerializeExtent`und `SerializeVersion` verbessern, `COleControl::Serialize`um zu überschreiben. Ein Beispiel finden Sie im Code unter [serializeblock](#serializeextent). Weitere Informationen zum Optimieren der Initialisierung finden [Sie unter ActiveX-Steuerelemente: Optimierung](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="serializeversion"></a>COleControl:: serializeversion

Serialisiert oder initialisiert den Zustand der Versionsinformationen eines Steuer Elements.

```
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>Parameter

*ar*<br/>
Ein `CArchive` -Objekt, das in oder aus serialisiert werden soll.

*dwVersionDefault*<br/>
Die aktuelle Versionsnummer des Steuer Elements.

*bConvert*<br/>
Gibt an, ob persistente Daten in das neueste Format konvertiert werden sollen, wenn Sie gespeichert oder im gleichen Format wie beim Laden beibehalten werden.

### <a name="return-value"></a>Rückgabewert

Die Versionsnummer des Steuer Elements. Wenn das angegebene Archiv geladen wird, `SerializeVersion` gibt die Version zurück, die aus diesem Archiv geladen wurde. Andernfalls wird die aktuell geladene Version zurückgegeben.

### <a name="remarks"></a>Hinweise

Sie können `SerializeVersion`die binäre Persistenz eines Steuer Elements mithilfe von, `SerializeExtent`und `SerializeStockProps` verbessern, `COleControl::Serialize`um zu überschreiben. Ein Beispiel finden Sie im Code unter [serializeblock](#serializeextent). Weitere Informationen zum Optimieren der Initialisierung finden [Sie unter ActiveX-Steuerelemente: Optimierung](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="setappearance"></a>COleControl:: "abtappearance"

Legt den Eigenschafts Wert für die Aktien Darstellung Ihres Steuer Elements fest.

```
void SetAppearance (short sAppearance);
```

### <a name="parameters"></a>Parameter

*sAppearance*<br/>
Ein **Kurzwert** (VT_I2), der für die Darstellung des Steuer Elements verwendet werden soll. Der Wert 0 (null) legt die Darstellung des Steuer Elements auf Flat fest, und mit dem Wert 1 wird die Darstellung des Steuer Elements auf 3D festgelegt.

### <a name="remarks"></a>Hinweise

Weitere Informationen zu den vordefinierten Eigenschaften finden [Sie unter ActiveX-Steuerelemente: Eigenschaften](../../mfc/mfc-activex-controls-properties.md).

##  <a name="setbackcolor"></a>COleControl:: setBackColor

Legt den Eigenschafts Wert der vordefinierten BackColor-Eigenschaft des Steuer Elements fest.

```
void SetBackColor(OLE_COLOR dwBackColor);
```

### <a name="parameters"></a>Parameter

*dwBackColor*<br/>
Ein OLE_COLOR-Wert, der zum Zeichnen des Hintergrunds des-Steuer Elements verwendet werden soll.

### <a name="remarks"></a>Hinweise

Weitere Informationen zur Verwendung dieser Eigenschaft und anderer zugehöriger Eigenschaften finden Sie im Artikel [ActiveX-Steuerelemente: Eigenschaften](../../mfc/mfc-activex-controls-properties.md).

##  <a name="setborderstyle"></a>COleControl:: setborderstyle

Legt den Wert der Stock BorderStyle-Eigenschaft des Steuer Elements fest.

```
void SetBorderStyle(short sBorderStyle);
```

### <a name="parameters"></a>Parameter

*sBorderStyle*<br/>
Die neue Rahmenart für das Steuerelement. 0 gibt an, dass kein Rahmen und 1 einen normalen Rahmen angibt.

### <a name="remarks"></a>Hinweise

Das Steuerelement Fenster wird dann neu erstellt und `OnBorderStyleChanged` aufgerufen.

##  <a name="setcapture"></a>COleControl:: SetCapture

Bewirkt, dass das Containerfenster des Steuer Elements im Namen des Steuer Elements die Maus Aufzeichnung übernimmt.

```
CWnd* SetCapture();
```

### <a name="return-value"></a>Rückgabewert

Ein Zeiger auf das `CWnd` Fenster Objekt, das zuvor Maus Eingaben erhalten hat.

### <a name="remarks"></a>Hinweise

Wenn das Steuerelement aktiviert und fensterloser ist, bewirkt diese Funktion, dass das Containerfenster des Steuer Elements im Namen des Steuer Elements die Maus Aufzeichnung übernimmt. Andernfalls bewirkt diese Funktion, dass das Steuerelement die Maus Aufzeichnung übernimmt (identisch `CWnd::SetCapture`mit).

##  <a name="setcontrolsize"></a>COleControl:: setcontrolsize

Legt die Größe des OLE-Steuerelement Fensters fest und benachrichtigt den Container, dass die Steuerungs Website geändert wird.

```
BOOL SetControlSize(int cx, int cy);
```

### <a name="parameters"></a>Parameter

*verschoben*<br/>
Gibt die neue Breite des Steuer Elements in Pixel an.

*CY*<br/>
Gibt die neue Höhe des Steuer Elements in Pixel an.

### <a name="return-value"></a>Rückgabewert

Ungleich NULL, wenn der-Befehl erfolgreich ausgeführt wurde. andernfalls 0.

### <a name="remarks"></a>Hinweise

Diese Funktion sollte nicht im Konstruktor des Steuer Elements verwendet werden.

Beachten Sie, dass alle Koordinaten für Steuerelement Fenster relativ zur linken oberen Ecke des-Steuer Elements sind.

##  <a name="setenabled"></a>COleControl:: Seiten Abled

Legt den Wert für die vordefinierte Eigenschaft des Steuer Elements fest.

```
void SetEnabled(BOOL bEnabled);
```

### <a name="parameters"></a>Parameter

*benabled*<br/>
TRUE, wenn das Steuerelement aktiviert werden soll. andernfalls false.

### <a name="remarks"></a>Hinweise

Nachdem diese Eigenschaft festgelegt `OnEnabledChange` wurde, wird aufgerufen.

##  <a name="setfocus"></a>COleControl:: SetFocus

Bewirkt, dass das Containerfenster des Steuer Elements den Eingabefokus auf den Namen des Steuer Elements übernimmt.

```
CWnd* SetFocus();
```

### <a name="return-value"></a>Rückgabewert

Ein Zeiger auf das `CWnd` Fenster Objekt, das zuvor den Eingabefokus hatte, oder NULL, wenn kein solches Fenster vorhanden ist.

### <a name="remarks"></a>Hinweise

Wenn das Steuerelement aktiviert und fensterloser ist, bewirkt diese Funktion, dass das Containerfenster des Steuer Elements im Namen des Steuer Elements den Eingabefokus übernimmt. Der Eingabefokus leitet Tastatureingaben an das Fenster des Containers weiter, und der Container sendet alle nachfolgenden Tastatur Meldungen an das OLE-Objekt `SetFocus`, das aufruft. Jedes Fenster, das zuvor den Eingabefokus hatte, verliert es.

Wenn das Steuerelement nicht fensterloser ist, bewirkt diese Funktion, dass das Steuerelement den Eingabefokus übernimmt (identisch `CWnd::SetFocus`mit).

##  <a name="setfont"></a>COleControl:: SetFont

Legt die Eigenschaft "Stock Font" des-Steuer Elements fest.

```
void SetFont(LPFONTDISP pFontDisp);
```

### <a name="parameters"></a>Parameter

*pFontDisp*<br/>
Ein Zeiger auf eine Schriftart Dispatch-Schnittstelle.

##  <a name="setforecolor"></a>COleControl:: setforecolor

Legt den Wert der Stock ForeColor-Eigenschaft des Steuer Elements fest.

```
void SetForeColor(OLE_COLOR dwForeColor);
```

### <a name="parameters"></a>Parameter

*dwForeColor*<br/>
Ein OLE_COLOR-Wert, der für die Vordergrund Zeichnung Ihres Steuer Elements verwendet werden soll.

### <a name="remarks"></a>Hinweise

Weitere Informationen zur Verwendung dieser Eigenschaft und anderer zugehöriger Eigenschaften finden Sie im Artikel [ActiveX-Steuerelemente: Eigenschaften](../../mfc/mfc-activex-controls-properties.md).

##  <a name="setinitialdataformats"></a>COleControl:: setinitialdataformats

Wird von Framework aufgerufen, um die Liste der Datenformate zu initialisieren, die vom-Steuerelement unterstützt werden.

```
virtual void SetInitialDataFormats();
```

### <a name="remarks"></a>Hinweise

Die Standard Implementierung gibt zwei Formate an: CF_METAFILEPICT und der persistente Eigenschaften Satz.

##  <a name="setinitialsize"></a>COleControl:: setinitialsize

Legt die Größe eines OLE-Steuer Elements fest, wenn das erste Element in einem Container angezeigt wird.

```
void SetInitialSize(
    int cx,
    int cy);
```

### <a name="parameters"></a>Parameter

*verschoben*<br/>
Die anfängliche Breite des OLE-Steuer Elements in Pixel.

*CY*<br/>
Die Anfangshöhe des OLE-Steuer Elements in Pixel.

### <a name="remarks"></a>Hinweise

Diese Funktion wird im Konstruktor aufgerufen, um die anfängliche Größe des Steuer Elements festzulegen. Die Anfangs Größe wird in Geräte Einheiten oder Pixel gemessen. Es wird empfohlen, dass dieser-Befehl im Konstruktor Ihres Steuer Elements durchgeführt wird.

##  <a name="setmodifiedflag"></a>COleControl:: SetModifiedFlag

Ändert den geänderten Zustand eines-Steuer Elements.

```
void SetModifiedFlag(BOOL bModified = TRUE);
```

### <a name="parameters"></a>Parameter

*bModified*<br/>
Der neue Wert für das geänderte Flag des Steuer Elements. TRUE gibt an, dass der Zustand des Steuer Elements geändert wurde. FALSE gibt an, dass der Zustand des Steuer Elements soeben gespeichert wurde.

### <a name="remarks"></a>Hinweise

Ruft diese Funktion immer dann auf, wenn eine Änderung auftritt, die den persistenten Zustand Ihres Steuer Elements beeinträchtigen würde. Wenn sich der Wert einer permanenten Eigenschaft beispielsweise ändert, wird diese Funktion mit " *bmodified* **true**" aufgerufen.

##  <a name="setnotpermitted"></a>COleControl:: setnotzugelassene

Gibt an, dass eine Bearbeitungs Anforderung fehlgeschlagen ist.

```
void SetNotPermitted();
```

### <a name="remarks"></a>Hinweise

Diese Funktion wird aufgerufen `BoundPropertyRequestEdit` , wenn fehlschlägt. Diese Funktion löst eine Ausnahme vom Typ `COleDispScodeException` aus, um anzugeben, dass der Set-Vorgang nicht zulässig ist.

##  <a name="setnotsupported"></a>COleControl:: SetNotSupported

Verhindert die Änderung des Eigenschafts Werts eines Steuer Elements durch den Benutzer.

```
void SetNotSupported();
```

### <a name="remarks"></a>Hinweise

Diese Funktion wird anstelle der Set-Funktion jeder Eigenschaft aufgerufen, bei der die Änderung des Eigenschafts Werts durch den Benutzer des Steuer Elements nicht unterstützt wird. Ein Beispiel wäre eine Eigenschaft, die schreibgeschützt ist.

##  <a name="setrectincontainer"></a>COleControl:: setrectincontainer

Legt die Koordinaten des Rechteck des Steuer Elements relativ zum Container fest, ausgedrückt in Geräte Einheiten.

```
BOOL SetRectInContainer(LPCRECT lpRect);
```

### <a name="parameters"></a>Parameter

*lpRect*<br/>
Ein Zeiger auf ein Rechteck, das die neuen Koordinaten des Steuer Elements relativ zum Container enthält.

### <a name="return-value"></a>Rückgabewert

Ungleich NULL, wenn der-Befehl erfolgreich ausgeführt wurde. andernfalls 0.

### <a name="remarks"></a>Hinweise

Wenn das Steuerelement geöffnet ist, wird die Größe angepasst. Andernfalls wird die- `OnPosRectChanged` Funktion des Containers aufgerufen.

##  <a name="settext"></a>COleControl:: SetText

Legt den Wert der Eigenschaft "Stock Caption" oder "Text" Ihres Steuer Elements fest.

```
void SetText(LPCTSTR pszText);
```

### <a name="parameters"></a>Parameter

*pszText*<br/>
Ein Zeiger auf eine Zeichenfolge.

### <a name="remarks"></a>Hinweise

Beachten Sie, dass die Eigenschaften "Stock Caption" und "Text" dem gleichen Wert zugeordnet werden. Dies bedeutet, dass alle Änderungen, die an einer der Eigenschaften vorgenommen werden, beide Eigenschaften automatisch ändern. Im Allgemeinen sollte ein Steuerelement entweder die Eigenschaft "Stock Caption" oder "Text" unterstützen, aber nicht beides.

##  <a name="throwerror"></a>COleControl:: ThrowError

Signalisiert das Auftreten eines Fehlers im Steuerelement.

```
void ThrowError(
    SCODE sc,
    UINT nDescriptionID,
    UINT nHelpID = -1);

void ThrowError(
    SCODE sc,
    LPCTSTR pszDescription = NULL,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>Parameter

*sc*<br/>
Der Status Codewert, der gemeldet werden soll. Eine umfassende Liste der möglichen Codes finden Sie im Artikel [ActiveX-Steuerelemente: Erweiterte Themen](../../mfc/mfc-activex-controls-advanced-topics.md).

*nDescriptionID*<br/>
Die Zeichen folgen Ressourcen-ID der Ausnahme, die gemeldet werden soll.

*nHelpID*<br/>
Die Hilfe-ID des Themas, für das berichtet werden soll.

*pszDescription*<br/>
Eine Zeichenfolge, die eine Erläuterung der zu gemeldeten Ausnahme enthält.

### <a name="remarks"></a>Hinweise

Diese Funktion sollte nur innerhalb einer Get-oder Set-Funktion für eine OLE-Eigenschaft oder die Implementierung einer OLE-Automatisierungs Methode aufgerufen werden. Wenn Sie Fehler signalisieren müssen, die zu anderen Zeiten auftreten, sollten Sie das Lager Fehler Ereignis auslösen.

##  <a name="transformcoords"></a>COleControl:: transformcoords

Transformiert Koordinaten Werte zwischen HIMETRIC-Einheiten und den systemeigenen Einheiten des Containers.

```
void TransformCoords(
    POINTL* lpptlHimetric,
    POINTF* lpptfContainer,
    DWORD flags);
```

### <a name="parameters"></a>Parameter

*lpptlHimetric*<br/>
Zeiger auf eine `POINTL` -Struktur, die Koordinaten in HIMETRIC-Einheiten enthält.

*lpptfContainer*<br/>
Ein Zeiger auf `POINTF` eine-Struktur, die die Koordinaten in der Einheiten Größe des Containers enthält.

*flags*<br/>
Eine Kombination der folgenden Werte:

- XFORMCOORDS_POSITION eine Position im Container.

- XFORMCOORDS_SIZE eine Größe im Container.

- XFORMCOORDS_HIMETRICTOCONTAINER transformieren Sie HIMETRIC-Einheiten in die Einheiten des Containers.

- XFORMCOORDS_CONTAINERTOHIMETRIC Transformieren der Containereinheiten in HIMETRIC-Einheiten.

### <a name="remarks"></a>Hinweise

Die ersten beiden Flags, XFORMCOORDS_POSITION und XFORMCOORDS_SIZE, geben an, ob die Koordinaten als Position oder Größe behandelt werden sollen. Die verbleibenden zwei Flags geben die Transformations Richtung an.

##  <a name="translatecolor"></a>COleControl:: TranslateColor

Konvertiert einen Farbwert vom OLE_COLOR-Datentyp in den [COLORREF](/windows/win32/gdi/colorref) -Datentyp.

```
COLORREF TranslateColor(
    OLE_COLOR clrColor,
    HPALETTE hpal = NULL);
```

### <a name="parameters"></a>Parameter

*clrColor*<br/>
Ein OLE_COLOR-Datentyp. Weitere Informationen finden Sie unter der Windows [oletranslatecolor](/windows/win32/api/olectl/nf-olectl-oletranslatecolor) -Funktion.

*hpal*<br/>
Ein Handle für eine optionale Palette. kann NULL sein.

### <a name="return-value"></a>Rückgabewert

Ein Wert vom Typ RGB (rot, grün, blau 32), der die voll Tonfarbe definiert, die dem *clrcolor* -Wert am nächsten liegt, den das Gerät darstellen kann.

### <a name="remarks"></a>Hinweise

Diese Funktion ist nützlich, um die Stock ForeColor-und BackColor-Eigenschaften in COLORREF-Typen zu übersetzen, die von [CDC](../../mfc/reference/cdc-class.md) -Element Funktionen verwendet werden

##  <a name="willambientsbevalidduringload"></a>COleControl:: willambientsbevalidduringload

Bestimmt, ob das Steuerelement die Werte von Umgebungs Eigenschaften als Standardwerte verwenden soll, wenn es anschließend aus seinem permanenten Zustand geladen wird.

```
BOOL WillAmbientsBeValidDuringLoad();
```

### <a name="return-value"></a>Rückgabewert

Ungleich 0 (null) gibt an, dass Ambient-Eigenschaften gültig sind. Andernfalls sind Ambient-Eigenschaften nicht gültig.

### <a name="remarks"></a>Hinweise

In einigen Containern hat das Steuerelement möglicherweise während des ersten Aufrufes der Überschreibung von `COleControl::DoPropExchange`keinen Zugriff auf seine Umgebungs Eigenschaften. Dies ist der Fall, wenn der Container [IPersistStreamInit:: Load](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-load) oder [IPersistStorage:: Load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) aufruft, bevor [IOleObject:: SetClientSite](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setclientsite) aufgerufen wird (d. h., wenn das OLEMISC_SETCLIENTSITEFIRST-Statusbit nicht berücksichtigt wird).

##  <a name="windowproc"></a>COleControl:: WindowProc

Stellt eine Windows-Prozedur für `COleControl` ein-Objekt bereit.

```
virtual LRESULT WindowProc(
    UINT message,
    WPARAM wParam,
    LPARAM lParam);
```

### <a name="parameters"></a>Parameter

*message*<br/>
Gibt die zu verarbeitende Windows-Meldung an.

*wParam*<br/>
Stellt zusätzliche Informationen bereit, die beim Verarbeiten der Nachricht verwendet werden. Der Wert des-Parameters hängt von der Meldung ab.

*lParam*<br/>
Stellt zusätzliche Informationen bereit, die beim Verarbeiten der Nachricht verwendet werden. Der Wert des-Parameters hängt von der Meldung ab.

### <a name="return-value"></a>Rückgabewert

Der Rückgabewert der gesendete Nachricht.

### <a name="remarks"></a>Hinweise

Diese Funktion wird aufgerufen, um bestimmte Nachrichten über die Meldungs Zuordnung des Steuer Elements zu senden.

## <a name="see-also"></a>Siehe auch

[MFC-Beispiel CIRC3](../../overview/visual-cpp-samples.md)<br/>
[MFC-Beispiel für "TESTHELP"](../../overview/visual-cpp-samples.md)<br/>
[COlePropertyPage-Klasse](../../mfc/reference/colepropertypage-class.md)<br/>
[CWnd-Klasse](../../mfc/reference/cwnd-class.md)<br/>
[Hierarchiediagramm](../../mfc/hierarchy-chart.md)<br/>
[CFontHolder-Klasse](../../mfc/reference/cfontholder-class.md)<br/>
[CPictureHolder-Klasse](../../mfc/reference/cpictureholder-class.md)<br/>
